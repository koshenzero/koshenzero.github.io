import{l as v,n as F,o as E,r,j as t}from"./index-Df67LvnZ.js";import{Z as z}from"./index-Dntgz-Jr.js";import{f as H,o as K,q as m,E as G}from"./api-D0CI0FXg.js";import{M as g,B as b,A as J,h as p}from"./DefaultLayout-ChSX5Qog.js";import{u as Y,a as S,d as Z,M as Q}from"./index.esm-DQwAVOjC.js";import{B as W,d as X}from"./ButtonOfList-CQegefUu.js";import{b as I,d as A}from"./index.es-GiY7mkae.js";import{A as h,T as D}from"./TextField-CGQe4LUV.js";import"./styled-GyNyOFDO.js";import"./Box-ClPNTXLH.js";const ue=({setToast:u})=>{const c=v(),x=F(),i=E(e=>e.redirectParams),[B,C]=r.useState([]),[L,N]=r.useState([]),[T,M]=r.useState([]),[O,R]=r.useState([]),[l,j]=r.useState(null),[o,f]=r.useState(null),[n,d]=r.useState(null),y=E(e=>e.permission),[s,w]=r.useState({IsView:0,IsUpdate:0,IsDelete:0,IsInsert:0});r.useReducer(e=>e+1,0),r.useEffect(()=>{H("",-100,1,1e4).then(e=>{if(e.error)u(g(!0,"Error",e.error.response.data.message));else{N(e.data.data);let a=i==null?void 0:i[b];a&&a.parking&&a.area&&a.department&&(j(a.parking),f(a.area),d(a.department),x({type:"set",redirectParams:{...i,[b]:{}}}))}})},[]),r.useEffect(()=>{w(y.find(e=>e.ModuleID===J.id))},[y]);const V=r.useMemo(()=>[{accessorKey:"AreaCode",header:"BayCode"},{accessorKey:"AreaName",header:"BayName"}],[]),_=e=>{window.confirm("Are you sure you want to delete this bay?")&&U(e.original.AreaID)},U=e=>{var a=localStorage.getItem("user");if(!a)return c("/pages/login");JSON.parse(a).data,e&&G(e).then(k=>{k.error?u(g(!0,"Error",k.error.response.data.message)):(m(n.AreaID).then(q=>{C(q.data)}),u(g(!1,"Success","Bay have been deleted")))})},P=e=>{c(typeof e=="string"?"edit/0":`edit/${e.original.AreaID}`)};z({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0});const $=Y({columns:V,data:B,renderTopToolbarCustomActions:({table:e})=>t.jsx("div",{className:p(s==null?void 0:s.IsInsert),children:t.jsx(W,{text:"Insert",callback:()=>P("edit")})}),enableGlobalFilter:!1,enableColumnActions:!1,enableRowActions:!((s==null?void 0:s.IsUpdate)===0&&(s==null?void 0:s.IsDelete)===0),enableColumnFilters:!1,enableFullScreenToggle:!1,visibleInShowHideMenu:!1,enableDensityToggle:!1,enableRowNumbers:!0,initialState:{expanded:!0,density:"compact"},enableExpanding:!1,enableHiding:!1,muiTablePaperProps:{elevation:0},muiTableBodyProps:{sx:{"& tr:nth-of-type(odd) > td":{backgroundColor:"#f5f5f5"}}},renderRowActionMenuItems:({closeMenu:e,row:a})=>[t.jsxs(S,{className:p(s==null?void 0:s.IsUpdate),onClick:()=>{P(a),e()},children:[t.jsx(Z,{}),"Edit"]},0),t.jsxs(S,{className:p(s==null?void 0:s.IsDelete),onClick:()=>{_(a),e()},children:[t.jsx(X,{}),"Delete"]},1)]});return r.useEffect(()=>{l&&K("",0,l.ParkingID,-100,1,1e4).then(e=>{M(e.data.data.filter(a=>!a.IsParent&&a.ParkingID===l.ParkingID))})},[l]),r.useEffect(()=>{o&&m(o.AreaID).then(e=>{R(e.data)})},[o]),r.useEffect(()=>{n&&(m(n.AreaID).then(e=>{C(e.data)}),x({type:"set",redirectParams:{...i,[b]:{department:n,area:o,parking:l}}}))},[n]),t.jsxs(I,{fluid:!0,children:[t.jsxs(I,{style:{background:"#fff",padding:12,borderRadius:4},className:"row g-3",fluid:!0,children:[t.jsx(A,{xs:4,children:t.jsx(h,{size:"small",disablePortal:!0,disableClearable:!0,id:"cbParking",value:l,onChange:(e,a)=>{j(a),f(null),d(null)},options:L,getOptionLabel:e=>`${e.ParkingName}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.ParkingID)===(a==null?void 0:a.ParkingID),renderInput:e=>t.jsx(D,{...e,label:"Branch"})})}),t.jsx(A,{xs:4,children:t.jsx(h,{size:"small",disablePortal:!0,disableClearable:!0,id:"cbArea",value:o,onChange:(e,a)=>{f(a),d(null)},options:T,getOptionLabel:e=>`${e.AreaCode}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.AreaID)===(a==null?void 0:a.AreaID),renderInput:e=>t.jsx(D,{...e,label:"Area"})})}),t.jsx(A,{xs:4,children:t.jsx(h,{size:"small",disablePortal:!0,disableClearable:!0,id:"cbDepartment",value:n,onChange:(e,a)=>{d(a)},options:O,getOptionLabel:e=>`${e.AreaCode}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.AreaID)===(a==null?void 0:a.AreaID),renderInput:e=>t.jsx(D,{...e,label:"Department"})})})]}),t.jsx(I,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},className:"row g-3",fluid:!0,children:t.jsx(Q,{table:$})})]})};export{ue as default};
