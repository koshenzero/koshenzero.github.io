import{z as F,l as S,r as f,j as e}from"./index-Df67LvnZ.js";import{P as v,Q as w,R as b}from"./api-D0CI0FXg.js";import{q as x,L as y,M as I}from"./DefaultLayout-ChSX5Qog.js";import{b as C,d as n,a as E}from"./index.es-GiY7mkae.js";import{C as U}from"./CForm-BlQPlA_m.js";import{C as i}from"./CFormLabel-U7mi1tVG.js";import{C as m}from"./CFormInput-DweMMv1W.js";import{C as A}from"./CFormSelect-DYU2t1Q-.js";import"./CFormControlWrapper-C6kxU_lF.js";const $=({setToast:g})=>{const{branchid:u}=F(),c=S(),[h,P]=f.useState({isNewFile:!1,fileContent:void 0}),[r,p]=f.useState({ParkingID:0,ParkingCode:"",ParkingName:"",Address:"",ImagePath:"",StatusID:1,Description:""});f.useEffect(()=>{u&&u!=0&&v(u).then(a=>{k(a),a.data.data.IsEdit=!0,p(a.data.data)})},[]);const k=a=>{if(a.error){c(x,{isErrorMessage:!0,message:"Some things went wrong. Try again later."});return}},o=a=>{const{name:l,value:d}=a.target;let t=d;d==-1&&(t=void 0),p({...r,[l]:t})},N=a=>{if(a.target.files&&a.target.files.length>0){P({isNewFile:!0,fileContent:a.target.files[0]});const l=window.URL.createObjectURL(a.target.files[0]);p({...r,ImagePath:l})}},D=a=>{const l=a.currentTarget;if(a.preventDefault(),l.checkValidity()===!1){a.stopPropagation();return}var d=localStorage.getItem("user");if(d==null)return c(y);var t=JSON.parse(d).data;h.isNewFile&&h.fileContent?w(h.fileContent).then(s=>{if(s.error){g(I(!0,"Error",s.error.response.data.message));return}else b(t.UserID,t.UserName,r.ParkingID,r.ParkingCode,r.ParkingName,r.Address,`\\files\\${s.data.data}`,r.StatusID,r.Description).then(j=>{if(j.error)g(I(!0,"Error",j.error.response.data.message));else{c(x,{state:{isErrorMessage:!1,message:`Branch has been ${r.IsEdit?"updated":"added"}`}});return}})}):b(t.UserID,t.UserName,r.ParkingID,r.ParkingCode,r.ParkingName,r.Address,r.ImagePath.split("fileName=")[1],r.StatusID,r.Description).then(s=>{if(s.error)g(I(!0,"Error",s.error.response.data.message));else{c(x,{state:{isErrorMessage:!1,message:`Parking slot has been ${r.IsEdit?"updated":"added"}`}});return}})};return e.jsxs("div",{children:[e.jsx(C,{children:e.jsx("h3",{children:r.IsEdit?"Update Branch":"Add Branch"})}),e.jsx(C,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},children:e.jsxs(U,{className:"row g-3",onSubmit:D,children:[e.jsxs(n,{md:12,children:[e.jsxs(i,{htmlFor:"ParkingCodeInput",className:"col-form-label fw-bolder",children:["BranchCode",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(m,{type:"text",id:"ParkingCodeInput",name:"ParkingCode",required:!0,value:r.ParkingCode,onChange:o})]}),e.jsxs(n,{xs:12,children:[e.jsxs(i,{htmlFor:"ParkingNameInput",className:"col-form-label fw-bolder",children:["BranchName",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(m,{type:"text",id:"ParkingNameInput",name:"ParkingName",value:r.ParkingName,onChange:o,required:!0})]}),e.jsxs(n,{xs:12,children:[e.jsx(i,{htmlFor:"AddressInput",className:"col-form-label fw-bolder",children:"Address"}),e.jsx(m,{type:"text",id:"AddressInput",name:"Address",value:r.Address,onChange:o})]}),e.jsxs(n,{xs:12,children:[e.jsx(i,{htmlFor:"DescriptionInput",className:"col-form-label fw-bolder",children:"Description"}),e.jsx(m,{type:"text",id:"DescriptionInput",name:"Description",value:r.Description,onChange:o})]}),e.jsxs(n,{md:12,children:[e.jsxs(i,{htmlFor:"statusInput",className:"col-form-label fw-bolder",children:["Status",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(A,{type:"text",id:"statusInput",name:"StatusID",onChange:o,value:r.StatusID,options:[{label:"True",value:1},{label:"False",value:0}],required:!0})]}),e.jsxs(n,{md:12,children:[e.jsx(i,{htmlFor:"ImgInput",className:"col-form-label fw-bolder",children:"Image"}),e.jsx(m,{type:"file",id:"ImgInput",onChange:N,accept:"image/*"}),r.ImagePath&&r.ImagePath!==""&&e.jsx("img",{src:r.ImagePath,style:{objectFit:"cover",marginTop:"1rem",width:"-webkit-fill-available",height:"-webkit-fill-available"}})]}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(E,{style:{width:"fit-content",marginTop:"30px"},color:"primary",type:"submit",children:r.IsEdit?"Update Parking Slot":"Add Parking Slot"})})]})})]})};export{$ as default};
