import{z as y,l as q,r as u,o as S,j as e}from"./index-Df67LvnZ.js";import{d as A,J as T,m as v,K as w}from"./api-D0CI0FXg.js";import{E as U,D as x,g as i,j as p,L as O,M as R}from"./DefaultLayout-ChSX5Qog.js";import{b as D,d as o,a as P}from"./index.es-GiY7mkae.js";import{C as B}from"./CForm-BlQPlA_m.js";import{C as l}from"./CFormLabel-U7mi1tVG.js";import{C as d}from"./CFormInput-DweMMv1W.js";import{A as W,T as _}from"./TextField-CGQe4LUV.js";import{C as g}from"./CFormSelect-DYU2t1Q-.js";import"./CFormControlWrapper-C6kxU_lF.js";import"./styled-GyNyOFDO.js";const V=({setToast:j})=>{const{equipmentid:c}=y(),n=q(),[C,E]=u.useState([]),[N,F]=u.useState([]),M=S(t=>t.permission),[a,h]=u.useState({EquipmentID:0,ChassisNo:"",StatusID:0,Description:"",ETC:"",FALabelID:0,ModelID:"",MastNumber:"",IsEdit:!1});u.useEffect(()=>{var t=M.find(s=>s.ModuleID===U.id);if(c&&c!=0)if((t==null?void 0:t.IsUpdate)===0){n(x,i(!0,"You aren't allowed to do this action"));return}else A(c).then(s=>{if(s.error){n(p,i());return}else s.data.data.IsEdit=!0,h(s.data.data)}),I();else if(t.IsInsert===0){n(x,i(!0,"You aren't allowed to do this action"));return}else I()},[]);const I=()=>{T().then(t=>{if(t.error){n(p,i(!0,"Something went wrong. Try again later."));return}E(t.data.data.filter(s=>s.StatusID=1)),h({...a,FALabelID:t.data.data.filter(s=>s.StatusID=1)[0].FALabelID})}),v("",1,1,1e4).then(t=>{if(t.error){n(p,i(!0,"Something went wrong. Try again later."));return}F(t.data.data.data)})},r=t=>{const{name:s,value:m}=t.target;console.log(t),h({...a,[s]:m})},L=t=>{const s=t.currentTarget;if(t.preventDefault(),s.checkValidity()===!1){t.stopPropagation();return}var m=localStorage.getItem("user");if(m==null)return n(O);var b=JSON.parse(m).data;w(b.UserID,b.UserName,a.FALabelID,a.EquipmentID,a.ModelID,a.ChassisNo,a.StatusID,a.MastNumber,a.ETC,a.Description).then(f=>{if(f.error)j(R(!0,"Error",f.error.response.data.message));else{n(p,i(!1,a.IsEdit?"Equipment has been updated":"Equipment has been created"));return}})};return e.jsxs("div",{children:[e.jsx(D,{children:e.jsx("h3",{children:"Equipment List"})}),e.jsx(D,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},children:e.jsxs(B,{className:"row g-3",onSubmit:L,children:[a.EquipmentID!=0?e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"EquipmentIDInput",className:"col-form-label fw-bolder",children:["EquipmentID",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(d,{type:"text",id:"EquipmentIDInput",value:a.EquipmentID,name:"EquipmentID",onChange:r,disabled:!0})]}):e.jsx("span",{}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"ChassisNoInput",className:"col-form-label fw-bolder",children:["ChassisNo",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(d,{type:"text",id:"ChassisNoInput",name:"ChassisNo",required:!0,value:a.ChassisNo,onChange:r})]}),e.jsxs(o,{xs:6,children:[e.jsx(l,{htmlFor:"ModelIDInput",className:"col-form-label fw-bolder",children:"Model"}),e.jsx(W,{sx:{"& .MuiOutlinedInput-root":{padding:"0px!important"}},className:"mb-3",disablePortal:!0,id:"ModelIDInput",onChange:(t,s)=>{r({target:{name:"ModelID",value:s==null?void 0:s.ModelID}})},options:N,getOptionLabel:t=>`${t.ModelName}`,isOptionEqualToValue:(t,s)=>(t==null?void 0:t.ModelID)===(s==null?void 0:s.ModelID),renderInput:t=>e.jsx(_,{...t})})]}),e.jsxs(o,{xs:6,children:[e.jsx(l,{htmlFor:"MastNumberInput",className:"col-form-label fw-bolder",children:"MastNumber"}),e.jsx(d,{type:"text",id:"MastNumberInput",name:"MastNumber",value:a.MastNumber,onChange:r})]}),e.jsxs(o,{xs:6,children:[e.jsx(l,{htmlFor:"ETCInput",className:"col-form-label fw-bolder",children:"ETC"}),e.jsx(d,{type:"text",id:"ETCInput",name:"ETC",value:a.ETC,onChange:r})]}),e.jsxs(o,{xs:6,children:[e.jsx(l,{htmlFor:"DescriptionInput",className:"col-form-label fw-bolder",children:"Description"}),e.jsx(d,{type:"text",id:"DescriptionInput",name:"Description",value:a.Description,onChange:r})]}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"statusInput",className:"col-form-label fw-bolder",children:["Status",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(g,{type:"text",id:"statusInput",name:"StatusID",onChange:r,value:a.StatusID,options:[{label:"True",value:1},{label:"False",value:0}],required:!0})]}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"FALabelInput",className:"col-form-label fw-bolder",children:["FALabel ",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(g,{type:"text",id:"FALabelInput",name:"FALabelID",onChange:r,value:a.FALabel,options:[...C.map(t=>({label:t.FALabelName,value:t.FALabelID}))],required:!0})]}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(P,{style:{width:"fit-content",marginTop:"30px"},color:"primary",type:"submit",children:a.IsEdit?"Update equipment":"Create equipment"})})]})})]})};export{V as default};
