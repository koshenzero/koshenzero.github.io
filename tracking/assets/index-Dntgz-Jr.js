var S={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},C=`\r
`,E="\uFEFF",w=e=>Object.assign({},S,e);class O extends Error{constructor(t){super(t),this.name="CsvGenerationError"}}class q extends Error{constructor(t){super(t),this.name="EmptyHeadersError"}}class F extends Error{constructor(t){super(t),this.name="CsvDownloadEnvironmentError"}}var c=e=>e,a=e=>e,d=c,u=c,h=c,y=c,j=function(e,t){return t=='"'&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e},G=e=>h(typeof e=="object"?e.key:e),H=e=>y(typeof e=="object"?e.displayLabel:e),T=(e,...t)=>t.reduce((r,o)=>o(r),e),U=e=>t=>e.useBom?d(a(t)+E):t,D=e=>t=>e.showTitle?p(d(a(t)+e.title))(u("")):t,p=e=>t=>d(a(e)+a(t)+C),b=e=>(t,r)=>L(e)(u(t+r)),L=e=>t=>c(a(t)+e.fieldSeparator),k=(e,t)=>r=>{if(!e.showColumnHeaders)return r;if(t.length<1)throw new q("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let o=u("");for(let n=0;n<t.length;n++){const i=H(t[n]);o=b(e)(o,g(e,i))}return o=u(a(o).slice(0,-1)),p(r)(o)},B=(e,t,r)=>o=>{let n=o;for(var i=0;i<r.length;i++){let l=u("");for(let s=0;s<t.length;s++){const f=G(t[s]),v=typeof r[i][a(f)]>"u"?e.replaceUndefinedWith:r[i][a(f)];l=b(e)(l,g(e,v))}l=u(a(l).slice(0,-1)),n=p(n)(l)}return n},m=e=>+e===e&&(!isFinite(e)||!!(e%1)),g=(e,t)=>{if(e.decimalSeparator==="locale"&&m(t))return t.toLocaleString();if(e.decimalSeparator!=="."&&m(t))return t.toString().replace(".",e.decimalSeparator);if(typeof t=="string"){let r=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&t.indexOf(e.quoteCharacter)>-1||t.indexOf(`
`)>-1||t.indexOf("\r")>-1)&&(r=e.quoteCharacter+j(t,e.quoteCharacter)+e.quoteCharacter),r}if(typeof t=="boolean"&&e.boolDisplay){const r=t?"true":"false";return e.boolDisplay[r]}return t},I=e=>t=>{const r=w(e),o=r.useKeysAsHeaders?Object.keys(t[0]):r.columnHeaders;let n=T(d(""),U(r),D(r),k(r,o),B(r,o,t));if(a(n).length<1)throw new O("Output is empty. Is your data formatted correctly?");return n},R=e=>t=>{if(!window)throw new F("Downloading only supported in a browser environment.");const r=w(e),o=a(t),n=r.useTextFile?"plain":"csv",i=r.useTextFile?"txt":"csv";let l=new Blob([o],{type:`text/${n};charset=utf8;`}),s=document.createElement("a");s.download=`${r.filename}.${i}`,s.href=URL.createObjectURL(l),s.setAttribute("visibility","hidden"),document.body.appendChild(s),s.click(),document.body.removeChild(s)};export{I as G,R as I,w as Z};
