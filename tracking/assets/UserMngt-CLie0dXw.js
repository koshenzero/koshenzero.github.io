import{z as A,l as M,r as h,j as e}from"./index-CEuIzQF6.js";import{g as T,u as q,v as k,w as R,x as L}from"./api-BfBva5oo.js";import{U as b,C as W,a as j,b as w,c as J,d as N,M as m,L as v}from"./DefaultLayout-hw1nnULZ.js";import{b as U,a as I}from"./index.es-CvT3HhZV.js";import{C as V}from"./CForm-_4pWhnzE.js";import{C as o}from"./CCol-Cj_yAkpZ.js";import{C as l}from"./CFormLabel-BxRbtAll.js";import{C as t}from"./CFormInput-KJPNG8Vu.js";import{C as P}from"./CFormSelect-D4PTRPV-.js";import{C as B,a as _,b as G,c as K,d as z}from"./CModalTitle-DPSyh268.js";import"./cil-user-Ddrdy7PS.js";import"./CFormControlWrapper-Bvs2WwRn.js";const te=({setToast:d})=>{const{id:x}=A(),c=M(),[D,F]=h.useState([]),[E,C]=h.useState(!1),[s,y]=h.useState({UserID:0,FullName:"",IDNumber:"",Email:"",PhoneOffice:"",Phone:"",Address:"",PostCode:"",City:"",TypeUserID:"",IsAllowToMoveExpiredRecord:"",StatusID:"",CountryID:"",UserName:"",IsEdit:!1,Password:"",ConfirmPassword:"",OldPassword:""});h.useEffect(()=>{x&&x!=0&&T(x,1).then(r=>{if(r.error){c(b,{isErrorMessage:!0,message:"Some things went wrong. Try again later."});return}else r.data.data.IsEdit=!0,r.data.data.OldPassword="",r.data.data.Password="",r.data.data.ConfirmPassword="",y(r.data.data)}),q("",1,0,1e4).then(r=>{F(r.data.data.data)})},[]);const a=r=>{const{name:i,value:n}=r.target;y({...s,[i]:n})},S=r=>{if(r.preventDefault(),formPassword.Password!==formPassword.ConfirmPassword){d(m(!0,"Error","Confirm password is incorrect"));return}var i=localStorage.getItem("user");if(i==null)return c(v);JSON.parse(i).data,s.IsEdit||k(s.UserID,s.OldPassword,s.Password).then(n=>{n.error?d(m(!0,"Error",n.error.response.data.message)):d(m(!1,"Success","Password has been updated"))})},O=r=>{const i=r.currentTarget;r.preventDefault(),i.checkValidity()===!1&&r.stopPropagation();var n=localStorage.getItem("user");if(n==null)return c(v);var p=JSON.parse(n).data;if(s.IsEdit)R(p.UserID,p.UserName,"",s.TypeUserID,s.UserID,"",s.FullName,s.Email,s.Phone,s.StatusID,0,0,s.CountryID,s.PostCode,s.City,s.Address,s.PhoneOffice,s.UserID).then(u=>{if(u.error)d(m(!0,"Error",u.error.response.data.message));else{c(b,{state:{isErrorMessage:!1,message:"User has been updated"}});return}});else{if(s.Password!==s.ConfirmPassword){d(m(!0,"Error","Confirm password is incorrect"));return}L(p.UserID,p.UserName,"",s.TypeUserID,s.UserName,s.Password,s.FullName,s.Email,s.Phone,s.StatusID,0,0,s.CountryID,s.PostCode,s.City,s.Address,s.PhoneOffice,s.UserID).then(u=>{if(u.error)d(m(!0,"Error",u.error.response.data.message));else{c(b,{isErrorMessage:!1,message:"User has been created"});return}})}},[f,g]=h.useState(1);return e.jsxs("div",{children:[e.jsx(U,{children:e.jsx("h3",{children:"User's Profile"})}),e.jsxs(U,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},children:[e.jsxs(V,{className:"row g-3",onSubmit:O,children:[e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"UIDInput",className:"col-form-label fw-bolder",children:["UID",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(t,{type:"text",id:"UIDInput",value:s.UserID,name:"UserID",onChange:a,disabled:!0})]}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"fullNameInput",className:"col-form-label fw-bolder",children:["Full Name",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(t,{type:"text",id:"fullNameInput",name:"FullName",required:!0,value:s.FullName,onChange:a})]}),e.jsxs(o,{xs:6,children:[e.jsx(l,{htmlFor:"emailAddressInput",className:"col-form-label fw-bolder",children:"Email Address"}),e.jsx(t,{type:"email",id:"emailAddressInput",name:"Email",value:s.Email,onChange:a})]}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"isAdminInput",className:"col-form-label fw-bolder",children:["Is Administrator",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(P,{type:"text",id:"isAdminInput",name:"TypeUserID",value:s.TypeUserID,options:[{label:"True",value:1},{label:"False",value:0}],onChange:a,required:!0})]}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"statusInput",className:"col-form-label fw-bolder",children:["Status",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(P,{type:"text",id:"statusInput",name:"StatusID",onChange:a,value:s.StatusID,options:[{label:"True",value:1},{label:"False",value:0}],required:!0})]}),e.jsxs(W,{variant:"tabs",role:"tablist",children:[e.jsx(j,{children:e.jsx(w,{"data-tab":"contact-information-tab",className:"fw-bolder",active:f===1,role:"button",onClick:()=>g(1),children:"Contact Information"})}),s.IsEdit?e.jsx(j,{children:e.jsx(w,{"data-tab":"ChangePassword",onClick:r=>{r.preventDefault,C(!0)},className:"fw-bolder",role:"button",children:"Change Password"})}):e.jsx(j,{children:e.jsx(w,{"data-tab":"accountTab",className:"fw-bolder",role:"button",active:f===2,onClick:()=>g(2),children:"Account"})})]}),e.jsxs(J,{children:[e.jsx(N,{role:"tabpanel","aria-labelledby":"contact-information-tab",visible:f===1,children:e.jsxs("div",{className:"row g-3 d-flex",children:[e.jsxs(o,{md:6,children:[e.jsx(l,{htmlFor:"officePhoneInput",className:"col-form-label fw-bolder",children:"Office Phone"}),e.jsx(t,{type:"text",id:"officePhoneInput",value:s.PhoneOffice,onChange:a,name:"PhoneOffice"})]}),e.jsxs(o,{md:6,children:[e.jsx(l,{htmlFor:"PhoneInput",className:"col-form-label fw-bolder",children:"Mobile Phone"}),e.jsx(t,{type:"number",id:"PhoneInput",value:s.Phone,onChange:a,name:"Phone"})]}),e.jsxs(o,{md:6,children:[e.jsx(l,{htmlFor:"addressInput",className:"col-form-label fw-bolder",children:"Address"}),e.jsx(t,{type:"text",id:"addressInput",value:s.Address,onChange:a,name:"Address"})]}),e.jsxs(o,{md:6,children:[e.jsx(l,{htmlFor:"postalCodeInput",className:"col-form-label fw-bolder",children:"Postal Code"}),e.jsx(t,{type:"text",id:"postalCodeInput",value:s.PostCode,onChange:a,name:"PostCode"})]}),e.jsxs(o,{md:6,children:[e.jsx(l,{htmlFor:"cityInput",className:"col-form-label fw-bolder",children:"City"}),e.jsx(t,{type:"text",id:"cityInput",value:s.City,onChange:a,name:"City"})]}),e.jsxs(o,{md:6,children:[e.jsxs(l,{htmlFor:"countryInput",className:"col-form-label fw-bolder",children:["Country ",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(P,{type:"text",id:"countryInput",name:"CountryID",onChange:a,value:s.CountryID,options:[...D.map(r=>({label:r.CountryName,value:r.CountryID}))],required:!0})]})]})}),s.IsEdit?e.jsx(e.Fragment,{}):e.jsxs(N,{role:"tabpanel","aria-labelledby":"accountTab",visible:f===2,children:[e.jsxs(o,{md:12,children:[e.jsxs(l,{htmlFor:"userNameInput",className:"col-form-label fw-bolder",children:["User Name",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(t,{type:"text",id:"userNameInput",value:s.UserName,onChange:a,name:"UserName",required:!0})]}),e.jsxs(o,{md:12,children:[e.jsx(l,{htmlFor:"passwordInput",className:"col-form-label fw-bolder",children:"Password"}),e.jsx(t,{type:"password",id:"passwordInput",value:s.Password,onChange:a,name:"Password",required:!0})]}),e.jsxs(o,{md:12,children:[e.jsx(l,{htmlFor:"confirmPasswordInput",className:"col-form-label fw-bolder",children:"Confirm-Password"}),e.jsx(t,{type:"password",id:"confirmPasswordInput",value:s.ConfirmPassword,onChange:a,name:"ConfirmPassword",required:!0})]})]})]}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(I,{style:{width:"fit-content",marginTop:"30px"},color:"primary",type:"submit",children:s.IsEdit?"Update profile":"Create user"})})]}),e.jsxs(B,{alignment:"center",scrollable:!0,visible:E,onClose:()=>C(!1),"aria-labelledby":"VerticallyCenteredScrollableExample2",children:[e.jsx(_,{children:e.jsx(G,{id:"VerticallyCenteredScrollableExample2",children:"Modal title"})}),e.jsxs(K,{children:[e.jsxs(o,{md:12,children:[e.jsx(l,{htmlFor:"OldPasswordInput",className:"col-form-label fw-bolder",children:"Old Password"}),e.jsx(t,{type:"password",id:"OldPasswordInput",value:s.OldPassword,onChange:a,name:"OldPassword",required:!0})]}),e.jsxs(o,{md:12,children:[e.jsx(l,{htmlFor:"passwordInput",className:"col-form-label fw-bolder",children:"Password"}),e.jsx(t,{type:"password",id:"passwordInput",value:s.Password,onChange:a,name:"Password",required:!0})]}),e.jsxs(o,{md:12,children:[e.jsx(l,{htmlFor:"ConfirmPasswordInput",className:"col-form-label fw-bolder",children:"Confirm-Password"}),e.jsx(t,{type:"password",id:"ConfirmPasswordInput",value:s.ConfirmPassword,onChange:a,name:"ConfirmPassword",required:!0})]})]}),e.jsxs(z,{children:[e.jsx(I,{color:"secondary",onClick:()=>C(!1),children:"Close"}),e.jsx(I,{color:"primary",onClick:S,children:"Save changes"})]})]})]})]})};export{te as default};
