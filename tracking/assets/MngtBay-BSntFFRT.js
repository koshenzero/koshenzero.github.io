import{z,l as H,r as l,o as K,j as a}from"./index-Df67LvnZ.js";import{c as Q,o as v,f as T,B as X,q as Z,D as w}from"./api-D0CI0FXg.js";import{A as V,D as S,g as b,B as L,L as ee,M as ae}from"./DefaultLayout-ChSX5Qog.js";import{b as F,d as i,a as te}from"./index.es-GiY7mkae.js";import{C as re}from"./CForm-BlQPlA_m.js";import{C as u}from"./CFormLabel-U7mi1tVG.js";import{A as y,T as A}from"./TextField-CGQe4LUV.js";import{C as f}from"./CFormInput-DweMMv1W.js";import{C as se}from"./CFormSelect-DYU2t1Q-.js";import{C as oe}from"./CFormCheck-Bqq75Q6c.js";import"./styled-GyNyOFDO.js";import"./CFormControlWrapper-C6kxU_lF.js";const ge=({setToast:O})=>{const{bayid:p}=z(),m=H(),[E,j]=l.useState([]),[q,C]=l.useState([]),[M,x]=l.useState([]),[U,R]=l.useState([]),_=K(e=>e.permission),[r,g]=l.useState({AreaID:0,IsParent:void 0,ParkingID:void 0,ParkingObj:void 0,BayTypeID:1,AreaCode:"",AreaName:"",JsonAddress:"",NumberPosition:0,StatusID:1,Description:"",IsBlock:!1}),[W,P]=l.useState(null),[$,D]=l.useState(null),[J,h]=l.useState(null);l.useEffect(()=>{var e=_.find(t=>t.ModuleID===V.id);if(p&&p!=0)if((e==null?void 0:e.IsUpdate)===0){m(S,b(!0,"You aren't allowed to do this action"));return}else Q(p).then(t=>{I(t);let s=t.data.data;s.IsEdit=!0,g(s),v("",0,s.ParkingID,-100,1,1e4).then(n=>{I(n);let c=n.data.data.filter(o=>o.AreaID!==p&&o.IsParent),B=c.filter(o=>o.AreaID===s.IsParent)[0],k=n.data.data.filter(o=>o.AreaID!==p&&!o.IsParent);C(k),D(k.find(o=>o.AreaID===B.IsParent)),x(c),h(B),T("",1,0,1e4).then(o=>{I(o),j(o.data.data),P(o.data.data.filter(G=>G.ParkingID==s.ParkingID)[0])})})}),N();else if(e.IsInsert===0){m(S,b(!0,"You aren't allowed to do this action"));return}else T("",1,0,1e4).then(t=>{I(t),j(t.data.data)}),N()},[]);const N=()=>{X().then(e=>{I(e),R(e.data.data)})},I=e=>{if(e.error){m(L,b());return}},d=e=>{const{name:t,value:s}=e.target;let n=s;s==-1&&(n=void 0),g({...r,[t]:n})},Y=e=>{const t=e.currentTarget;e.preventDefault(),t.checkValidity()===!1&&e.stopPropagation();var s=localStorage.getItem("user");if(s==null)return m(ee);var n=JSON.parse(s).data;w(n.UserID,n.UserName,r.AreaID,r.IsParent,r.ParkingID,r.BayTypeID,r.AreaCode,r.AreaName,r.NumberPosition,"",r.StatusID,r.Description,r.IsBlock).then(c=>{if(c.error)O(ae(!0,"Error",c.error.response.data.message));else{m(L,{state:{isErrorMessage:!1,message:`Bay has been ${r.IsEdit?"updated":"inserted"}`}});return}})};return a.jsxs("div",{children:[a.jsx(F,{children:a.jsxs("h3",{children:[r.IsEdit?"Update":"Insert"," Bay"]})}),a.jsx(F,{className:"p-3",style:{background:"#fff",borderRadius:4,marginBottom:12},children:a.jsxs(re,{className:"row g-3",onSubmit:Y,children:[a.jsxs(i,{xs:12,children:[a.jsx(u,{htmlFor:"ParkingIDInput",className:"col-form-label fw-bolder",children:"Branch"}),a.jsx(y,{sx:{"& .MuiOutlinedInput-root":{padding:"0px!important"}},required:!0,className:"mb-3",disablePortal:!0,disableClearable:!0,id:"ParkingID",value:W,onChange:(e,t)=>{d({target:{value:t==null?void 0:t.ParkingID,name:"ParkingID"}}),P(t),v("",0,t.ParkingID,-100,1,1e4).then(s=>{let n=s.data.data.filter(c=>c.ParkingID===(t==null?void 0:t.ParkingID)&&!c.IsParent);C(n)}),D(null),h(null),x([])},options:E,getOptionLabel:e=>`${e==null?void 0:e.ParkingName}`,isOptionEqualToValue:(e,t)=>e==t,renderInput:e=>a.jsx(A,{...e})})]}),a.jsxs(i,{xs:12,children:[a.jsx(u,{htmlFor:"AreaIDInput",className:"col-form-label fw-bolder",children:"Area"}),a.jsx(y,{sx:{"& .MuiOutlinedInput-root":{padding:"0px!important"}},required:!0,className:"mb-3",disablePortal:!0,disableClearable:!0,id:"FilteredAreaID",value:$,onChange:(e,t)=>{Z(t.AreaID).then(s=>{x(s.data)}),D(t),h(null)},options:q,getOptionLabel:e=>`${e==null?void 0:e.AreaCode}`,isOptionEqualToValue:(e,t)=>e==t,renderInput:e=>a.jsx(A,{...e})})]}),a.jsxs(i,{xs:12,children:[a.jsx(u,{htmlFor:"AreaIDInput",className:"col-form-label fw-bolder",children:"Department"}),a.jsx(y,{sx:{"& .MuiOutlinedInput-root":{padding:"0px!important"}},required:!0,className:"mb-3",disablePortal:!0,disableClearable:!0,id:"FilteredAreaID",value:J,onChange:(e,t)=>{d({target:{value:t==null?void 0:t.AreaID,name:"IsParent"}}),h(t)},options:M,getOptionLabel:e=>`${e==null?void 0:e.AreaCode}`,isOptionEqualToValue:(e,t)=>e==t,renderInput:e=>a.jsx(A,{...e})})]}),a.jsxs(i,{md:12,children:[a.jsxs(u,{htmlFor:"AreaCodeInput",className:"col-form-label fw-bolder",children:["Bay Code",a.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),a.jsx(f,{type:"text",id:"AreaCodeInput",name:"AreaCode",required:!0,value:r.AreaCode,onChange:d})]}),a.jsxs(i,{xs:12,children:[a.jsxs(u,{htmlFor:"AreaNameInput",className:"col-form-label fw-bolder",children:["Bay Name",a.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),a.jsx(f,{type:"text",id:"AreaNameInput",name:"AreaName",value:r.AreaName,onChange:d,required:!0})]}),a.jsxs(i,{xs:12,children:[a.jsxs(u,{htmlFor:"NumberPositionInput",className:"col-form-label fw-bolder",children:["NumberPosition",a.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),a.jsx(f,{type:"number",id:"NumberPositionInput",name:"NumberPosition",value:r.NumberPosition,onChange:d,required:!0})]}),a.jsxs(i,{xs:12,children:[a.jsxs(u,{htmlFor:"BayTypeIDInput",className:"col-form-label fw-bolder",children:["BayTypeID",a.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),a.jsx(se,{type:"number",id:"BayTypeIDInput",name:"BayTypeID",onChange:d,value:r.BayTypeID,options:[...U.map(e=>({label:e.BayTypeName,value:e.BayTypeID}))],required:!0})]}),a.jsxs(i,{xs:12,children:[a.jsx(u,{htmlFor:"DescriptionInput",className:"col-form-label fw-bolder",children:"Description"}),a.jsx(f,{type:"text",id:"DescriptionInput",name:"Description",value:r.Description,onChange:d})]}),a.jsx(i,{xs:12,children:a.jsx(oe,{id:"flexCheckDefault",name:"IsBlock",label:"Is Block",xs:12,onClick:d,defaultChecked:r.IsBlock,onChange:()=>{g({...r,IsBlock:!r.IsBlock})}})}),a.jsx("div",{className:"d-flex justify-content-center",children:a.jsx(te,{style:{width:"fit-content",marginTop:"30px"},color:"primary",type:"submit",children:r.IsEdit?"Update area":"Create area"})})]})})]})};export{ge as default};
