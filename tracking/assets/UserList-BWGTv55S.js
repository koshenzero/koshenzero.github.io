import{n as $,o as X,l as Z,r as l,j as s}from"./index-DVdUffN9.js";import{Z as q,u as M,M as S,a as p,d as U,G as Q,I as W}from"./index.esm-ah_DCRN0.js";import{y as v,z as w,A as Y,B as ee}from"./api-BVwJHRoD.js";import{d as se}from"./DeleteForever-BTfYPsmu.js";import{D as ae,M as C}from"./DefaultLayout-CfPVXb2h.js";import{F as V,f as A,a as E}from"./index-C2MiuBek.js";import{C as r}from"./CCol-CkNqnnbR.js";import{C as u}from"./CFormCheck-B7KE8WPz.js";import{b as x,a as m}from"./index.es-B3rfzgWZ.js";import{C as te,a as le,b as re,c as oe,d as ne}from"./CModalTitle-BVzovMwd.js";import"./TextField-CVwMZIf8.js";import"./cil-user-Ddrdy7PS.js";import"./CFormLabel-DkOTcXBr.js";const ye=({setToast:h})=>{const b=$(),f=X(e=>e.userList),n=Z(),[N,g]=l.useState(!1),[k,j]=l.useState([]),[R,K]=l.useState([]),[c,F]=l.useState([]),T=l.useRef();l.useEffect(()=>{v("",0,-100,-100,1e4).then(e=>{i(e),b({type:"set",userList:e.data.data})}),w().then(e=>{i(e),j(e.data.data)})},[]);const i=e=>{e.error&&n(ae,{state:{isErrorMessage:!0,message:e.error.response.data.message}})},H=l.useMemo(()=>[{accessorKey:"UserName",header:"UID"},{accessorKey:"FullName",header:"Full Name"},{accessorKey:"Email",header:"Email"},{accessorKey:"TypeUserID",header:"Is Administrator",Cell:({cell:e})=>s.jsxs(r,{children:[s.jsx(V,{icon:e.getValue()==0?A:E,style:e.getValue()==0?{color:"red"}:{color:"green"},size:"lg"}),s.jsx("span",{children:" "}),"Active"]})},{accessorKey:"StatusID",header:"Status",Cell:({cell:e})=>s.jsxs(r,{children:[s.jsx(V,{icon:e.getValue()==0?A:E,style:e.getValue()==0?{color:"red"}:{color:"green"},size:"lg"}),s.jsx("span",{children:" "}),e.getValue()==1?"Active":"Deactive"]})}],[]),L=l.useMemo(()=>[{accessorKey:"Name",header:"Module Name"},{accessorKey:"Description",header:"Description"},{accessorKey:"IsView",header:"View",Cell:({cell:e})=>s.jsx(r,{children:s.jsx(u,{id:"cbIsView",defaultChecked:e.getValue()!=0,onChange:()=>d()})})},{accessorKey:"IsInsert",header:"Insert",Cell:({cell:e})=>s.jsx(r,{children:s.jsx(u,{id:"cbIsView",defaultChecked:e.getValue()!=0,onChange:()=>d()})})},{accessorKey:"IsUpdate",header:"Update",Cell:({cell:e})=>s.jsx(r,{children:s.jsx(u,{id:"cbIsView",defaultChecked:e.getValue()!=0,onChange:()=>d()})})},{accessorKey:"IsDelete",header:"Delete",Cell:({cell:e})=>s.jsx(r,{children:s.jsx(u,{id:"cbIsView",defaultChecked:e.getValue()!=0,onChange:()=>d()})})}],[]),y=e=>{n(typeof e=="string"?"edit/0":`edit/${e.original.UserID}`)},z=e=>{var a=localStorage.getItem("user");if(a==null)return n("/pages/login");JSON.parse(a).data,e.original.UserID&&Y(e.original.UserID).then(t=>{t.error?h(C(!0,"Error",t.error.response.data.message)):(v("",0,-100,-100,1e4).then(o=>{b({type:"set",userList:o.data.data})}),h(C(!1,"Success","User have been deleted")))})},D=q({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0}),B=()=>{const e=Q(D)(f);W(D)(e)},d=e=>{console.log(c)};console.log(R);const J=e=>{e.original.UserID&&(ee(e.original.UserID).then(a=>{i(a);let t=a.data.data.map(o=>{let I=k.find(P=>P.ModuleID==o.ModuleID);return{...o,Name:I.Name,Description:I.Description}});F(t),K(t)}),g(!0))},O=()=>{var e=localStorage.getItem("user");if(e==null)return n("/pages/login");var a=JSON.parse(e).data;a&&insertListPermission(a.UserID,a.UserName,c).then(t=>{i(t),h(C(!1,"Success","User have been updated")),w().then(o=>{i(o),j(o.data.data)})})},_=M({columns:H,data:f,renderTopToolbarCustomActions:({table:e})=>s.jsxs(x,{className:"d-flex flex-row justify-content-between",fluid:!0,children:[s.jsx(m,{style:{width:"fit-content"},variant:"outline",role:"button",color:"success",onClick:()=>y("edit"),children:"Add "}),s.jsx(m,{style:{width:"fit-content"},variant:"outline",role:"button",color:"primary",onClick:B,children:"Export "})]}),createDisplayMode:"modal",positionCreatingRow:"bottom",enableRowActions:!0,enableColumnActions:!1,enableColumnFilters:!1,enableRowNumbers:!0,enableFullScreenToggle:!1,visibleInShowHideMenu:!1,enableDensityToggle:!1,initialState:{density:"compact"},enableHiding:!1,renderRowActionMenuItems:({closeMenu:e,row:a})=>[s.jsxs(p,{onClick:t=>{y(a),e()},children:[s.jsx(U,{}),"Edit"]},0),s.jsxs(p,{onClick:t=>{t.preventDefault(),J(a),e()},children:[s.jsx(U,{}),"Edit Role"]},1),s.jsxs(p,{onClick:()=>{z(a),e()},children:[s.jsx(se,{}),"Delete"]},2)]}),G=M({ref:T,columns:L,data:c,createDisplayMode:"modal",positionCreatingRow:"bottom",enableRowActions:!1,enableColumnActions:!1,enableColumnFilters:!1,enableRowNumbers:!1,enableFullScreenToggle:!1,visibleInShowHideMenu:!1,enableDensityToggle:!1,initialState:{density:"compact"},enableHiding:!1});return s.jsxs(r,{children:[f.length==0?s.jsx(x,{children:" No Data "}):s.jsx(S,{table:_}),s.jsxs(te,{size:"xl",alignment:"center",scrollable:!0,visible:N,onClose:()=>g(!1),"aria-labelledby":"VerticallyCenteredScrollableExample2",children:[s.jsx(le,{children:s.jsx(re,{id:"VerticallyCenteredScrollableExample2",children:"Modal title"})}),s.jsx(oe,{children:s.jsx(r,{children:c.length==0?s.jsx(x,{children:" No Data "}):s.jsx(S,{table:G})})}),s.jsxs(ne,{children:[s.jsx(m,{color:"secondary",onClick:()=>g(!1),children:"Close"}),s.jsx(m,{color:"primary",onClick:()=>O(),children:"Save changes"})]})]})]})};export{ye as default};
