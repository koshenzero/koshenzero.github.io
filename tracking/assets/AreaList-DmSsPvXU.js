import{n as M,o as x,l as R,r,j as s}from"./index-Df67LvnZ.js";import{Z as T}from"./index-Dntgz-Jr.js";import{f as L,o as w,E as B}from"./api-D0CI0FXg.js";import{M as c,s as u,A as O,h as f}from"./DefaultLayout-ChSX5Qog.js";import{B as v,d as _}from"./ButtonOfList-CQegefUu.js";import{u as U,a as k,d as F,M as H}from"./index.esm-DQwAVOjC.js";import{b as m,d as K}from"./index.es-GiY7mkae.js";import{A as V,T as $}from"./TextField-CGQe4LUV.js";import"./styled-GyNyOFDO.js";import"./Box-ClPNTXLH.js";const ae=({setToast:n})=>{const i=M(),l=x(e=>e.redirectParams),d=R(),[g,p]=r.useState([]),[D,y]=r.useState([]),[o,b]=r.useState(null),A=x(e=>e.permission),[t,C]=r.useState({IsView:0,IsUpdate:0,IsDelete:0,IsInsert:0});r.useEffect(()=>{L("",-100,1,1e4).then(e=>{if(e.error)n(c(!0,"Error",e.error.response.data.message));else{y(e.data.data),i({type:"set",areaList:[]});let a=l==null?void 0:l[u];a&&a.parking&&(b(a.parking),i({type:"set",redirectParams:{...l,[u]:{}}}))}})},[]),r.useEffect(()=>{C(A.find(e=>e.ModuleID===O.id))},[A]),r.useEffect(()=>{o&&(w("",0,o.ParkingID,-100,1,1e4).then(e=>{p(e.data.data.filter(a=>!a.IsParent))}),i({type:"set",redirectParams:{...l,[u]:{parking:o}}}))},[o]);const P=r.useMemo(()=>[{accessorKey:"AreaCode",header:"AreaCode"},{accessorKey:"AreaName",header:"AreaName"}],[]),j=e=>{window.confirm("Are you sure you want to delete this user?")&&E(e.original.AreaID)},E=e=>{var a=localStorage.getItem("user");if(!a)return d("/pages/login");JSON.parse(a).data,e&&B(e).then(I=>{I.error?n(c(!0,"Error",I.error.response.data.message)):(p(g.filter(S=>S.AreaID!==e)),n(c(!1,"Success","Area have been deleted")))})},h=e=>{d(typeof e=="string"?"edit/0":`edit/${e.original.AreaID}`)};T({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0});const N=U({columns:P,data:g,renderTopToolbarCustomActions:({table:e})=>s.jsx("div",{className:f(t==null?void 0:t.IsInsert),children:s.jsx(v,{text:"Insert",callback:()=>h("edit")})}),enableGlobalFilter:!1,enableColumnActions:!1,enableRowActions:!((t==null?void 0:t.IsUpdate)===0&&(t==null?void 0:t.IsDelete)===0),enableColumnFilters:!1,enableFullScreenToggle:!1,visibleInShowHideMenu:!1,enableDensityToggle:!1,enableRowNumbers:!0,initialState:{expanded:!0,density:"compact"},enableExpanding:!1,enableHiding:!1,muiTablePaperProps:{elevation:0},muiTableBodyProps:{sx:{"& tr:nth-of-type(odd) > td":{backgroundColor:"#f5f5f5"}}},muiTableBodyCellProps:{sx:{borderRight:"1px solid #e0e0e0"}},renderRowActionMenuItems:({closeMenu:e,row:a})=>[s.jsxs(k,{className:f(t==null?void 0:t.IsUpdate),onClick:()=>{h(a),e()},children:[s.jsx(F,{}),"Edit"]},0),s.jsxs(k,{className:f(t==null?void 0:t.IsDelete),onClick:()=>{j(a),e()},children:[s.jsx(_,{}),"Delete"]},1)]});return s.jsxs(m,{fluid:!0,children:[s.jsx(m,{style:{background:"#fff",padding:12,borderRadius:4},className:"row g-3",fluid:!0,children:s.jsx(K,{children:s.jsx(V,{size:"small",disablePortal:!0,id:"cbParking",value:o,onChange:(e,a)=>{b(a)},options:D,getOptionLabel:e=>`${e.ParkingName}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.ParkingID)===(a==null?void 0:a.ParkingID),renderInput:e=>s.jsx($,{...e,label:"Branch"})})})}),s.jsx(m,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},className:"row g-3",fluid:!0,children:s.jsx(H,{table:N})})]})};export{ae as default};
