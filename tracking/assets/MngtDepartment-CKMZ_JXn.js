import{z as U,l as R,o as B,r as i,j as a}from"./index-Df67LvnZ.js";import{c as q,f as j,o as P,D as _}from"./api-D0CI0FXg.js";import{A as J,D as C,g as f,t as N,L as $,M as G}from"./DefaultLayout-ChSX5Qog.js";import{b as v,d as p,a as W}from"./index.es-GiY7mkae.js";import{C as Y}from"./CForm-BlQPlA_m.js";import{C as c}from"./CFormLabel-U7mi1tVG.js";import{A as k,T as y}from"./TextField-CGQe4LUV.js";import{C as h}from"./CFormInput-DweMMv1W.js";import"./styled-GyNyOFDO.js";import"./CFormControlWrapper-C6kxU_lF.js";const ae=({setToast:E})=>{const{departmentid:m}=U(),l=R(),S=B(e=>e.permission),[L,D]=i.useState([]),[O,x]=i.useState([]),[r,A]=i.useState({AreaID:0,IsParent:void 0,ParkingID:void 0,ParkingObj:void 0,BayTypeID:1,AreaCode:"",AreaName:"",JsonAddress:"",NumberPosition:0,StatusID:1,Description:""}),[T,b]=i.useState(null),[F,g]=i.useState(null);i.useEffect(()=>{var e=S.find(t=>t.ModuleID===J.id);if(m&&m!=0)if((e==null?void 0:e.IsUpdate)===0){l(C,f(!0,"You aren't allowed to do this action"));return}else q(m).then(t=>{u(t);let o=t.data.data;o.IsEdit=!0,A(o),j("",1,0,1e4).then(s=>{u(s),D(s.data.data),b(s.data.data.filter(n=>n.ParkingID==o.ParkingID)[0])}),P("",0,0,o.ParkingID,1,1e4).then(s=>{u(s);let n=s.data.data.filter(I=>I.AreaID!==m&&!I.IsParent);x(n),g(n.filter(I=>I.AreaID===o.IsParent)[0])})});else if((e==null?void 0:e.IsInsert)===0){l(C,f(!0,"You aren't allowed to do this action"));return}else j("",1,0,1e4).then(t=>{u(t),D(t.data.data)})},[]);const u=e=>{if(e.error){l(N,f());return}},d=e=>{const{name:t,value:o}=e.target;let s=o;o==-1&&(s=void 0),A({...r,[t]:s})},M=e=>{const t=e.currentTarget;e.preventDefault(),t.checkValidity()===!1&&e.stopPropagation();var o=localStorage.getItem("user");if(o==null)return l($);var s=JSON.parse(o).data;_(s.UserID,s.UserName,r.AreaID,r.IsParent,r.ParkingID,r.BayTypeID,r.AreaCode,r.AreaName,r.NumberPosition,r.IsTemplate,r.StatusID,r.Description).then(n=>{if(n.error)E(G(!0,"Error",n.error.response.data.message));else{l(N,{state:{isErrorMessage:!1,message:`Department has been ${r.IsEdit?"updated":"inserted"}`}});return}})};return a.jsxs("div",{children:[a.jsx(v,{children:a.jsxs("h3",{children:[r.IsEdit?"Update":"Insert"," Department"]})}),a.jsx(v,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},children:a.jsxs(Y,{className:"row g-3",onSubmit:M,children:[a.jsxs(p,{xs:12,children:[a.jsx(c,{htmlFor:"ParkingIDInput",className:"col-form-label fw-bolder",children:"Branch"}),a.jsx(k,{sx:{"& .MuiOutlinedInput-root":{padding:"0px!important"}},required:!0,className:"mb-3",disablePortal:!0,disableClearable:!0,id:"ParkingID",value:T,onChange:(e,t)=>{d({target:{value:t==null?void 0:t.ParkingID,name:"ParkingID"}}),P("",0,t.ParkingID,-100,1,1e4).then(o=>{x(o.data.data.filter(s=>s.ParkingID===(t==null?void 0:t.ParkingID)&&!s.IsParent))}),b(t),g(null)},options:L,getOptionLabel:e=>`${e==null?void 0:e.ParkingName}`,isOptionEqualToValue:(e,t)=>e==t,renderInput:e=>a.jsx(y,{...e})})]}),a.jsxs(p,{xs:12,children:[a.jsx(c,{htmlFor:"AreaIDInput",className:"col-form-label fw-bolder",children:"Area"}),a.jsx(k,{sx:{"& .MuiOutlinedInput-root":{padding:"0px!important"}},required:!0,className:"mb-3",disablePortal:!0,disableClearable:!0,id:"FilteredAreaID",value:F,onChange:(e,t)=>{d({target:{value:t==null?void 0:t.AreaID,name:"IsParent"}}),g(t)},options:O,getOptionLabel:e=>`${e==null?void 0:e.AreaCode}`,isOptionEqualToValue:(e,t)=>e==t,renderInput:e=>a.jsx(y,{...e})})]}),a.jsxs(p,{md:12,children:[a.jsxs(c,{htmlFor:"AreaCodeInput",className:"col-form-label fw-bolder",children:["Department Code",a.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),a.jsx(h,{type:"text",id:"AreaCodeInput",name:"AreaCode",required:!0,value:r.AreaCode,onChange:d})]}),a.jsxs(p,{xs:12,children:[a.jsxs(c,{htmlFor:"AreaNameInput",className:"col-form-label fw-bolder",children:["Department Name",a.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),a.jsx(h,{type:"text",id:"AreaNameInput",name:"AreaName",value:r.AreaName,onChange:d,required:!0})]}),a.jsxs(p,{xs:12,children:[a.jsx(c,{htmlFor:"DescriptionInput",className:"col-form-label fw-bolder",children:"Description"}),a.jsx(h,{type:"text",id:"DescriptionInput",name:"Description",value:r.Description,onChange:d})]}),a.jsx("div",{className:"d-flex justify-content-center",children:a.jsx(W,{style:{width:"fit-content",marginTop:"30px"},color:"primary",type:"submit",children:r.IsEdit?"Update area":"Create area"})})]})})]})};export{ae as default};
