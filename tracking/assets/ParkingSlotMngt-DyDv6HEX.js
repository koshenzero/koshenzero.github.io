import{z as S,l as v,r as f,j as e}from"./index-CEuIzQF6.js";import{J as y,K as F,L as j}from"./api-BfBva5oo.js";import{P as I,L as w,M as x}from"./DefaultLayout-hw1nnULZ.js";import{b as k,a as E}from"./index.es-CvT3HhZV.js";import{C as U}from"./CForm-_4pWhnzE.js";import{C as s}from"./CCol-Cj_yAkpZ.js";import{C as n}from"./CFormLabel-BxRbtAll.js";import{C as l}from"./CFormInput-KJPNG8Vu.js";import{C as A}from"./CFormSelect-D4PTRPV-.js";import"./cil-user-Ddrdy7PS.js";import"./CFormControlWrapper-Bvs2WwRn.js";const G=({setToast:c})=>{const{parkingid:u}=S(),g=v(),[p,b]=f.useState({isNewFile:!1,fileContent:void 0}),[r,h]=f.useState({ParkingID:0,ParkingCode:"",ParkingName:"",Address:"",ImagePath:"",StatusID:void 0,Description:""});f.useEffect(()=>{u&&u!=0&&y(u).then(a=>{C(a),a.data.data.IsEdit=!0,h(a.data.data)})},[]);const C=a=>{if(a.error){g(I,{isErrorMessage:!0,message:"Some things went wrong. Try again later."});return}},i=a=>{const{name:d,value:m}=a.target;let t=m;m==-1&&(t=void 0),h({...r,[d]:t})},D=a=>{if(a.target.files&&a.target.files.length>0){b({isNewFile:!0,fileContent:a.target.files[0]});const d=window.URL.createObjectURL(a.target.files[0]);h({...r,ImagePath:d})}},N=a=>{const d=a.currentTarget;if(a.preventDefault(),d.checkValidity()===!1){a.stopPropagation();return}var m=localStorage.getItem("user");if(m==null)return g(w);var t=JSON.parse(m).data;p.isNewFile&&p.fileContent?F(p.fileContent).then(o=>{if(o.error){c(x(!0,"Error",o.error.response.data.message));return}else j(t.UserID,t.UserName,r.ParkingID,r.ParkingCode,r.ParkingName,r.Address,`\\files\\${o.data.data}`,r.StatusID,r.Description).then(P=>{if(P.error)c(x(!0,"Error",P.error.response.data.message));else{g(I,{state:{isErrorMessage:!1,message:`Parking slot has been ${r.IsEdit?"updated":"added"}`}});return}})}):j(t.UserID,t.UserName,r.ParkingID,r.ParkingCode,r.ParkingName,r.Address,r.ImagePath,r.StatusID,r.Description).then(o=>{if(o.error)c(x(!0,"Error",o.error.response.data.message));else{g(I,{state:{isErrorMessage:!1,message:`Parking slot has been ${r.IsEdit?"updated":"added"}`}});return}})};return e.jsxs("div",{children:[e.jsx(k,{children:e.jsx("h3",{children:r.IsEdit?"Update Parking Slot":"Add Parking Slot"})}),e.jsx(k,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},children:e.jsxs(U,{className:"row g-3",onSubmit:N,children:[r.ParkingID!=0?e.jsxs(s,{md:6,children:[e.jsxs(n,{htmlFor:"ParkingIDInput",className:"col-form-label fw-bolder",children:["ParkingID",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(l,{type:"text",id:"ParkingIDInput",value:r.ParkingID,name:"ParkingID",onChange:i,disabled:!0})]}):e.jsx("span",{}),e.jsxs(s,{md:6,children:[e.jsxs(n,{htmlFor:"ParkingCodeInput",className:"col-form-label fw-bolder",children:["ParkingCode",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(l,{type:"text",id:"ParkingCodeInput",name:"ParkingCode",required:!0,value:r.ParkingCode,onChange:i})]}),e.jsxs(s,{xs:6,children:[e.jsxs(n,{htmlFor:"ParkingNameInput",className:"col-form-label fw-bolder",children:["ParkingName",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(l,{type:"text",id:"ParkingNameInput",name:"ParkingName",value:r.ParkingName,onChange:i,required:!0})]}),e.jsxs(s,{xs:6,children:[e.jsx(n,{htmlFor:"AddressInput",className:"col-form-label fw-bolder",children:"Address"}),e.jsx(l,{type:"text",id:"AddressInput",name:"Address",value:r.Address,onChange:i})]}),e.jsxs(s,{xs:6,children:[e.jsx(n,{htmlFor:"DescriptionInput",className:"col-form-label fw-bolder",children:"Description"}),e.jsx(l,{type:"text",id:"DescriptionInput",name:"Description",value:r.Description,onChange:i})]}),e.jsxs(s,{md:6,children:[e.jsxs(n,{htmlFor:"statusInput",className:"col-form-label fw-bolder",children:["Status",e.jsx("span",{style:{color:"red",fontWeight:"bold"},children:"*"})]}),e.jsx(A,{type:"text",id:"statusInput",name:"StatusID",onChange:i,value:r.StatusID,options:[{label:"True",value:1},{label:"False",value:0}],required:!0})]}),e.jsxs(s,{md:6,children:[e.jsx(n,{htmlFor:"ImgInput",className:"col-form-label fw-bolder",children:"Image"}),e.jsx(l,{type:"file",id:"ImgInput",onChange:D,accept:"image/*"}),r.ImagePath&&r.ImagePath!==""&&e.jsx("img",{src:r.ImagePath,style:{objectFit:"cover",marginTop:"1rem",width:"-webkit-fill-available",height:"-webkit-fill-available"}})]}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(E,{style:{width:"fit-content",marginTop:"30px"},color:"primary",type:"submit",children:r.IsEdit?"Update Parking Slot":"Add Parking Slot"})})]})})]})};export{G as default};
