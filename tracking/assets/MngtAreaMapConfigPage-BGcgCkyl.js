import{j as r,r as s}from"./index-DVdUffN9.js";import{r as I,Z as W,u as X,M as Y}from"./index.esm-ah_DCRN0.js";import{e as w,m as S,q as A,P as V}from"./api-BVwJHRoD.js";import{M as n}from"./DefaultLayout-CfPVXb2h.js";import{u as ee,C as ae}from"./useMapCanvasModel-DVvIlAzw.js";import{i as y,u as re,A as te,T as se,I as oe}from"./TextField-CVwMZIf8.js";import{b as M,a as E}from"./index.es-B3rfzgWZ.js";import{C as j}from"./CCol-CkNqnnbR.js";import{C as ne,a as de,b as le,c as ie,d as ue}from"./CModalTitle-BVzovMwd.js";import"./cil-user-Ddrdy7PS.js";var c={},ce=y;Object.defineProperty(c,"__esModule",{value:!0});var D=c.default=void 0,fe=ce(I()),pe=r;D=c.default=(0,fe.default)((0,pe.jsx)("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote");var f={},me=y;Object.defineProperty(f,"__esModule",{value:!0});var P=f.default=void 0,ge=me(I()),he=r;P=f.default=(0,ge.default)((0,he.jsx)("path",{d:"M4 20h16v2H4zM4 2h16v2H4zm9 7h3l-4-4-4 4h3v6H8l4 4 4-4h-3z"}),"Expand");const De=({setToast:o})=>{const[k,p]=s.useState([]),[m,g]=s.useState([]),[R,h]=s.useState([]),[z,L]=s.useState([]),[be,N]=s.useState(0),[b,l]=s.useState(!1),[u,J]=s.useState({imageSource:"./test1.png",data:[]});re();const v="#F9F9F9",{background:_,elements:H,loadBackground:O,saveData:q,loadDataSource:B}=ee();s.useEffect(()=>{w("",-100,1,1e4).then(e=>{e.error?o(n(!0,"Error",e.error.response.data.message)):L(e.data.data)})},[]);const F=e=>{S("",null,Number(e),1,1,1e4).then(a=>{a.error?o(n(!0,"Error",a.error.response.data.message)):p(a.data.data)}),A("",null,Number(e),1,1,1e4).then(a=>{a.error?o(n(!0,"Error",a.error.response.data.message)):(g(a.data.data),h(a.data.data))})};s.useEffect(()=>{B(u.data)},[u]),s.useEffect(()=>{h(m)},[m]);const K=e=>{e.preventDefault(),q(function(a){var t=localStorage.getItem("user");if(!t)return navigate("/pages/login");var C=JSON.parse(t).data;if(!a){o(n(!0,"Error","An Error has occurred while saving"));return}var Q=JSON.parse(a).data,x=Q.find(i=>i.IsCurrent);V(C.UserID,C.UserName,x.id,x.JsonRectangle).then(i=>{i.error?o(n(!0,"Error",i.error.response.data.message)):(o(n(!1,"Success","Map Updated")),A("",null,null,1,1,1e4).then(d=>{d.error?o(n(!0,"Error",d.error.response.data.message)):g(d.data.data)}),S("",null,null,1,1,1e4).then(d=>{d.error?o(n(!0,"Error",d.error.response.data.message)):p(d.data.data)}),l(!1))})})},$=(e,a)=>{e.preventDefault(),l(!b),T(a.original.AreaID)},T=e=>{let a=k.filter(t=>t.IsParent!=null&&(t.JsonAddress!=null||t.JsonAddress!="")).map(t=>({id:t.AreaID,IsTemplate:!1,NumberEquipment:t.NumberPosition,Color:t.AreaID==e?"#ffff66":"#ccc",IsCurrent:t.AreaID==e,JsonRectangle:U(t.JsonAddress)?"[[100,50],[200,50],[200,150],[100,150]]":t.JsonAddress,IsEdit:t.AreaID==e}));J({...u,data:a})},U=e=>!e||e.length===0,G=s.useMemo(()=>[{accessorKey:"AreaID",header:"AreaID",size:50},{accessorKey:"AreaCode",header:"AreaCode"},{accessorKey:"AreaName",header:"AreaName"},{accessorKey:"JsonAddress",header:"JsonAddress"}],[]);W({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0});const Z=X({columns:G,data:R,enableColumnActions:!1,enableExpanding:!0,getSubRows:e=>e.subRows,muiTablePaperProps:{elevation:0,sx:{borderRadius:"1"}},enableRowActions:!0,layoutMode:"grid",muiTableBodyProps:{sx:e=>({'& tr:nth-of-type(odd):not([data-selected="true"]):not([data-pinned="true"]) > td':{backgroundColor:v},'& tr:nth-of-type(odd):not([data-selected="true"]):not([data-pinned="true"]):hover > td':{backgroundColor:"#fff"},'& tr:nth-of-type(even):not([data-selected="true"]):not([data-pinned="true"]) > td':{backgroundColor:"#fff"},'& tr:nth-of-type(even):not([data-selected="true"]):not([data-pinned="true"]):hover > td':{backgroundColor:v}})},displayColumnDefOptions:{"mrt-row-actions":{size:70,grow:!1}},renderRowActions:({row:e,table:a})=>e.original.IsParent!=null?[r.jsx(oe,{"aria-label":"delete",size:"medium",onClick:()=>{$(event,e)},children:r.jsx(D,{fontSize:"inherit"})},0)]:[r.jsx(P,{color:"primary",fontSize:"inherit"})]});return r.jsxs(M,{fluid:!0,children:[r.jsx(M,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},fluid:!0,children:r.jsx(j,{children:r.jsx(te,{className:"mb-3",size:"small",disablePortal:!0,id:"cbParking",onChange:(e,a)=>{N(a==null?void 0:a.ParkingID),F(a==null?void 0:a.ParkingID),O({imageSrc:a==null?void 0:a.ImagePath})},options:z,getOptionLabel:e=>`${e.ParkingName}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.ParkingID)===(a==null?void 0:a.ParkingID),renderInput:e=>r.jsx(se,{...e,label:"ParkingSlot"})})})}),r.jsx(Y,{table:Z}),r.jsxs(ne,{fullscreen:!0,alignment:"center",scrollable:!0,visible:b,onClose:()=>l(!1),"aria-labelledby":"VerticallyCenteredScrollableExample2",children:[r.jsx(de,{children:r.jsx(le,{id:"VerticallyCenteredScrollableExample2",children:"Modal title"})}),r.jsx(ie,{children:r.jsx(j,{children:r.jsx(ae,{elements:H,initialState:"SELECT",background:_})})}),r.jsxs(ue,{children:[r.jsx(E,{color:"secondary",onClick:()=>l(!1),children:"Close"}),r.jsx(E,{color:"primary",onClick:K,children:"Save changes"})]})]})]})};export{De as default};
