import{n as v,l as U,r,o as x,j as t}from"./index-Df67LvnZ.js";import{Z as V}from"./index-Dntgz-Jr.js";import{f as F,o as $,q as P,E as q}from"./api-D0CI0FXg.js";import{M as f,t as g,A as H,h as m}from"./DefaultLayout-ChSX5Qog.js";import{u as K,a as k,d as z,M as G}from"./index.esm-DQwAVOjC.js";import{B as J,d as Z}from"./ButtonOfList-CQegefUu.js";import{b,d as C}from"./index.es-GiY7mkae.js";import{A as j,T as E}from"./TextField-CGQe4LUV.js";import"./styled-GyNyOFDO.js";import"./Box-ClPNTXLH.js";const ne=({setToast:d})=>{const p=v(),c=U(),[y,S]=r.useState([]),[N,T]=r.useState([]),[l,A]=r.useState(null),[n,u]=r.useState(null),[s,M]=r.useState({IsView:0,IsUpdate:0,IsDelete:0,IsInsert:0}),[L,o]=r.useState([]),I=x(e=>e.permission),i=x(e=>e.redirectParams);r.useEffect(()=>{F("",-100,1,1e4).then(e=>{if(e.error)d(f(!0,"Error",e.error.response.data.message));else{S(e.data.data),o([]);let a=i==null?void 0:i[g];a&&a.parking&&a.area&&(A(a.parking),u(a.area),p({type:"set",redirectParams:{...i,[g]:{}}}))}})},[]),r.useEffect(()=>{l&&$("",0,l.ParkingID,-100,1,1e4).then(e=>{T(e.data.data.filter(a=>!a.IsParent&&a.ParkingID===l.ParkingID))})},[l]),r.useEffect(()=>{n&&(P(n.AreaID).then(e=>{o(e.data)}),p({type:"set",redirectParams:{...i,[g]:{area:n,parking:l}}}))},[n]),r.useEffect(()=>{M(I.find(e=>e.ModuleID===H.id))},[I]);const R=r.useMemo(()=>[{accessorKey:"AreaCode",header:"AreaCode"},{accessorKey:"AreaName",header:"AreaName"}],[]),w=e=>{window.confirm("Are you sure you want to delete this user?")&&O(e.original.AreaID)},O=e=>{var a=localStorage.getItem("user");if(!a)return c("/pages/login");JSON.parse(a).data,e&&q(e).then(D=>{D.error?d(f(!0,"Error",D.error.response.data.message)):(P(n.AreaID).then(_=>{o(_.data)}),d(f(!1,"Success","Department have been deleted")))})},h=e=>{c(typeof e=="string"?"edit/0":`edit/${e.original.AreaID}`)};V({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0});const B=K({columns:R,data:L,renderTopToolbarCustomActions:({table:e})=>t.jsx("div",{className:m(s==null?void 0:s.IsInsert),children:t.jsx(J,{text:"Insert",callback:()=>h("edit")})}),enableGlobalFilter:!1,enableColumnActions:!1,enableRowActions:!((s==null?void 0:s.IsUpdate)===0&&(s==null?void 0:s.IsDelete)===0),enableColumnFilters:!1,enableFullScreenToggle:!1,visibleInShowHideMenu:!1,enableDensityToggle:!1,enableRowNumbers:!0,initialState:{expanded:!0,density:"compact"},enableExpanding:!1,enableHiding:!1,muiTablePaperProps:{elevation:0},muiTableBodyProps:{sx:{"& tr:nth-of-type(odd) > td":{backgroundColor:"#f5f5f5"}}},renderRowActionMenuItems:({closeMenu:e,row:a})=>[t.jsxs(k,{className:m(s==null?void 0:s.IsUpdate),onClick:()=>{h(a),e()},children:[t.jsx(z,{}),"Edit"]},0),t.jsxs(k,{className:m(s==null?void 0:s.IsDelete),onClick:()=>{w(a),e()},children:[t.jsx(Z,{}),"Delete"]},1)]});return t.jsxs(b,{fluid:!0,children:[t.jsxs(b,{style:{background:"#fff",padding:12,borderRadius:4},className:"row g-3",fluid:!0,children:[t.jsx(C,{xs:6,children:t.jsx(j,{size:"small",disablePortal:!0,disableClearable:!0,id:"cbParking",value:l,onChange:(e,a)=>{A(a),u(null)},options:y,getOptionLabel:e=>`${e.ParkingName}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.ParkingID)===(a==null?void 0:a.ParkingID),renderInput:e=>t.jsx(E,{...e,label:"Branch"})})}),t.jsx(C,{xs:6,children:t.jsx(j,{size:"small",disablePortal:!0,disableClearable:!0,id:"cbArea",value:n,onChange:(e,a)=>{u(a),o([])},options:N,getOptionLabel:e=>`${e==null?void 0:e.AreaCode}`,isOptionEqualToValue:(e,a)=>(e==null?void 0:e.AreaID)===(a==null?void 0:a.AreaID),renderInput:e=>t.jsx(E,{...e,label:"Area"})})})]}),t.jsx(b,{style:{background:"#fff",padding:12,borderRadius:4,marginBottom:12},className:"row g-3",fluid:!0,children:t.jsx(G,{table:B})})]})};export{ne as default};
