var Ed=Object.defineProperty;var Td=(A,f,i)=>f in A?Ed(A,f,{enumerable:!0,configurable:!0,writable:!0,value:i}):A[f]=i;var ft=(A,f,i)=>(Td(A,typeof f!="symbol"?f+"":f,i),i);import{r as dt,y as Le,q as Rd,j as Io}from"./index-CBwSRH0u.js";const Mo=Object.freeze({x:0,y:0,untransformedX:0,untransformedY:0}),Rr=Object.freeze({canvasWidth:0,canvasHeight:0,left:0,top:0,right:0,bottom:0,viewMin:Mo,viewMax:Mo}),re=Object.freeze({a:1,b:0,c:0,d:1,e:0,f:0});class Od{constructor(f,i){ft(this,"_canvas",null);ft(this,"_view",{scale:1,x:0,y:0});ft(this,"_viewChangeListeners",new Set);ft(this,"_initialViewSize",{width:0,height:0});this._scaleExtents=f,this._documentSize=i}get canvas(){return this._canvas}set canvas(f){this._canvas=f,this.setView()}get scale(){return this._view.scale}setScale(f){this.setView({scale:f})}get initialViewSize(){return this._initialViewSize}set initialViewSize(f){this._initialViewSize=f}get x(){return this._view.x}set x(f){this.setView({x:f})}get y(){return this._view.y}set y(f){this.setView({y:f})}get view(){return{...this._view}}get scaleExtents(){return{...this._scaleExtents}}set scaleExtents(f){this._scaleExtents={...f},this.setView()}get documentSize(){return{...this._documentSize}}set documentSize(f){this._documentSize={...f},this.setView()}get transformMatrix(){return{a:this._view.scale,b:0,c:0,d:this._view.scale,e:this._view.x,f:this._view.y}}get canvasBounds(){if(this._canvas){const{left:f,top:i,right:p,bottom:_}=this._canvas.getBoundingClientRect();return{viewMin:this.clientPointToViewPoint({clientX:f,clientY:i}),viewMax:this.clientPointToViewPoint({clientX:p,clientY:_}),left:f,top:i,right:p,bottom:_,canvasWidth:this._canvas.width,canvasHeight:this._canvas.height}}else return}get canvasRect(){if(this._canvas)return this._canvas.getBoundingClientRect()}clampView(f){const{min:i,max:p}=this._scaleExtents,{width:_,height:E}=this._documentSize,{left:x,top:b,right:N,bottom:B}=this.canvasRect||Rr,L=N-x,R=B-b,K=L/2,rt=-(_*this._view.scale-L/2),ht=R/2,V=-(E*this._view.scale-R/2);return{scale:Math.min(Math.max(f.scale,i),p),x:Math.min(Math.max(f.x,rt),K),y:Math.min(Math.max(f.y,V),ht)}}resetView(){this.setView({scale:1,x:0,y:0})}setView(f){const i=this.clampView({...this._view,...f||{}}),{scale:p,x:_,y:E}=this._view;return(i.scale!==p||i.x!==_||i.y!==E)&&(this._view=i,this._viewChangeListeners.forEach(x=>x&&x({view:i,transform:this.transformMatrix}))),{...this._view}}scaleAtClientPoint(f,i){const p=this.clientPointToViewPoint(i),_=this.clampView({...this._view,scale:this._view.scale+f}),E=this.viewPointToClientPoint(p,_);_.x=this._view.x-(E.clientX-i.clientX),_.y=this._view.y-(E.clientY-i.clientY);const{width:x,height:b}=this._documentSize,{left:N,top:B,right:L,bottom:R}=this.canvasRect||Rr,K=L-N,rt=R-B,ht=K/2,V=-(x*_.scale-K/2),j=rt/2,W=-(b*_.scale-rt/2);return _.x=Math.min(Math.max(_.x,V),ht),_.y=Math.min(Math.max(_.y,W),j),_.scale===this._scaleExtents.min&&(_.x=0,_.y=0),this.setView(_)}clientPointToViewPoint(f,i=this._view){const{left:p,top:_}=this.canvasRect||Rr,E=f.clientX-p,x=f.clientY-_;return{x:(E-i.x)/i.scale,y:(x-i.y)/i.scale,relativeClientX:E,relativeClientY:x}}viewPointToClientPoint(f,i=this._view){const{left:p,top:_}=this.canvasRect||Rr,E=f.x*i.scale+i.x,x=f.y*i.scale+i.y,b=E+p,N=x+_;return{clientX:b,clientY:N,relativeX:E,relativeY:x,x:b,y:N}}attachViewChangeListener(f){this._viewChangeListeners.add(f)}}const Ad=(A,f,i)=>{A.width=f,A.height=i,A.style.width=`${f}px`,A.style.height=`${i}px`},Ld=(A,f)=>{for(const i in A)Object.prototype.hasOwnProperty.call(A,i)&&Ad(A[i],f.width,f.height)};function Id({ctx:A,image:f,x:i=0,y:p=0,w:_=A.canvas.width,h:E=A.canvas.height,offsetX:x=.5,offsetY:b=.5}){x<0&&(x=0),b<0&&(b=0),x>1&&(x=1),b>1&&(b=1);const N=f.width,B=f.height,L=Math.min(_/N,E/B);let R=N*L,K=B*L,rt,ht,V,j,W=1;R<_&&(W=_/R),Math.abs(W-1)<1e-14&&K<E&&(W=E/K),R*=W,K*=W,V=N/(R/_),j=B/(K/E),rt=(N-V)*x,ht=(B-j)*b,rt<0&&(rt=0),ht<0&&(ht=0),V>N&&(V=N),j>B&&(j=B),A.drawImage(f,rt,ht,V,j,i,p,_,E)}function Md({canvas:A,ctx:f,image:i}){if(i&&i.complete&&A&&f){const p=i.width,_=i.height,E=A.getBoundingClientRect(),x=E.width,b=E.height,N=p/_;let B=x,L=B/N;L>b&&(L=b,B=L*N),f.drawImage(i,0,0,p,_,0,0,B,L)}}function Cd({canvas:A,ctx:f,image:i}){if(i&&i.complete&&A&&f){const p=i.width,_=i.height,E=A.getBoundingClientRect(),x=E.width,b=E.height;f.drawImage(i,0,0,p,_,0,0,x,b)}}function bd(A){const f=dt.useRef(null),[i,p]=dt.useState({width:window.innerWidth,height:window.innerHeight});return dt.useEffect(()=>{const _=new ResizeObserver(E=>{for(const x of E){if(x.contentRect){const{width:b,height:N}=x.contentRect;p({width:b,height:N})}typeof A=="function"&&A(x)}});return f.current&&_.observe(f.current),()=>{_.disconnect()}},[A]),{containerRef:f,screenSize:i}}class Me{constructor(f,i){this._stateMachine=f,this._name=i}get stateMachine(){return this._stateMachine}get name(){return this._name}}class Nd extends Me{constructor(f,i){super(f,i)}onEnter(){}onExit(){}handleMouseWheel(f,i){}handleMouseDown(f,i){}handleMouseMove(f,i){}handleMouseUp(f,i){}}var Or={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Or.exports;(function(A,f){(function(){var i,p="4.17.21",_=200,E="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",x="Expected a function",b="Invalid `variable` option passed into `_.template`",N="__lodash_hash_undefined__",B=500,L="__lodash_placeholder__",R=1,K=2,rt=4,ht=1,V=2,j=1,W=2,it=4,at=8,Zt=16,Ut=32,mn=64,Ft=128,Mn=256,ue=512,Ce=30,y="...",Z=800,q=16,_t=1,on=2,fn=3,At=1/0,nt=9007199254740991,No=17976931348623157e292,be=NaN,en=4294967295,Do=en-1,Po=en>>>1,Bo=[["ary",Ft],["bind",j],["bindKey",W],["curry",at],["curryRight",Zt],["flip",ue],["partial",Ut],["partialRight",mn],["rearg",Mn]],zn="[object Arguments]",Ne="[object Array]",Ho="[object AsyncFunction]",se="[object Boolean]",oe="[object Date]",Uo="[object DOMException]",De="[object Error]",Pe="[object Function]",Qi="[object GeneratorFunction]",$t="[object Map]",fe="[object Number]",Fo="[object Null]",an="[object Object]",ki="[object Promise]",Wo="[object Proxy]",ae="[object RegExp]",Qt="[object Set]",le="[object String]",Be="[object Symbol]",zo="[object Undefined]",ce="[object WeakMap]",Xo="[object WeakSet]",he="[object ArrayBuffer]",Xn="[object DataView]",Lr="[object Float32Array]",Ir="[object Float64Array]",Mr="[object Int8Array]",Cr="[object Int16Array]",br="[object Int32Array]",Nr="[object Uint8Array]",Dr="[object Uint8ClampedArray]",Pr="[object Uint16Array]",Br="[object Uint32Array]",Ko=/\b__p \+= '';/g,Go=/\b(__p \+=) '' \+/g,qo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ji=/&(?:amp|lt|gt|quot|#39);/g,tu=/[&<>"']/g,Yo=RegExp(ji.source),Jo=RegExp(tu.source),Vo=/<%-([\s\S]+?)%>/g,Zo=/<%([\s\S]+?)%>/g,nu=/<%=([\s\S]+?)%>/g,$o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qo=/^\w*$/,ko=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hr=/[\\^$.*+?()[\]{}|]/g,jo=RegExp(Hr.source),Ur=/^\s+/,tf=/\s/,nf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ef=/\{\n\/\* \[wrapped with (.+)\] \*/,rf=/,? & /,uf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,sf=/[()=,{}\[\]\/\s]/,of=/\\(\\)?/g,ff=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,eu=/\w*$/,af=/^[-+]0x[0-9a-f]+$/i,lf=/^0b[01]+$/i,cf=/^\[object .+?Constructor\]$/,hf=/^0o[0-7]+$/i,gf=/^(?:0|[1-9]\d*)$/,pf=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,He=/($^)/,df=/['\n\r\u2028\u2029\\]/g,Ue="\\ud800-\\udfff",_f="\\u0300-\\u036f",vf="\\ufe20-\\ufe2f",wf="\\u20d0-\\u20ff",ru=_f+vf+wf,iu="\\u2700-\\u27bf",uu="a-z\\xdf-\\xf6\\xf8-\\xff",mf="\\xac\\xb1\\xd7\\xf7",xf="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Sf="\\u2000-\\u206f",yf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",su="A-Z\\xc0-\\xd6\\xd8-\\xde",ou="\\ufe0e\\ufe0f",fu=mf+xf+Sf+yf,Fr="['’]",Ef="["+Ue+"]",au="["+fu+"]",Fe="["+ru+"]",lu="\\d+",Tf="["+iu+"]",cu="["+uu+"]",hu="[^"+Ue+fu+lu+iu+uu+su+"]",Wr="\\ud83c[\\udffb-\\udfff]",Rf="(?:"+Fe+"|"+Wr+")",gu="[^"+Ue+"]",zr="(?:\\ud83c[\\udde6-\\uddff]){2}",Xr="[\\ud800-\\udbff][\\udc00-\\udfff]",Kn="["+su+"]",pu="\\u200d",du="(?:"+cu+"|"+hu+")",Of="(?:"+Kn+"|"+hu+")",_u="(?:"+Fr+"(?:d|ll|m|re|s|t|ve))?",vu="(?:"+Fr+"(?:D|LL|M|RE|S|T|VE))?",wu=Rf+"?",mu="["+ou+"]?",Af="(?:"+pu+"(?:"+[gu,zr,Xr].join("|")+")"+mu+wu+")*",Lf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",If="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",xu=mu+wu+Af,Mf="(?:"+[Tf,zr,Xr].join("|")+")"+xu,Cf="(?:"+[gu+Fe+"?",Fe,zr,Xr,Ef].join("|")+")",bf=RegExp(Fr,"g"),Nf=RegExp(Fe,"g"),Kr=RegExp(Wr+"(?="+Wr+")|"+Cf+xu,"g"),Df=RegExp([Kn+"?"+cu+"+"+_u+"(?="+[au,Kn,"$"].join("|")+")",Of+"+"+vu+"(?="+[au,Kn+du,"$"].join("|")+")",Kn+"?"+du+"+"+_u,Kn+"+"+vu,If,Lf,lu,Mf].join("|"),"g"),Pf=RegExp("["+pu+Ue+ru+ou+"]"),Bf=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Hf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Uf=-1,et={};et[Lr]=et[Ir]=et[Mr]=et[Cr]=et[br]=et[Nr]=et[Dr]=et[Pr]=et[Br]=!0,et[zn]=et[Ne]=et[he]=et[se]=et[Xn]=et[oe]=et[De]=et[Pe]=et[$t]=et[fe]=et[an]=et[ae]=et[Qt]=et[le]=et[ce]=!1;var tt={};tt[zn]=tt[Ne]=tt[he]=tt[Xn]=tt[se]=tt[oe]=tt[Lr]=tt[Ir]=tt[Mr]=tt[Cr]=tt[br]=tt[$t]=tt[fe]=tt[an]=tt[ae]=tt[Qt]=tt[le]=tt[Be]=tt[Nr]=tt[Dr]=tt[Pr]=tt[Br]=!0,tt[De]=tt[Pe]=tt[ce]=!1;var Ff={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Wf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},zf={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Xf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Kf=parseFloat,Gf=parseInt,Su=typeof Le=="object"&&Le&&Le.Object===Object&&Le,qf=typeof self=="object"&&self&&self.Object===Object&&self,wt=Su||qf||Function("return this")(),Gr=f&&!f.nodeType&&f,Cn=Gr&&!0&&A&&!A.nodeType&&A,yu=Cn&&Cn.exports===Gr,qr=yu&&Su.process,Wt=function(){try{var c=Cn&&Cn.require&&Cn.require("util").types;return c||qr&&qr.binding&&qr.binding("util")}catch{}}(),Eu=Wt&&Wt.isArrayBuffer,Tu=Wt&&Wt.isDate,Ru=Wt&&Wt.isMap,Ou=Wt&&Wt.isRegExp,Au=Wt&&Wt.isSet,Lu=Wt&&Wt.isTypedArray;function bt(c,d,g){switch(g.length){case 0:return c.call(d);case 1:return c.call(d,g[0]);case 2:return c.call(d,g[0],g[1]);case 3:return c.call(d,g[0],g[1],g[2])}return c.apply(d,g)}function Yf(c,d,g,T){for(var D=-1,Y=c==null?0:c.length;++D<Y;){var gt=c[D];d(T,gt,g(gt),c)}return T}function zt(c,d){for(var g=-1,T=c==null?0:c.length;++g<T&&d(c[g],g,c)!==!1;);return c}function Jf(c,d){for(var g=c==null?0:c.length;g--&&d(c[g],g,c)!==!1;);return c}function Iu(c,d){for(var g=-1,T=c==null?0:c.length;++g<T;)if(!d(c[g],g,c))return!1;return!0}function xn(c,d){for(var g=-1,T=c==null?0:c.length,D=0,Y=[];++g<T;){var gt=c[g];d(gt,g,c)&&(Y[D++]=gt)}return Y}function We(c,d){var g=c==null?0:c.length;return!!g&&Gn(c,d,0)>-1}function Yr(c,d,g){for(var T=-1,D=c==null?0:c.length;++T<D;)if(g(d,c[T]))return!0;return!1}function ut(c,d){for(var g=-1,T=c==null?0:c.length,D=Array(T);++g<T;)D[g]=d(c[g],g,c);return D}function Sn(c,d){for(var g=-1,T=d.length,D=c.length;++g<T;)c[D+g]=d[g];return c}function Jr(c,d,g,T){var D=-1,Y=c==null?0:c.length;for(T&&Y&&(g=c[++D]);++D<Y;)g=d(g,c[D],D,c);return g}function Vf(c,d,g,T){var D=c==null?0:c.length;for(T&&D&&(g=c[--D]);D--;)g=d(g,c[D],D,c);return g}function Vr(c,d){for(var g=-1,T=c==null?0:c.length;++g<T;)if(d(c[g],g,c))return!0;return!1}var Zf=Zr("length");function $f(c){return c.split("")}function Qf(c){return c.match(uf)||[]}function Mu(c,d,g){var T;return g(c,function(D,Y,gt){if(d(D,Y,gt))return T=Y,!1}),T}function ze(c,d,g,T){for(var D=c.length,Y=g+(T?1:-1);T?Y--:++Y<D;)if(d(c[Y],Y,c))return Y;return-1}function Gn(c,d,g){return d===d?aa(c,d,g):ze(c,Cu,g)}function kf(c,d,g,T){for(var D=g-1,Y=c.length;++D<Y;)if(T(c[D],d))return D;return-1}function Cu(c){return c!==c}function bu(c,d){var g=c==null?0:c.length;return g?Qr(c,d)/g:be}function Zr(c){return function(d){return d==null?i:d[c]}}function $r(c){return function(d){return c==null?i:c[d]}}function Nu(c,d,g,T,D){return D(c,function(Y,gt,k){g=T?(T=!1,Y):d(g,Y,gt,k)}),g}function jf(c,d){var g=c.length;for(c.sort(d);g--;)c[g]=c[g].value;return c}function Qr(c,d){for(var g,T=-1,D=c.length;++T<D;){var Y=d(c[T]);Y!==i&&(g=g===i?Y:g+Y)}return g}function kr(c,d){for(var g=-1,T=Array(c);++g<c;)T[g]=d(g);return T}function ta(c,d){return ut(d,function(g){return[g,c[g]]})}function Du(c){return c&&c.slice(0,Uu(c)+1).replace(Ur,"")}function Nt(c){return function(d){return c(d)}}function jr(c,d){return ut(d,function(g){return c[g]})}function ge(c,d){return c.has(d)}function Pu(c,d){for(var g=-1,T=c.length;++g<T&&Gn(d,c[g],0)>-1;);return g}function Bu(c,d){for(var g=c.length;g--&&Gn(d,c[g],0)>-1;);return g}function na(c,d){for(var g=c.length,T=0;g--;)c[g]===d&&++T;return T}var ea=$r(Ff),ra=$r(Wf);function ia(c){return"\\"+Xf[c]}function ua(c,d){return c==null?i:c[d]}function qn(c){return Pf.test(c)}function sa(c){return Bf.test(c)}function oa(c){for(var d,g=[];!(d=c.next()).done;)g.push(d.value);return g}function ti(c){var d=-1,g=Array(c.size);return c.forEach(function(T,D){g[++d]=[D,T]}),g}function Hu(c,d){return function(g){return c(d(g))}}function yn(c,d){for(var g=-1,T=c.length,D=0,Y=[];++g<T;){var gt=c[g];(gt===d||gt===L)&&(c[g]=L,Y[D++]=g)}return Y}function Xe(c){var d=-1,g=Array(c.size);return c.forEach(function(T){g[++d]=T}),g}function fa(c){var d=-1,g=Array(c.size);return c.forEach(function(T){g[++d]=[T,T]}),g}function aa(c,d,g){for(var T=g-1,D=c.length;++T<D;)if(c[T]===d)return T;return-1}function la(c,d,g){for(var T=g+1;T--;)if(c[T]===d)return T;return T}function Yn(c){return qn(c)?ha(c):Zf(c)}function kt(c){return qn(c)?ga(c):$f(c)}function Uu(c){for(var d=c.length;d--&&tf.test(c.charAt(d)););return d}var ca=$r(zf);function ha(c){for(var d=Kr.lastIndex=0;Kr.test(c);)++d;return d}function ga(c){return c.match(Kr)||[]}function pa(c){return c.match(Df)||[]}var da=function c(d){d=d==null?wt:Jn.defaults(wt.Object(),d,Jn.pick(wt,Hf));var g=d.Array,T=d.Date,D=d.Error,Y=d.Function,gt=d.Math,k=d.Object,ni=d.RegExp,_a=d.String,Xt=d.TypeError,Ke=g.prototype,va=Y.prototype,Vn=k.prototype,Ge=d["__core-js_shared__"],qe=va.toString,$=Vn.hasOwnProperty,wa=0,Fu=function(){var t=/[^.]+$/.exec(Ge&&Ge.keys&&Ge.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ye=Vn.toString,ma=qe.call(k),xa=wt._,Sa=ni("^"+qe.call($).replace(Hr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Je=yu?d.Buffer:i,En=d.Symbol,Ve=d.Uint8Array,Wu=Je?Je.allocUnsafe:i,Ze=Hu(k.getPrototypeOf,k),zu=k.create,Xu=Vn.propertyIsEnumerable,$e=Ke.splice,Ku=En?En.isConcatSpreadable:i,pe=En?En.iterator:i,bn=En?En.toStringTag:i,Qe=function(){try{var t=Hn(k,"defineProperty");return t({},"",{}),t}catch{}}(),ya=d.clearTimeout!==wt.clearTimeout&&d.clearTimeout,Ea=T&&T.now!==wt.Date.now&&T.now,Ta=d.setTimeout!==wt.setTimeout&&d.setTimeout,ke=gt.ceil,je=gt.floor,ei=k.getOwnPropertySymbols,Ra=Je?Je.isBuffer:i,Gu=d.isFinite,Oa=Ke.join,Aa=Hu(k.keys,k),pt=gt.max,xt=gt.min,La=T.now,Ia=d.parseInt,qu=gt.random,Ma=Ke.reverse,ri=Hn(d,"DataView"),de=Hn(d,"Map"),ii=Hn(d,"Promise"),Zn=Hn(d,"Set"),_e=Hn(d,"WeakMap"),ve=Hn(k,"create"),tr=_e&&new _e,$n={},Ca=Un(ri),ba=Un(de),Na=Un(ii),Da=Un(Zn),Pa=Un(_e),nr=En?En.prototype:i,we=nr?nr.valueOf:i,Yu=nr?nr.toString:i;function s(t){if(ot(t)&&!P(t)&&!(t instanceof X)){if(t instanceof Kt)return t;if($.call(t,"__wrapped__"))return Js(t)}return new Kt(t)}var Qn=function(){function t(){}return function(n){if(!st(n))return{};if(zu)return zu(n);t.prototype=n;var e=new t;return t.prototype=i,e}}();function er(){}function Kt(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=i}s.templateSettings={escape:Vo,evaluate:Zo,interpolate:nu,variable:"",imports:{_:s}},s.prototype=er.prototype,s.prototype.constructor=s,Kt.prototype=Qn(er.prototype),Kt.prototype.constructor=Kt;function X(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=en,this.__views__=[]}function Ba(){var t=new X(this.__wrapped__);return t.__actions__=Lt(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Lt(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Lt(this.__views__),t}function Ha(){if(this.__filtered__){var t=new X(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Ua(){var t=this.__wrapped__.value(),n=this.__dir__,e=P(t),r=n<0,u=e?t.length:0,o=$l(0,u,this.__views__),a=o.start,l=o.end,h=l-a,v=r?l:a-1,w=this.__iteratees__,m=w.length,S=0,O=xt(h,this.__takeCount__);if(!e||!r&&u==h&&O==h)return _s(t,this.__actions__);var M=[];t:for(;h--&&S<O;){v+=n;for(var U=-1,C=t[v];++U<m;){var z=w[U],G=z.iteratee,Bt=z.type,Rt=G(C);if(Bt==on)C=Rt;else if(!Rt){if(Bt==_t)continue t;break t}}M[S++]=C}return M}X.prototype=Qn(er.prototype),X.prototype.constructor=X;function Nn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function Fa(){this.__data__=ve?ve(null):{},this.size=0}function Wa(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function za(t){var n=this.__data__;if(ve){var e=n[t];return e===N?i:e}return $.call(n,t)?n[t]:i}function Xa(t){var n=this.__data__;return ve?n[t]!==i:$.call(n,t)}function Ka(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=ve&&n===i?N:n,this}Nn.prototype.clear=Fa,Nn.prototype.delete=Wa,Nn.prototype.get=za,Nn.prototype.has=Xa,Nn.prototype.set=Ka;function ln(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function Ga(){this.__data__=[],this.size=0}function qa(t){var n=this.__data__,e=rr(n,t);if(e<0)return!1;var r=n.length-1;return e==r?n.pop():$e.call(n,e,1),--this.size,!0}function Ya(t){var n=this.__data__,e=rr(n,t);return e<0?i:n[e][1]}function Ja(t){return rr(this.__data__,t)>-1}function Va(t,n){var e=this.__data__,r=rr(e,t);return r<0?(++this.size,e.push([t,n])):e[r][1]=n,this}ln.prototype.clear=Ga,ln.prototype.delete=qa,ln.prototype.get=Ya,ln.prototype.has=Ja,ln.prototype.set=Va;function cn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function Za(){this.size=0,this.__data__={hash:new Nn,map:new(de||ln),string:new Nn}}function $a(t){var n=dr(this,t).delete(t);return this.size-=n?1:0,n}function Qa(t){return dr(this,t).get(t)}function ka(t){return dr(this,t).has(t)}function ja(t,n){var e=dr(this,t),r=e.size;return e.set(t,n),this.size+=e.size==r?0:1,this}cn.prototype.clear=Za,cn.prototype.delete=$a,cn.prototype.get=Qa,cn.prototype.has=ka,cn.prototype.set=ja;function Dn(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new cn;++n<e;)this.add(t[n])}function tl(t){return this.__data__.set(t,N),this}function nl(t){return this.__data__.has(t)}Dn.prototype.add=Dn.prototype.push=tl,Dn.prototype.has=nl;function jt(t){var n=this.__data__=new ln(t);this.size=n.size}function el(){this.__data__=new ln,this.size=0}function rl(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}function il(t){return this.__data__.get(t)}function ul(t){return this.__data__.has(t)}function sl(t,n){var e=this.__data__;if(e instanceof ln){var r=e.__data__;if(!de||r.length<_-1)return r.push([t,n]),this.size=++e.size,this;e=this.__data__=new cn(r)}return e.set(t,n),this.size=e.size,this}jt.prototype.clear=el,jt.prototype.delete=rl,jt.prototype.get=il,jt.prototype.has=ul,jt.prototype.set=sl;function Ju(t,n){var e=P(t),r=!e&&Fn(t),u=!e&&!r&&Ln(t),o=!e&&!r&&!u&&ne(t),a=e||r||u||o,l=a?kr(t.length,_a):[],h=l.length;for(var v in t)(n||$.call(t,v))&&!(a&&(v=="length"||u&&(v=="offset"||v=="parent")||o&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||dn(v,h)))&&l.push(v);return l}function Vu(t){var n=t.length;return n?t[di(0,n-1)]:i}function ol(t,n){return _r(Lt(t),Pn(n,0,t.length))}function fl(t){return _r(Lt(t))}function ui(t,n,e){(e!==i&&!tn(t[n],e)||e===i&&!(n in t))&&hn(t,n,e)}function me(t,n,e){var r=t[n];(!($.call(t,n)&&tn(r,e))||e===i&&!(n in t))&&hn(t,n,e)}function rr(t,n){for(var e=t.length;e--;)if(tn(t[e][0],n))return e;return-1}function al(t,n,e,r){return Tn(t,function(u,o,a){n(r,u,e(u),a)}),r}function Zu(t,n){return t&&un(n,vt(n),t)}function ll(t,n){return t&&un(n,Mt(n),t)}function hn(t,n,e){n=="__proto__"&&Qe?Qe(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function si(t,n){for(var e=-1,r=n.length,u=g(r),o=t==null;++e<r;)u[e]=o?i:Wi(t,n[e]);return u}function Pn(t,n,e){return t===t&&(e!==i&&(t=t<=e?t:e),n!==i&&(t=t>=n?t:n)),t}function Gt(t,n,e,r,u,o){var a,l=n&R,h=n&K,v=n&rt;if(e&&(a=u?e(t,r,u,o):e(t)),a!==i)return a;if(!st(t))return t;var w=P(t);if(w){if(a=kl(t),!l)return Lt(t,a)}else{var m=St(t),S=m==Pe||m==Qi;if(Ln(t))return ms(t,l);if(m==an||m==zn||S&&!u){if(a=h||S?{}:Us(t),!l)return h?zl(t,ll(a,t)):Wl(t,Zu(a,t))}else{if(!tt[m])return u?t:{};a=jl(t,m,l)}}o||(o=new jt);var O=o.get(t);if(O)return O;o.set(t,a),go(t)?t.forEach(function(C){a.add(Gt(C,n,e,C,t,o))}):co(t)&&t.forEach(function(C,z){a.set(z,Gt(C,n,e,z,t,o))});var M=v?h?Oi:Ri:h?Mt:vt,U=w?i:M(t);return zt(U||t,function(C,z){U&&(z=C,C=t[z]),me(a,z,Gt(C,n,e,z,t,o))}),a}function cl(t){var n=vt(t);return function(e){return $u(e,t,n)}}function $u(t,n,e){var r=e.length;if(t==null)return!r;for(t=k(t);r--;){var u=e[r],o=n[u],a=t[u];if(a===i&&!(u in t)||!o(a))return!1}return!0}function Qu(t,n,e){if(typeof t!="function")throw new Xt(x);return Oe(function(){t.apply(i,e)},n)}function xe(t,n,e,r){var u=-1,o=We,a=!0,l=t.length,h=[],v=n.length;if(!l)return h;e&&(n=ut(n,Nt(e))),r?(o=Yr,a=!1):n.length>=_&&(o=ge,a=!1,n=new Dn(n));t:for(;++u<l;){var w=t[u],m=e==null?w:e(w);if(w=r||w!==0?w:0,a&&m===m){for(var S=v;S--;)if(n[S]===m)continue t;h.push(w)}else o(n,m,r)||h.push(w)}return h}var Tn=Ts(rn),ku=Ts(fi,!0);function hl(t,n){var e=!0;return Tn(t,function(r,u,o){return e=!!n(r,u,o),e}),e}function ir(t,n,e){for(var r=-1,u=t.length;++r<u;){var o=t[r],a=n(o);if(a!=null&&(l===i?a===a&&!Pt(a):e(a,l)))var l=a,h=o}return h}function gl(t,n,e,r){var u=t.length;for(e=H(e),e<0&&(e=-e>u?0:u+e),r=r===i||r>u?u:H(r),r<0&&(r+=u),r=e>r?0:_o(r);e<r;)t[e++]=n;return t}function ju(t,n){var e=[];return Tn(t,function(r,u,o){n(r,u,o)&&e.push(r)}),e}function mt(t,n,e,r,u){var o=-1,a=t.length;for(e||(e=nc),u||(u=[]);++o<a;){var l=t[o];n>0&&e(l)?n>1?mt(l,n-1,e,r,u):Sn(u,l):r||(u[u.length]=l)}return u}var oi=Rs(),ts=Rs(!0);function rn(t,n){return t&&oi(t,n,vt)}function fi(t,n){return t&&ts(t,n,vt)}function ur(t,n){return xn(n,function(e){return _n(t[e])})}function Bn(t,n){n=On(n,t);for(var e=0,r=n.length;t!=null&&e<r;)t=t[sn(n[e++])];return e&&e==r?t:i}function ns(t,n,e){var r=n(t);return P(t)?r:Sn(r,e(t))}function Et(t){return t==null?t===i?zo:Fo:bn&&bn in k(t)?Zl(t):fc(t)}function ai(t,n){return t>n}function pl(t,n){return t!=null&&$.call(t,n)}function dl(t,n){return t!=null&&n in k(t)}function _l(t,n,e){return t>=xt(n,e)&&t<pt(n,e)}function li(t,n,e){for(var r=e?Yr:We,u=t[0].length,o=t.length,a=o,l=g(o),h=1/0,v=[];a--;){var w=t[a];a&&n&&(w=ut(w,Nt(n))),h=xt(w.length,h),l[a]=!e&&(n||u>=120&&w.length>=120)?new Dn(a&&w):i}w=t[0];var m=-1,S=l[0];t:for(;++m<u&&v.length<h;){var O=w[m],M=n?n(O):O;if(O=e||O!==0?O:0,!(S?ge(S,M):r(v,M,e))){for(a=o;--a;){var U=l[a];if(!(U?ge(U,M):r(t[a],M,e)))continue t}S&&S.push(M),v.push(O)}}return v}function vl(t,n,e,r){return rn(t,function(u,o,a){n(r,e(u),o,a)}),r}function Se(t,n,e){n=On(n,t),t=Xs(t,n);var r=t==null?t:t[sn(Yt(n))];return r==null?i:bt(r,t,e)}function es(t){return ot(t)&&Et(t)==zn}function wl(t){return ot(t)&&Et(t)==he}function ml(t){return ot(t)&&Et(t)==oe}function ye(t,n,e,r,u){return t===n?!0:t==null||n==null||!ot(t)&&!ot(n)?t!==t&&n!==n:xl(t,n,e,r,ye,u)}function xl(t,n,e,r,u,o){var a=P(t),l=P(n),h=a?Ne:St(t),v=l?Ne:St(n);h=h==zn?an:h,v=v==zn?an:v;var w=h==an,m=v==an,S=h==v;if(S&&Ln(t)){if(!Ln(n))return!1;a=!0,w=!1}if(S&&!w)return o||(o=new jt),a||ne(t)?Ps(t,n,e,r,u,o):Jl(t,n,h,e,r,u,o);if(!(e&ht)){var O=w&&$.call(t,"__wrapped__"),M=m&&$.call(n,"__wrapped__");if(O||M){var U=O?t.value():t,C=M?n.value():n;return o||(o=new jt),u(U,C,e,r,o)}}return S?(o||(o=new jt),Vl(t,n,e,r,u,o)):!1}function Sl(t){return ot(t)&&St(t)==$t}function ci(t,n,e,r){var u=e.length,o=u,a=!r;if(t==null)return!o;for(t=k(t);u--;){var l=e[u];if(a&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++u<o;){l=e[u];var h=l[0],v=t[h],w=l[1];if(a&&l[2]){if(v===i&&!(h in t))return!1}else{var m=new jt;if(r)var S=r(v,w,h,t,n,m);if(!(S===i?ye(w,v,ht|V,r,m):S))return!1}}return!0}function rs(t){if(!st(t)||rc(t))return!1;var n=_n(t)?Sa:cf;return n.test(Un(t))}function yl(t){return ot(t)&&Et(t)==ae}function El(t){return ot(t)&&St(t)==Qt}function Tl(t){return ot(t)&&yr(t.length)&&!!et[Et(t)]}function is(t){return typeof t=="function"?t:t==null?Ct:typeof t=="object"?P(t)?os(t[0],t[1]):ss(t):Ao(t)}function hi(t){if(!Re(t))return Aa(t);var n=[];for(var e in k(t))$.call(t,e)&&e!="constructor"&&n.push(e);return n}function Rl(t){if(!st(t))return oc(t);var n=Re(t),e=[];for(var r in t)r=="constructor"&&(n||!$.call(t,r))||e.push(r);return e}function gi(t,n){return t<n}function us(t,n){var e=-1,r=It(t)?g(t.length):[];return Tn(t,function(u,o,a){r[++e]=n(u,o,a)}),r}function ss(t){var n=Li(t);return n.length==1&&n[0][2]?Ws(n[0][0],n[0][1]):function(e){return e===t||ci(e,t,n)}}function os(t,n){return Mi(t)&&Fs(n)?Ws(sn(t),n):function(e){var r=Wi(e,t);return r===i&&r===n?zi(e,t):ye(n,r,ht|V)}}function sr(t,n,e,r,u){t!==n&&oi(n,function(o,a){if(u||(u=new jt),st(o))Ol(t,n,a,e,sr,r,u);else{var l=r?r(bi(t,a),o,a+"",t,n,u):i;l===i&&(l=o),ui(t,a,l)}},Mt)}function Ol(t,n,e,r,u,o,a){var l=bi(t,e),h=bi(n,e),v=a.get(h);if(v){ui(t,e,v);return}var w=o?o(l,h,e+"",t,n,a):i,m=w===i;if(m){var S=P(h),O=!S&&Ln(h),M=!S&&!O&&ne(h);w=h,S||O||M?P(l)?w=l:lt(l)?w=Lt(l):O?(m=!1,w=ms(h,!0)):M?(m=!1,w=xs(h,!0)):w=[]:Ae(h)||Fn(h)?(w=l,Fn(l)?w=vo(l):(!st(l)||_n(l))&&(w=Us(h))):m=!1}m&&(a.set(h,w),u(w,h,r,o,a),a.delete(h)),ui(t,e,w)}function fs(t,n){var e=t.length;if(e)return n+=n<0?e:0,dn(n,e)?t[n]:i}function as(t,n,e){n.length?n=ut(n,function(o){return P(o)?function(a){return Bn(a,o.length===1?o[0]:o)}:o}):n=[Ct];var r=-1;n=ut(n,Nt(I()));var u=us(t,function(o,a,l){var h=ut(n,function(v){return v(o)});return{criteria:h,index:++r,value:o}});return jf(u,function(o,a){return Fl(o,a,e)})}function Al(t,n){return ls(t,n,function(e,r){return zi(t,r)})}function ls(t,n,e){for(var r=-1,u=n.length,o={};++r<u;){var a=n[r],l=Bn(t,a);e(l,a)&&Ee(o,On(a,t),l)}return o}function Ll(t){return function(n){return Bn(n,t)}}function pi(t,n,e,r){var u=r?kf:Gn,o=-1,a=n.length,l=t;for(t===n&&(n=Lt(n)),e&&(l=ut(t,Nt(e)));++o<a;)for(var h=0,v=n[o],w=e?e(v):v;(h=u(l,w,h,r))>-1;)l!==t&&$e.call(l,h,1),$e.call(t,h,1);return t}function cs(t,n){for(var e=t?n.length:0,r=e-1;e--;){var u=n[e];if(e==r||u!==o){var o=u;dn(u)?$e.call(t,u,1):wi(t,u)}}return t}function di(t,n){return t+je(qu()*(n-t+1))}function Il(t,n,e,r){for(var u=-1,o=pt(ke((n-t)/(e||1)),0),a=g(o);o--;)a[r?o:++u]=t,t+=e;return a}function _i(t,n){var e="";if(!t||n<1||n>nt)return e;do n%2&&(e+=t),n=je(n/2),n&&(t+=t);while(n);return e}function F(t,n){return Ni(zs(t,n,Ct),t+"")}function Ml(t){return Vu(ee(t))}function Cl(t,n){var e=ee(t);return _r(e,Pn(n,0,e.length))}function Ee(t,n,e,r){if(!st(t))return t;n=On(n,t);for(var u=-1,o=n.length,a=o-1,l=t;l!=null&&++u<o;){var h=sn(n[u]),v=e;if(h==="__proto__"||h==="constructor"||h==="prototype")return t;if(u!=a){var w=l[h];v=r?r(w,h,l):i,v===i&&(v=st(w)?w:dn(n[u+1])?[]:{})}me(l,h,v),l=l[h]}return t}var hs=tr?function(t,n){return tr.set(t,n),t}:Ct,bl=Qe?function(t,n){return Qe(t,"toString",{configurable:!0,enumerable:!1,value:Ki(n),writable:!0})}:Ct;function Nl(t){return _r(ee(t))}function qt(t,n,e){var r=-1,u=t.length;n<0&&(n=-n>u?0:u+n),e=e>u?u:e,e<0&&(e+=u),u=n>e?0:e-n>>>0,n>>>=0;for(var o=g(u);++r<u;)o[r]=t[r+n];return o}function Dl(t,n){var e;return Tn(t,function(r,u,o){return e=n(r,u,o),!e}),!!e}function or(t,n,e){var r=0,u=t==null?r:t.length;if(typeof n=="number"&&n===n&&u<=Po){for(;r<u;){var o=r+u>>>1,a=t[o];a!==null&&!Pt(a)&&(e?a<=n:a<n)?r=o+1:u=o}return u}return vi(t,n,Ct,e)}function vi(t,n,e,r){var u=0,o=t==null?0:t.length;if(o===0)return 0;n=e(n);for(var a=n!==n,l=n===null,h=Pt(n),v=n===i;u<o;){var w=je((u+o)/2),m=e(t[w]),S=m!==i,O=m===null,M=m===m,U=Pt(m);if(a)var C=r||M;else v?C=M&&(r||S):l?C=M&&S&&(r||!O):h?C=M&&S&&!O&&(r||!U):O||U?C=!1:C=r?m<=n:m<n;C?u=w+1:o=w}return xt(o,Do)}function gs(t,n){for(var e=-1,r=t.length,u=0,o=[];++e<r;){var a=t[e],l=n?n(a):a;if(!e||!tn(l,h)){var h=l;o[u++]=a===0?0:a}}return o}function ps(t){return typeof t=="number"?t:Pt(t)?be:+t}function Dt(t){if(typeof t=="string")return t;if(P(t))return ut(t,Dt)+"";if(Pt(t))return Yu?Yu.call(t):"";var n=t+"";return n=="0"&&1/t==-At?"-0":n}function Rn(t,n,e){var r=-1,u=We,o=t.length,a=!0,l=[],h=l;if(e)a=!1,u=Yr;else if(o>=_){var v=n?null:ql(t);if(v)return Xe(v);a=!1,u=ge,h=new Dn}else h=n?[]:l;t:for(;++r<o;){var w=t[r],m=n?n(w):w;if(w=e||w!==0?w:0,a&&m===m){for(var S=h.length;S--;)if(h[S]===m)continue t;n&&h.push(m),l.push(w)}else u(h,m,e)||(h!==l&&h.push(m),l.push(w))}return l}function wi(t,n){return n=On(n,t),t=Xs(t,n),t==null||delete t[sn(Yt(n))]}function ds(t,n,e,r){return Ee(t,n,e(Bn(t,n)),r)}function fr(t,n,e,r){for(var u=t.length,o=r?u:-1;(r?o--:++o<u)&&n(t[o],o,t););return e?qt(t,r?0:o,r?o+1:u):qt(t,r?o+1:0,r?u:o)}function _s(t,n){var e=t;return e instanceof X&&(e=e.value()),Jr(n,function(r,u){return u.func.apply(u.thisArg,Sn([r],u.args))},e)}function mi(t,n,e){var r=t.length;if(r<2)return r?Rn(t[0]):[];for(var u=-1,o=g(r);++u<r;)for(var a=t[u],l=-1;++l<r;)l!=u&&(o[u]=xe(o[u]||a,t[l],n,e));return Rn(mt(o,1),n,e)}function vs(t,n,e){for(var r=-1,u=t.length,o=n.length,a={};++r<u;){var l=r<o?n[r]:i;e(a,t[r],l)}return a}function xi(t){return lt(t)?t:[]}function Si(t){return typeof t=="function"?t:Ct}function On(t,n){return P(t)?t:Mi(t,n)?[t]:Ys(J(t))}var Pl=F;function An(t,n,e){var r=t.length;return e=e===i?r:e,!n&&e>=r?t:qt(t,n,e)}var ws=ya||function(t){return wt.clearTimeout(t)};function ms(t,n){if(n)return t.slice();var e=t.length,r=Wu?Wu(e):new t.constructor(e);return t.copy(r),r}function yi(t){var n=new t.constructor(t.byteLength);return new Ve(n).set(new Ve(t)),n}function Bl(t,n){var e=n?yi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function Hl(t){var n=new t.constructor(t.source,eu.exec(t));return n.lastIndex=t.lastIndex,n}function Ul(t){return we?k(we.call(t)):{}}function xs(t,n){var e=n?yi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function Ss(t,n){if(t!==n){var e=t!==i,r=t===null,u=t===t,o=Pt(t),a=n!==i,l=n===null,h=n===n,v=Pt(n);if(!l&&!v&&!o&&t>n||o&&a&&h&&!l&&!v||r&&a&&h||!e&&h||!u)return 1;if(!r&&!o&&!v&&t<n||v&&e&&u&&!r&&!o||l&&e&&u||!a&&u||!h)return-1}return 0}function Fl(t,n,e){for(var r=-1,u=t.criteria,o=n.criteria,a=u.length,l=e.length;++r<a;){var h=Ss(u[r],o[r]);if(h){if(r>=l)return h;var v=e[r];return h*(v=="desc"?-1:1)}}return t.index-n.index}function ys(t,n,e,r){for(var u=-1,o=t.length,a=e.length,l=-1,h=n.length,v=pt(o-a,0),w=g(h+v),m=!r;++l<h;)w[l]=n[l];for(;++u<a;)(m||u<o)&&(w[e[u]]=t[u]);for(;v--;)w[l++]=t[u++];return w}function Es(t,n,e,r){for(var u=-1,o=t.length,a=-1,l=e.length,h=-1,v=n.length,w=pt(o-l,0),m=g(w+v),S=!r;++u<w;)m[u]=t[u];for(var O=u;++h<v;)m[O+h]=n[h];for(;++a<l;)(S||u<o)&&(m[O+e[a]]=t[u++]);return m}function Lt(t,n){var e=-1,r=t.length;for(n||(n=g(r));++e<r;)n[e]=t[e];return n}function un(t,n,e,r){var u=!e;e||(e={});for(var o=-1,a=n.length;++o<a;){var l=n[o],h=r?r(e[l],t[l],l,e,t):i;h===i&&(h=t[l]),u?hn(e,l,h):me(e,l,h)}return e}function Wl(t,n){return un(t,Ii(t),n)}function zl(t,n){return un(t,Bs(t),n)}function ar(t,n){return function(e,r){var u=P(e)?Yf:al,o=n?n():{};return u(e,t,I(r,2),o)}}function kn(t){return F(function(n,e){var r=-1,u=e.length,o=u>1?e[u-1]:i,a=u>2?e[2]:i;for(o=t.length>3&&typeof o=="function"?(u--,o):i,a&&Tt(e[0],e[1],a)&&(o=u<3?i:o,u=1),n=k(n);++r<u;){var l=e[r];l&&t(n,l,r,o)}return n})}function Ts(t,n){return function(e,r){if(e==null)return e;if(!It(e))return t(e,r);for(var u=e.length,o=n?u:-1,a=k(e);(n?o--:++o<u)&&r(a[o],o,a)!==!1;);return e}}function Rs(t){return function(n,e,r){for(var u=-1,o=k(n),a=r(n),l=a.length;l--;){var h=a[t?l:++u];if(e(o[h],h,o)===!1)break}return n}}function Xl(t,n,e){var r=n&j,u=Te(t);function o(){var a=this&&this!==wt&&this instanceof o?u:t;return a.apply(r?e:this,arguments)}return o}function Os(t){return function(n){n=J(n);var e=qn(n)?kt(n):i,r=e?e[0]:n.charAt(0),u=e?An(e,1).join(""):n.slice(1);return r[t]()+u}}function jn(t){return function(n){return Jr(Ro(To(n).replace(bf,"")),t,"")}}function Te(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=Qn(t.prototype),r=t.apply(e,n);return st(r)?r:e}}function Kl(t,n,e){var r=Te(t);function u(){for(var o=arguments.length,a=g(o),l=o,h=te(u);l--;)a[l]=arguments[l];var v=o<3&&a[0]!==h&&a[o-1]!==h?[]:yn(a,h);if(o-=v.length,o<e)return Cs(t,n,lr,u.placeholder,i,a,v,i,i,e-o);var w=this&&this!==wt&&this instanceof u?r:t;return bt(w,this,a)}return u}function As(t){return function(n,e,r){var u=k(n);if(!It(n)){var o=I(e,3);n=vt(n),e=function(l){return o(u[l],l,u)}}var a=t(n,e,r);return a>-1?u[o?n[a]:a]:i}}function Ls(t){return pn(function(n){var e=n.length,r=e,u=Kt.prototype.thru;for(t&&n.reverse();r--;){var o=n[r];if(typeof o!="function")throw new Xt(x);if(u&&!a&&pr(o)=="wrapper")var a=new Kt([],!0)}for(r=a?r:e;++r<e;){o=n[r];var l=pr(o),h=l=="wrapper"?Ai(o):i;h&&Ci(h[0])&&h[1]==(Ft|at|Ut|Mn)&&!h[4].length&&h[9]==1?a=a[pr(h[0])].apply(a,h[3]):a=o.length==1&&Ci(o)?a[l]():a.thru(o)}return function(){var v=arguments,w=v[0];if(a&&v.length==1&&P(w))return a.plant(w).value();for(var m=0,S=e?n[m].apply(this,v):w;++m<e;)S=n[m].call(this,S);return S}})}function lr(t,n,e,r,u,o,a,l,h,v){var w=n&Ft,m=n&j,S=n&W,O=n&(at|Zt),M=n&ue,U=S?i:Te(t);function C(){for(var z=arguments.length,G=g(z),Bt=z;Bt--;)G[Bt]=arguments[Bt];if(O)var Rt=te(C),Ht=na(G,Rt);if(r&&(G=ys(G,r,u,O)),o&&(G=Es(G,o,a,O)),z-=Ht,O&&z<v){var ct=yn(G,Rt);return Cs(t,n,lr,C.placeholder,e,G,ct,l,h,v-z)}var nn=m?e:this,wn=S?nn[t]:t;return z=G.length,l?G=ac(G,l):M&&z>1&&G.reverse(),w&&h<z&&(G.length=h),this&&this!==wt&&this instanceof C&&(wn=U||Te(wn)),wn.apply(nn,G)}return C}function Is(t,n){return function(e,r){return vl(e,t,n(r),{})}}function cr(t,n){return function(e,r){var u;if(e===i&&r===i)return n;if(e!==i&&(u=e),r!==i){if(u===i)return r;typeof e=="string"||typeof r=="string"?(e=Dt(e),r=Dt(r)):(e=ps(e),r=ps(r)),u=t(e,r)}return u}}function Ei(t){return pn(function(n){return n=ut(n,Nt(I())),F(function(e){var r=this;return t(n,function(u){return bt(u,r,e)})})})}function hr(t,n){n=n===i?" ":Dt(n);var e=n.length;if(e<2)return e?_i(n,t):n;var r=_i(n,ke(t/Yn(n)));return qn(n)?An(kt(r),0,t).join(""):r.slice(0,t)}function Gl(t,n,e,r){var u=n&j,o=Te(t);function a(){for(var l=-1,h=arguments.length,v=-1,w=r.length,m=g(w+h),S=this&&this!==wt&&this instanceof a?o:t;++v<w;)m[v]=r[v];for(;h--;)m[v++]=arguments[++l];return bt(S,u?e:this,m)}return a}function Ms(t){return function(n,e,r){return r&&typeof r!="number"&&Tt(n,e,r)&&(e=r=i),n=vn(n),e===i?(e=n,n=0):e=vn(e),r=r===i?n<e?1:-1:vn(r),Il(n,e,r,t)}}function gr(t){return function(n,e){return typeof n=="string"&&typeof e=="string"||(n=Jt(n),e=Jt(e)),t(n,e)}}function Cs(t,n,e,r,u,o,a,l,h,v){var w=n&at,m=w?a:i,S=w?i:a,O=w?o:i,M=w?i:o;n|=w?Ut:mn,n&=~(w?mn:Ut),n&it||(n&=~(j|W));var U=[t,n,u,O,m,M,S,l,h,v],C=e.apply(i,U);return Ci(t)&&Ks(C,U),C.placeholder=r,Gs(C,t,n)}function Ti(t){var n=gt[t];return function(e,r){if(e=Jt(e),r=r==null?0:xt(H(r),292),r&&Gu(e)){var u=(J(e)+"e").split("e"),o=n(u[0]+"e"+(+u[1]+r));return u=(J(o)+"e").split("e"),+(u[0]+"e"+(+u[1]-r))}return n(e)}}var ql=Zn&&1/Xe(new Zn([,-0]))[1]==At?function(t){return new Zn(t)}:Yi;function bs(t){return function(n){var e=St(n);return e==$t?ti(n):e==Qt?fa(n):ta(n,t(n))}}function gn(t,n,e,r,u,o,a,l){var h=n&W;if(!h&&typeof t!="function")throw new Xt(x);var v=r?r.length:0;if(v||(n&=~(Ut|mn),r=u=i),a=a===i?a:pt(H(a),0),l=l===i?l:H(l),v-=u?u.length:0,n&mn){var w=r,m=u;r=u=i}var S=h?i:Ai(t),O=[t,n,e,r,u,w,m,o,a,l];if(S&&sc(O,S),t=O[0],n=O[1],e=O[2],r=O[3],u=O[4],l=O[9]=O[9]===i?h?0:t.length:pt(O[9]-v,0),!l&&n&(at|Zt)&&(n&=~(at|Zt)),!n||n==j)var M=Xl(t,n,e);else n==at||n==Zt?M=Kl(t,n,l):(n==Ut||n==(j|Ut))&&!u.length?M=Gl(t,n,e,r):M=lr.apply(i,O);var U=S?hs:Ks;return Gs(U(M,O),t,n)}function Ns(t,n,e,r){return t===i||tn(t,Vn[e])&&!$.call(r,e)?n:t}function Ds(t,n,e,r,u,o){return st(t)&&st(n)&&(o.set(n,t),sr(t,n,i,Ds,o),o.delete(n)),t}function Yl(t){return Ae(t)?i:t}function Ps(t,n,e,r,u,o){var a=e&ht,l=t.length,h=n.length;if(l!=h&&!(a&&h>l))return!1;var v=o.get(t),w=o.get(n);if(v&&w)return v==n&&w==t;var m=-1,S=!0,O=e&V?new Dn:i;for(o.set(t,n),o.set(n,t);++m<l;){var M=t[m],U=n[m];if(r)var C=a?r(U,M,m,n,t,o):r(M,U,m,t,n,o);if(C!==i){if(C)continue;S=!1;break}if(O){if(!Vr(n,function(z,G){if(!ge(O,G)&&(M===z||u(M,z,e,r,o)))return O.push(G)})){S=!1;break}}else if(!(M===U||u(M,U,e,r,o))){S=!1;break}}return o.delete(t),o.delete(n),S}function Jl(t,n,e,r,u,o,a){switch(e){case Xn:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case he:return!(t.byteLength!=n.byteLength||!o(new Ve(t),new Ve(n)));case se:case oe:case fe:return tn(+t,+n);case De:return t.name==n.name&&t.message==n.message;case ae:case le:return t==n+"";case $t:var l=ti;case Qt:var h=r&ht;if(l||(l=Xe),t.size!=n.size&&!h)return!1;var v=a.get(t);if(v)return v==n;r|=V,a.set(t,n);var w=Ps(l(t),l(n),r,u,o,a);return a.delete(t),w;case Be:if(we)return we.call(t)==we.call(n)}return!1}function Vl(t,n,e,r,u,o){var a=e&ht,l=Ri(t),h=l.length,v=Ri(n),w=v.length;if(h!=w&&!a)return!1;for(var m=h;m--;){var S=l[m];if(!(a?S in n:$.call(n,S)))return!1}var O=o.get(t),M=o.get(n);if(O&&M)return O==n&&M==t;var U=!0;o.set(t,n),o.set(n,t);for(var C=a;++m<h;){S=l[m];var z=t[S],G=n[S];if(r)var Bt=a?r(G,z,S,n,t,o):r(z,G,S,t,n,o);if(!(Bt===i?z===G||u(z,G,e,r,o):Bt)){U=!1;break}C||(C=S=="constructor")}if(U&&!C){var Rt=t.constructor,Ht=n.constructor;Rt!=Ht&&"constructor"in t&&"constructor"in n&&!(typeof Rt=="function"&&Rt instanceof Rt&&typeof Ht=="function"&&Ht instanceof Ht)&&(U=!1)}return o.delete(t),o.delete(n),U}function pn(t){return Ni(zs(t,i,$s),t+"")}function Ri(t){return ns(t,vt,Ii)}function Oi(t){return ns(t,Mt,Bs)}var Ai=tr?function(t){return tr.get(t)}:Yi;function pr(t){for(var n=t.name+"",e=$n[n],r=$.call($n,n)?e.length:0;r--;){var u=e[r],o=u.func;if(o==null||o==t)return u.name}return n}function te(t){var n=$.call(s,"placeholder")?s:t;return n.placeholder}function I(){var t=s.iteratee||Gi;return t=t===Gi?is:t,arguments.length?t(arguments[0],arguments[1]):t}function dr(t,n){var e=t.__data__;return ec(n)?e[typeof n=="string"?"string":"hash"]:e.map}function Li(t){for(var n=vt(t),e=n.length;e--;){var r=n[e],u=t[r];n[e]=[r,u,Fs(u)]}return n}function Hn(t,n){var e=ua(t,n);return rs(e)?e:i}function Zl(t){var n=$.call(t,bn),e=t[bn];try{t[bn]=i;var r=!0}catch{}var u=Ye.call(t);return r&&(n?t[bn]=e:delete t[bn]),u}var Ii=ei?function(t){return t==null?[]:(t=k(t),xn(ei(t),function(n){return Xu.call(t,n)}))}:Ji,Bs=ei?function(t){for(var n=[];t;)Sn(n,Ii(t)),t=Ze(t);return n}:Ji,St=Et;(ri&&St(new ri(new ArrayBuffer(1)))!=Xn||de&&St(new de)!=$t||ii&&St(ii.resolve())!=ki||Zn&&St(new Zn)!=Qt||_e&&St(new _e)!=ce)&&(St=function(t){var n=Et(t),e=n==an?t.constructor:i,r=e?Un(e):"";if(r)switch(r){case Ca:return Xn;case ba:return $t;case Na:return ki;case Da:return Qt;case Pa:return ce}return n});function $l(t,n,e){for(var r=-1,u=e.length;++r<u;){var o=e[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":n-=a;break;case"take":n=xt(n,t+a);break;case"takeRight":t=pt(t,n-a);break}}return{start:t,end:n}}function Ql(t){var n=t.match(ef);return n?n[1].split(rf):[]}function Hs(t,n,e){n=On(n,t);for(var r=-1,u=n.length,o=!1;++r<u;){var a=sn(n[r]);if(!(o=t!=null&&e(t,a)))break;t=t[a]}return o||++r!=u?o:(u=t==null?0:t.length,!!u&&yr(u)&&dn(a,u)&&(P(t)||Fn(t)))}function kl(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&$.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function Us(t){return typeof t.constructor=="function"&&!Re(t)?Qn(Ze(t)):{}}function jl(t,n,e){var r=t.constructor;switch(n){case he:return yi(t);case se:case oe:return new r(+t);case Xn:return Bl(t,e);case Lr:case Ir:case Mr:case Cr:case br:case Nr:case Dr:case Pr:case Br:return xs(t,e);case $t:return new r;case fe:case le:return new r(t);case ae:return Hl(t);case Qt:return new r;case Be:return Ul(t)}}function tc(t,n){var e=n.length;if(!e)return t;var r=e-1;return n[r]=(e>1?"& ":"")+n[r],n=n.join(e>2?", ":" "),t.replace(nf,`{
/* [wrapped with `+n+`] */
`)}function nc(t){return P(t)||Fn(t)||!!(Ku&&t&&t[Ku])}function dn(t,n){var e=typeof t;return n=n??nt,!!n&&(e=="number"||e!="symbol"&&gf.test(t))&&t>-1&&t%1==0&&t<n}function Tt(t,n,e){if(!st(e))return!1;var r=typeof n;return(r=="number"?It(e)&&dn(n,e.length):r=="string"&&n in e)?tn(e[n],t):!1}function Mi(t,n){if(P(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||Pt(t)?!0:Qo.test(t)||!$o.test(t)||n!=null&&t in k(n)}function ec(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Ci(t){var n=pr(t),e=s[n];if(typeof e!="function"||!(n in X.prototype))return!1;if(t===e)return!0;var r=Ai(e);return!!r&&t===r[0]}function rc(t){return!!Fu&&Fu in t}var ic=Ge?_n:Vi;function Re(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||Vn;return t===e}function Fs(t){return t===t&&!st(t)}function Ws(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==i||t in k(e))}}function uc(t){var n=xr(t,function(r){return e.size===B&&e.clear(),r}),e=n.cache;return n}function sc(t,n){var e=t[1],r=n[1],u=e|r,o=u<(j|W|Ft),a=r==Ft&&e==at||r==Ft&&e==Mn&&t[7].length<=n[8]||r==(Ft|Mn)&&n[7].length<=n[8]&&e==at;if(!(o||a))return t;r&j&&(t[2]=n[2],u|=e&j?0:it);var l=n[3];if(l){var h=t[3];t[3]=h?ys(h,l,n[4]):l,t[4]=h?yn(t[3],L):n[4]}return l=n[5],l&&(h=t[5],t[5]=h?Es(h,l,n[6]):l,t[6]=h?yn(t[5],L):n[6]),l=n[7],l&&(t[7]=l),r&Ft&&(t[8]=t[8]==null?n[8]:xt(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=u,t}function oc(t){var n=[];if(t!=null)for(var e in k(t))n.push(e);return n}function fc(t){return Ye.call(t)}function zs(t,n,e){return n=pt(n===i?t.length-1:n,0),function(){for(var r=arguments,u=-1,o=pt(r.length-n,0),a=g(o);++u<o;)a[u]=r[n+u];u=-1;for(var l=g(n+1);++u<n;)l[u]=r[u];return l[n]=e(a),bt(t,this,l)}}function Xs(t,n){return n.length<2?t:Bn(t,qt(n,0,-1))}function ac(t,n){for(var e=t.length,r=xt(n.length,e),u=Lt(t);r--;){var o=n[r];t[r]=dn(o,e)?u[o]:i}return t}function bi(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var Ks=qs(hs),Oe=Ta||function(t,n){return wt.setTimeout(t,n)},Ni=qs(bl);function Gs(t,n,e){var r=n+"";return Ni(t,tc(r,lc(Ql(r),e)))}function qs(t){var n=0,e=0;return function(){var r=La(),u=q-(r-e);if(e=r,u>0){if(++n>=Z)return arguments[0]}else n=0;return t.apply(i,arguments)}}function _r(t,n){var e=-1,r=t.length,u=r-1;for(n=n===i?r:n;++e<n;){var o=di(e,u),a=t[o];t[o]=t[e],t[e]=a}return t.length=n,t}var Ys=uc(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(ko,function(e,r,u,o){n.push(u?o.replace(of,"$1"):r||e)}),n});function sn(t){if(typeof t=="string"||Pt(t))return t;var n=t+"";return n=="0"&&1/t==-At?"-0":n}function Un(t){if(t!=null){try{return qe.call(t)}catch{}try{return t+""}catch{}}return""}function lc(t,n){return zt(Bo,function(e){var r="_."+e[0];n&e[1]&&!We(t,r)&&t.push(r)}),t.sort()}function Js(t){if(t instanceof X)return t.clone();var n=new Kt(t.__wrapped__,t.__chain__);return n.__actions__=Lt(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function cc(t,n,e){(e?Tt(t,n,e):n===i)?n=1:n=pt(H(n),0);var r=t==null?0:t.length;if(!r||n<1)return[];for(var u=0,o=0,a=g(ke(r/n));u<r;)a[o++]=qt(t,u,u+=n);return a}function hc(t){for(var n=-1,e=t==null?0:t.length,r=0,u=[];++n<e;){var o=t[n];o&&(u[r++]=o)}return u}function gc(){var t=arguments.length;if(!t)return[];for(var n=g(t-1),e=arguments[0],r=t;r--;)n[r-1]=arguments[r];return Sn(P(e)?Lt(e):[e],mt(n,1))}var pc=F(function(t,n){return lt(t)?xe(t,mt(n,1,lt,!0)):[]}),dc=F(function(t,n){var e=Yt(n);return lt(e)&&(e=i),lt(t)?xe(t,mt(n,1,lt,!0),I(e,2)):[]}),_c=F(function(t,n){var e=Yt(n);return lt(e)&&(e=i),lt(t)?xe(t,mt(n,1,lt,!0),i,e):[]});function vc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===i?1:H(n),qt(t,n<0?0:n,r)):[]}function wc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===i?1:H(n),n=r-n,qt(t,0,n<0?0:n)):[]}function mc(t,n){return t&&t.length?fr(t,I(n,3),!0,!0):[]}function xc(t,n){return t&&t.length?fr(t,I(n,3),!0):[]}function Sc(t,n,e,r){var u=t==null?0:t.length;return u?(e&&typeof e!="number"&&Tt(t,n,e)&&(e=0,r=u),gl(t,n,e,r)):[]}function Vs(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var u=e==null?0:H(e);return u<0&&(u=pt(r+u,0)),ze(t,I(n,3),u)}function Zs(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var u=r-1;return e!==i&&(u=H(e),u=e<0?pt(r+u,0):xt(u,r-1)),ze(t,I(n,3),u,!0)}function $s(t){var n=t==null?0:t.length;return n?mt(t,1):[]}function yc(t){var n=t==null?0:t.length;return n?mt(t,At):[]}function Ec(t,n){var e=t==null?0:t.length;return e?(n=n===i?1:H(n),mt(t,n)):[]}function Tc(t){for(var n=-1,e=t==null?0:t.length,r={};++n<e;){var u=t[n];r[u[0]]=u[1]}return r}function Qs(t){return t&&t.length?t[0]:i}function Rc(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var u=e==null?0:H(e);return u<0&&(u=pt(r+u,0)),Gn(t,n,u)}function Oc(t){var n=t==null?0:t.length;return n?qt(t,0,-1):[]}var Ac=F(function(t){var n=ut(t,xi);return n.length&&n[0]===t[0]?li(n):[]}),Lc=F(function(t){var n=Yt(t),e=ut(t,xi);return n===Yt(e)?n=i:e.pop(),e.length&&e[0]===t[0]?li(e,I(n,2)):[]}),Ic=F(function(t){var n=Yt(t),e=ut(t,xi);return n=typeof n=="function"?n:i,n&&e.pop(),e.length&&e[0]===t[0]?li(e,i,n):[]});function Mc(t,n){return t==null?"":Oa.call(t,n)}function Yt(t){var n=t==null?0:t.length;return n?t[n-1]:i}function Cc(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var u=r;return e!==i&&(u=H(e),u=u<0?pt(r+u,0):xt(u,r-1)),n===n?la(t,n,u):ze(t,Cu,u,!0)}function bc(t,n){return t&&t.length?fs(t,H(n)):i}var Nc=F(ks);function ks(t,n){return t&&t.length&&n&&n.length?pi(t,n):t}function Dc(t,n,e){return t&&t.length&&n&&n.length?pi(t,n,I(e,2)):t}function Pc(t,n,e){return t&&t.length&&n&&n.length?pi(t,n,i,e):t}var Bc=pn(function(t,n){var e=t==null?0:t.length,r=si(t,n);return cs(t,ut(n,function(u){return dn(u,e)?+u:u}).sort(Ss)),r});function Hc(t,n){var e=[];if(!(t&&t.length))return e;var r=-1,u=[],o=t.length;for(n=I(n,3);++r<o;){var a=t[r];n(a,r,t)&&(e.push(a),u.push(r))}return cs(t,u),e}function Di(t){return t==null?t:Ma.call(t)}function Uc(t,n,e){var r=t==null?0:t.length;return r?(e&&typeof e!="number"&&Tt(t,n,e)?(n=0,e=r):(n=n==null?0:H(n),e=e===i?r:H(e)),qt(t,n,e)):[]}function Fc(t,n){return or(t,n)}function Wc(t,n,e){return vi(t,n,I(e,2))}function zc(t,n){var e=t==null?0:t.length;if(e){var r=or(t,n);if(r<e&&tn(t[r],n))return r}return-1}function Xc(t,n){return or(t,n,!0)}function Kc(t,n,e){return vi(t,n,I(e,2),!0)}function Gc(t,n){var e=t==null?0:t.length;if(e){var r=or(t,n,!0)-1;if(tn(t[r],n))return r}return-1}function qc(t){return t&&t.length?gs(t):[]}function Yc(t,n){return t&&t.length?gs(t,I(n,2)):[]}function Jc(t){var n=t==null?0:t.length;return n?qt(t,1,n):[]}function Vc(t,n,e){return t&&t.length?(n=e||n===i?1:H(n),qt(t,0,n<0?0:n)):[]}function Zc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===i?1:H(n),n=r-n,qt(t,n<0?0:n,r)):[]}function $c(t,n){return t&&t.length?fr(t,I(n,3),!1,!0):[]}function Qc(t,n){return t&&t.length?fr(t,I(n,3)):[]}var kc=F(function(t){return Rn(mt(t,1,lt,!0))}),jc=F(function(t){var n=Yt(t);return lt(n)&&(n=i),Rn(mt(t,1,lt,!0),I(n,2))}),th=F(function(t){var n=Yt(t);return n=typeof n=="function"?n:i,Rn(mt(t,1,lt,!0),i,n)});function nh(t){return t&&t.length?Rn(t):[]}function eh(t,n){return t&&t.length?Rn(t,I(n,2)):[]}function rh(t,n){return n=typeof n=="function"?n:i,t&&t.length?Rn(t,i,n):[]}function Pi(t){if(!(t&&t.length))return[];var n=0;return t=xn(t,function(e){if(lt(e))return n=pt(e.length,n),!0}),kr(n,function(e){return ut(t,Zr(e))})}function js(t,n){if(!(t&&t.length))return[];var e=Pi(t);return n==null?e:ut(e,function(r){return bt(n,i,r)})}var ih=F(function(t,n){return lt(t)?xe(t,n):[]}),uh=F(function(t){return mi(xn(t,lt))}),sh=F(function(t){var n=Yt(t);return lt(n)&&(n=i),mi(xn(t,lt),I(n,2))}),oh=F(function(t){var n=Yt(t);return n=typeof n=="function"?n:i,mi(xn(t,lt),i,n)}),fh=F(Pi);function ah(t,n){return vs(t||[],n||[],me)}function lh(t,n){return vs(t||[],n||[],Ee)}var ch=F(function(t){var n=t.length,e=n>1?t[n-1]:i;return e=typeof e=="function"?(t.pop(),e):i,js(t,e)});function to(t){var n=s(t);return n.__chain__=!0,n}function hh(t,n){return n(t),t}function vr(t,n){return n(t)}var gh=pn(function(t){var n=t.length,e=n?t[0]:0,r=this.__wrapped__,u=function(o){return si(o,t)};return n>1||this.__actions__.length||!(r instanceof X)||!dn(e)?this.thru(u):(r=r.slice(e,+e+(n?1:0)),r.__actions__.push({func:vr,args:[u],thisArg:i}),new Kt(r,this.__chain__).thru(function(o){return n&&!o.length&&o.push(i),o}))});function ph(){return to(this)}function dh(){return new Kt(this.value(),this.__chain__)}function _h(){this.__values__===i&&(this.__values__=po(this.value()));var t=this.__index__>=this.__values__.length,n=t?i:this.__values__[this.__index__++];return{done:t,value:n}}function vh(){return this}function wh(t){for(var n,e=this;e instanceof er;){var r=Js(e);r.__index__=0,r.__values__=i,n?u.__wrapped__=r:n=r;var u=r;e=e.__wrapped__}return u.__wrapped__=t,n}function mh(){var t=this.__wrapped__;if(t instanceof X){var n=t;return this.__actions__.length&&(n=new X(this)),n=n.reverse(),n.__actions__.push({func:vr,args:[Di],thisArg:i}),new Kt(n,this.__chain__)}return this.thru(Di)}function xh(){return _s(this.__wrapped__,this.__actions__)}var Sh=ar(function(t,n,e){$.call(t,e)?++t[e]:hn(t,e,1)});function yh(t,n,e){var r=P(t)?Iu:hl;return e&&Tt(t,n,e)&&(n=i),r(t,I(n,3))}function Eh(t,n){var e=P(t)?xn:ju;return e(t,I(n,3))}var Th=As(Vs),Rh=As(Zs);function Oh(t,n){return mt(wr(t,n),1)}function Ah(t,n){return mt(wr(t,n),At)}function Lh(t,n,e){return e=e===i?1:H(e),mt(wr(t,n),e)}function no(t,n){var e=P(t)?zt:Tn;return e(t,I(n,3))}function eo(t,n){var e=P(t)?Jf:ku;return e(t,I(n,3))}var Ih=ar(function(t,n,e){$.call(t,e)?t[e].push(n):hn(t,e,[n])});function Mh(t,n,e,r){t=It(t)?t:ee(t),e=e&&!r?H(e):0;var u=t.length;return e<0&&(e=pt(u+e,0)),Er(t)?e<=u&&t.indexOf(n,e)>-1:!!u&&Gn(t,n,e)>-1}var Ch=F(function(t,n,e){var r=-1,u=typeof n=="function",o=It(t)?g(t.length):[];return Tn(t,function(a){o[++r]=u?bt(n,a,e):Se(a,n,e)}),o}),bh=ar(function(t,n,e){hn(t,e,n)});function wr(t,n){var e=P(t)?ut:us;return e(t,I(n,3))}function Nh(t,n,e,r){return t==null?[]:(P(n)||(n=n==null?[]:[n]),e=r?i:e,P(e)||(e=e==null?[]:[e]),as(t,n,e))}var Dh=ar(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]});function Ph(t,n,e){var r=P(t)?Jr:Nu,u=arguments.length<3;return r(t,I(n,4),e,u,Tn)}function Bh(t,n,e){var r=P(t)?Vf:Nu,u=arguments.length<3;return r(t,I(n,4),e,u,ku)}function Hh(t,n){var e=P(t)?xn:ju;return e(t,Sr(I(n,3)))}function Uh(t){var n=P(t)?Vu:Ml;return n(t)}function Fh(t,n,e){(e?Tt(t,n,e):n===i)?n=1:n=H(n);var r=P(t)?ol:Cl;return r(t,n)}function Wh(t){var n=P(t)?fl:Nl;return n(t)}function zh(t){if(t==null)return 0;if(It(t))return Er(t)?Yn(t):t.length;var n=St(t);return n==$t||n==Qt?t.size:hi(t).length}function Xh(t,n,e){var r=P(t)?Vr:Dl;return e&&Tt(t,n,e)&&(n=i),r(t,I(n,3))}var Kh=F(function(t,n){if(t==null)return[];var e=n.length;return e>1&&Tt(t,n[0],n[1])?n=[]:e>2&&Tt(n[0],n[1],n[2])&&(n=[n[0]]),as(t,mt(n,1),[])}),mr=Ea||function(){return wt.Date.now()};function Gh(t,n){if(typeof n!="function")throw new Xt(x);return t=H(t),function(){if(--t<1)return n.apply(this,arguments)}}function ro(t,n,e){return n=e?i:n,n=t&&n==null?t.length:n,gn(t,Ft,i,i,i,i,n)}function io(t,n){var e;if(typeof n!="function")throw new Xt(x);return t=H(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=i),e}}var Bi=F(function(t,n,e){var r=j;if(e.length){var u=yn(e,te(Bi));r|=Ut}return gn(t,r,n,e,u)}),uo=F(function(t,n,e){var r=j|W;if(e.length){var u=yn(e,te(uo));r|=Ut}return gn(n,r,t,e,u)});function so(t,n,e){n=e?i:n;var r=gn(t,at,i,i,i,i,i,n);return r.placeholder=so.placeholder,r}function oo(t,n,e){n=e?i:n;var r=gn(t,Zt,i,i,i,i,i,n);return r.placeholder=oo.placeholder,r}function fo(t,n,e){var r,u,o,a,l,h,v=0,w=!1,m=!1,S=!0;if(typeof t!="function")throw new Xt(x);n=Jt(n)||0,st(e)&&(w=!!e.leading,m="maxWait"in e,o=m?pt(Jt(e.maxWait)||0,n):o,S="trailing"in e?!!e.trailing:S);function O(ct){var nn=r,wn=u;return r=u=i,v=ct,a=t.apply(wn,nn),a}function M(ct){return v=ct,l=Oe(z,n),w?O(ct):a}function U(ct){var nn=ct-h,wn=ct-v,Lo=n-nn;return m?xt(Lo,o-wn):Lo}function C(ct){var nn=ct-h,wn=ct-v;return h===i||nn>=n||nn<0||m&&wn>=o}function z(){var ct=mr();if(C(ct))return G(ct);l=Oe(z,U(ct))}function G(ct){return l=i,S&&r?O(ct):(r=u=i,a)}function Bt(){l!==i&&ws(l),v=0,r=h=u=l=i}function Rt(){return l===i?a:G(mr())}function Ht(){var ct=mr(),nn=C(ct);if(r=arguments,u=this,h=ct,nn){if(l===i)return M(h);if(m)return ws(l),l=Oe(z,n),O(h)}return l===i&&(l=Oe(z,n)),a}return Ht.cancel=Bt,Ht.flush=Rt,Ht}var qh=F(function(t,n){return Qu(t,1,n)}),Yh=F(function(t,n,e){return Qu(t,Jt(n)||0,e)});function Jh(t){return gn(t,ue)}function xr(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new Xt(x);var e=function(){var r=arguments,u=n?n.apply(this,r):r[0],o=e.cache;if(o.has(u))return o.get(u);var a=t.apply(this,r);return e.cache=o.set(u,a)||o,a};return e.cache=new(xr.Cache||cn),e}xr.Cache=cn;function Sr(t){if(typeof t!="function")throw new Xt(x);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Vh(t){return io(2,t)}var Zh=Pl(function(t,n){n=n.length==1&&P(n[0])?ut(n[0],Nt(I())):ut(mt(n,1),Nt(I()));var e=n.length;return F(function(r){for(var u=-1,o=xt(r.length,e);++u<o;)r[u]=n[u].call(this,r[u]);return bt(t,this,r)})}),Hi=F(function(t,n){var e=yn(n,te(Hi));return gn(t,Ut,i,n,e)}),ao=F(function(t,n){var e=yn(n,te(ao));return gn(t,mn,i,n,e)}),$h=pn(function(t,n){return gn(t,Mn,i,i,i,n)});function Qh(t,n){if(typeof t!="function")throw new Xt(x);return n=n===i?n:H(n),F(t,n)}function kh(t,n){if(typeof t!="function")throw new Xt(x);return n=n==null?0:pt(H(n),0),F(function(e){var r=e[n],u=An(e,0,n);return r&&Sn(u,r),bt(t,this,u)})}function jh(t,n,e){var r=!0,u=!0;if(typeof t!="function")throw new Xt(x);return st(e)&&(r="leading"in e?!!e.leading:r,u="trailing"in e?!!e.trailing:u),fo(t,n,{leading:r,maxWait:n,trailing:u})}function tg(t){return ro(t,1)}function ng(t,n){return Hi(Si(n),t)}function eg(){if(!arguments.length)return[];var t=arguments[0];return P(t)?t:[t]}function rg(t){return Gt(t,rt)}function ig(t,n){return n=typeof n=="function"?n:i,Gt(t,rt,n)}function ug(t){return Gt(t,R|rt)}function sg(t,n){return n=typeof n=="function"?n:i,Gt(t,R|rt,n)}function og(t,n){return n==null||$u(t,n,vt(n))}function tn(t,n){return t===n||t!==t&&n!==n}var fg=gr(ai),ag=gr(function(t,n){return t>=n}),Fn=es(function(){return arguments}())?es:function(t){return ot(t)&&$.call(t,"callee")&&!Xu.call(t,"callee")},P=g.isArray,lg=Eu?Nt(Eu):wl;function It(t){return t!=null&&yr(t.length)&&!_n(t)}function lt(t){return ot(t)&&It(t)}function cg(t){return t===!0||t===!1||ot(t)&&Et(t)==se}var Ln=Ra||Vi,hg=Tu?Nt(Tu):ml;function gg(t){return ot(t)&&t.nodeType===1&&!Ae(t)}function pg(t){if(t==null)return!0;if(It(t)&&(P(t)||typeof t=="string"||typeof t.splice=="function"||Ln(t)||ne(t)||Fn(t)))return!t.length;var n=St(t);if(n==$t||n==Qt)return!t.size;if(Re(t))return!hi(t).length;for(var e in t)if($.call(t,e))return!1;return!0}function dg(t,n){return ye(t,n)}function _g(t,n,e){e=typeof e=="function"?e:i;var r=e?e(t,n):i;return r===i?ye(t,n,i,e):!!r}function Ui(t){if(!ot(t))return!1;var n=Et(t);return n==De||n==Uo||typeof t.message=="string"&&typeof t.name=="string"&&!Ae(t)}function vg(t){return typeof t=="number"&&Gu(t)}function _n(t){if(!st(t))return!1;var n=Et(t);return n==Pe||n==Qi||n==Ho||n==Wo}function lo(t){return typeof t=="number"&&t==H(t)}function yr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=nt}function st(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function ot(t){return t!=null&&typeof t=="object"}var co=Ru?Nt(Ru):Sl;function wg(t,n){return t===n||ci(t,n,Li(n))}function mg(t,n,e){return e=typeof e=="function"?e:i,ci(t,n,Li(n),e)}function xg(t){return ho(t)&&t!=+t}function Sg(t){if(ic(t))throw new D(E);return rs(t)}function yg(t){return t===null}function Eg(t){return t==null}function ho(t){return typeof t=="number"||ot(t)&&Et(t)==fe}function Ae(t){if(!ot(t)||Et(t)!=an)return!1;var n=Ze(t);if(n===null)return!0;var e=$.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&qe.call(e)==ma}var Fi=Ou?Nt(Ou):yl;function Tg(t){return lo(t)&&t>=-nt&&t<=nt}var go=Au?Nt(Au):El;function Er(t){return typeof t=="string"||!P(t)&&ot(t)&&Et(t)==le}function Pt(t){return typeof t=="symbol"||ot(t)&&Et(t)==Be}var ne=Lu?Nt(Lu):Tl;function Rg(t){return t===i}function Og(t){return ot(t)&&St(t)==ce}function Ag(t){return ot(t)&&Et(t)==Xo}var Lg=gr(gi),Ig=gr(function(t,n){return t<=n});function po(t){if(!t)return[];if(It(t))return Er(t)?kt(t):Lt(t);if(pe&&t[pe])return oa(t[pe]());var n=St(t),e=n==$t?ti:n==Qt?Xe:ee;return e(t)}function vn(t){if(!t)return t===0?t:0;if(t=Jt(t),t===At||t===-At){var n=t<0?-1:1;return n*No}return t===t?t:0}function H(t){var n=vn(t),e=n%1;return n===n?e?n-e:n:0}function _o(t){return t?Pn(H(t),0,en):0}function Jt(t){if(typeof t=="number")return t;if(Pt(t))return be;if(st(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=st(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=Du(t);var e=lf.test(t);return e||hf.test(t)?Gf(t.slice(2),e?2:8):af.test(t)?be:+t}function vo(t){return un(t,Mt(t))}function Mg(t){return t?Pn(H(t),-nt,nt):t===0?t:0}function J(t){return t==null?"":Dt(t)}var Cg=kn(function(t,n){if(Re(n)||It(n)){un(n,vt(n),t);return}for(var e in n)$.call(n,e)&&me(t,e,n[e])}),wo=kn(function(t,n){un(n,Mt(n),t)}),Tr=kn(function(t,n,e,r){un(n,Mt(n),t,r)}),bg=kn(function(t,n,e,r){un(n,vt(n),t,r)}),Ng=pn(si);function Dg(t,n){var e=Qn(t);return n==null?e:Zu(e,n)}var Pg=F(function(t,n){t=k(t);var e=-1,r=n.length,u=r>2?n[2]:i;for(u&&Tt(n[0],n[1],u)&&(r=1);++e<r;)for(var o=n[e],a=Mt(o),l=-1,h=a.length;++l<h;){var v=a[l],w=t[v];(w===i||tn(w,Vn[v])&&!$.call(t,v))&&(t[v]=o[v])}return t}),Bg=F(function(t){return t.push(i,Ds),bt(mo,i,t)});function Hg(t,n){return Mu(t,I(n,3),rn)}function Ug(t,n){return Mu(t,I(n,3),fi)}function Fg(t,n){return t==null?t:oi(t,I(n,3),Mt)}function Wg(t,n){return t==null?t:ts(t,I(n,3),Mt)}function zg(t,n){return t&&rn(t,I(n,3))}function Xg(t,n){return t&&fi(t,I(n,3))}function Kg(t){return t==null?[]:ur(t,vt(t))}function Gg(t){return t==null?[]:ur(t,Mt(t))}function Wi(t,n,e){var r=t==null?i:Bn(t,n);return r===i?e:r}function qg(t,n){return t!=null&&Hs(t,n,pl)}function zi(t,n){return t!=null&&Hs(t,n,dl)}var Yg=Is(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=Ye.call(n)),t[n]=e},Ki(Ct)),Jg=Is(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=Ye.call(n)),$.call(t,n)?t[n].push(e):t[n]=[e]},I),Vg=F(Se);function vt(t){return It(t)?Ju(t):hi(t)}function Mt(t){return It(t)?Ju(t,!0):Rl(t)}function Zg(t,n){var e={};return n=I(n,3),rn(t,function(r,u,o){hn(e,n(r,u,o),r)}),e}function $g(t,n){var e={};return n=I(n,3),rn(t,function(r,u,o){hn(e,u,n(r,u,o))}),e}var Qg=kn(function(t,n,e){sr(t,n,e)}),mo=kn(function(t,n,e,r){sr(t,n,e,r)}),kg=pn(function(t,n){var e={};if(t==null)return e;var r=!1;n=ut(n,function(o){return o=On(o,t),r||(r=o.length>1),o}),un(t,Oi(t),e),r&&(e=Gt(e,R|K|rt,Yl));for(var u=n.length;u--;)wi(e,n[u]);return e});function jg(t,n){return xo(t,Sr(I(n)))}var tp=pn(function(t,n){return t==null?{}:Al(t,n)});function xo(t,n){if(t==null)return{};var e=ut(Oi(t),function(r){return[r]});return n=I(n),ls(t,e,function(r,u){return n(r,u[0])})}function np(t,n,e){n=On(n,t);var r=-1,u=n.length;for(u||(u=1,t=i);++r<u;){var o=t==null?i:t[sn(n[r])];o===i&&(r=u,o=e),t=_n(o)?o.call(t):o}return t}function ep(t,n,e){return t==null?t:Ee(t,n,e)}function rp(t,n,e,r){return r=typeof r=="function"?r:i,t==null?t:Ee(t,n,e,r)}var So=bs(vt),yo=bs(Mt);function ip(t,n,e){var r=P(t),u=r||Ln(t)||ne(t);if(n=I(n,4),e==null){var o=t&&t.constructor;u?e=r?new o:[]:st(t)?e=_n(o)?Qn(Ze(t)):{}:e={}}return(u?zt:rn)(t,function(a,l,h){return n(e,a,l,h)}),e}function up(t,n){return t==null?!0:wi(t,n)}function sp(t,n,e){return t==null?t:ds(t,n,Si(e))}function op(t,n,e,r){return r=typeof r=="function"?r:i,t==null?t:ds(t,n,Si(e),r)}function ee(t){return t==null?[]:jr(t,vt(t))}function fp(t){return t==null?[]:jr(t,Mt(t))}function ap(t,n,e){return e===i&&(e=n,n=i),e!==i&&(e=Jt(e),e=e===e?e:0),n!==i&&(n=Jt(n),n=n===n?n:0),Pn(Jt(t),n,e)}function lp(t,n,e){return n=vn(n),e===i?(e=n,n=0):e=vn(e),t=Jt(t),_l(t,n,e)}function cp(t,n,e){if(e&&typeof e!="boolean"&&Tt(t,n,e)&&(n=e=i),e===i&&(typeof n=="boolean"?(e=n,n=i):typeof t=="boolean"&&(e=t,t=i)),t===i&&n===i?(t=0,n=1):(t=vn(t),n===i?(n=t,t=0):n=vn(n)),t>n){var r=t;t=n,n=r}if(e||t%1||n%1){var u=qu();return xt(t+u*(n-t+Kf("1e-"+((u+"").length-1))),n)}return di(t,n)}var hp=jn(function(t,n,e){return n=n.toLowerCase(),t+(e?Eo(n):n)});function Eo(t){return Xi(J(t).toLowerCase())}function To(t){return t=J(t),t&&t.replace(pf,ea).replace(Nf,"")}function gp(t,n,e){t=J(t),n=Dt(n);var r=t.length;e=e===i?r:Pn(H(e),0,r);var u=e;return e-=n.length,e>=0&&t.slice(e,u)==n}function pp(t){return t=J(t),t&&Jo.test(t)?t.replace(tu,ra):t}function dp(t){return t=J(t),t&&jo.test(t)?t.replace(Hr,"\\$&"):t}var _p=jn(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),vp=jn(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),wp=Os("toLowerCase");function mp(t,n,e){t=J(t),n=H(n);var r=n?Yn(t):0;if(!n||r>=n)return t;var u=(n-r)/2;return hr(je(u),e)+t+hr(ke(u),e)}function xp(t,n,e){t=J(t),n=H(n);var r=n?Yn(t):0;return n&&r<n?t+hr(n-r,e):t}function Sp(t,n,e){t=J(t),n=H(n);var r=n?Yn(t):0;return n&&r<n?hr(n-r,e)+t:t}function yp(t,n,e){return e||n==null?n=0:n&&(n=+n),Ia(J(t).replace(Ur,""),n||0)}function Ep(t,n,e){return(e?Tt(t,n,e):n===i)?n=1:n=H(n),_i(J(t),n)}function Tp(){var t=arguments,n=J(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var Rp=jn(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()});function Op(t,n,e){return e&&typeof e!="number"&&Tt(t,n,e)&&(n=e=i),e=e===i?en:e>>>0,e?(t=J(t),t&&(typeof n=="string"||n!=null&&!Fi(n))&&(n=Dt(n),!n&&qn(t))?An(kt(t),0,e):t.split(n,e)):[]}var Ap=jn(function(t,n,e){return t+(e?" ":"")+Xi(n)});function Lp(t,n,e){return t=J(t),e=e==null?0:Pn(H(e),0,t.length),n=Dt(n),t.slice(e,e+n.length)==n}function Ip(t,n,e){var r=s.templateSettings;e&&Tt(t,n,e)&&(n=i),t=J(t),n=Tr({},n,r,Ns);var u=Tr({},n.imports,r.imports,Ns),o=vt(u),a=jr(u,o),l,h,v=0,w=n.interpolate||He,m="__p += '",S=ni((n.escape||He).source+"|"+w.source+"|"+(w===nu?ff:He).source+"|"+(n.evaluate||He).source+"|$","g"),O="//# sourceURL="+($.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Uf+"]")+`
`;t.replace(S,function(C,z,G,Bt,Rt,Ht){return G||(G=Bt),m+=t.slice(v,Ht).replace(df,ia),z&&(l=!0,m+=`' +
__e(`+z+`) +
'`),Rt&&(h=!0,m+=`';
`+Rt+`;
__p += '`),G&&(m+=`' +
((__t = (`+G+`)) == null ? '' : __t) +
'`),v=Ht+C.length,C}),m+=`';
`;var M=$.call(n,"variable")&&n.variable;if(!M)m=`with (obj) {
`+m+`
}
`;else if(sf.test(M))throw new D(b);m=(h?m.replace(Ko,""):m).replace(Go,"$1").replace(qo,"$1;"),m="function("+(M||"obj")+`) {
`+(M?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(l?", __e = _.escape":"")+(h?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+m+`return __p
}`;var U=Oo(function(){return Y(o,O+"return "+m).apply(i,a)});if(U.source=m,Ui(U))throw U;return U}function Mp(t){return J(t).toLowerCase()}function Cp(t){return J(t).toUpperCase()}function bp(t,n,e){if(t=J(t),t&&(e||n===i))return Du(t);if(!t||!(n=Dt(n)))return t;var r=kt(t),u=kt(n),o=Pu(r,u),a=Bu(r,u)+1;return An(r,o,a).join("")}function Np(t,n,e){if(t=J(t),t&&(e||n===i))return t.slice(0,Uu(t)+1);if(!t||!(n=Dt(n)))return t;var r=kt(t),u=Bu(r,kt(n))+1;return An(r,0,u).join("")}function Dp(t,n,e){if(t=J(t),t&&(e||n===i))return t.replace(Ur,"");if(!t||!(n=Dt(n)))return t;var r=kt(t),u=Pu(r,kt(n));return An(r,u).join("")}function Pp(t,n){var e=Ce,r=y;if(st(n)){var u="separator"in n?n.separator:u;e="length"in n?H(n.length):e,r="omission"in n?Dt(n.omission):r}t=J(t);var o=t.length;if(qn(t)){var a=kt(t);o=a.length}if(e>=o)return t;var l=e-Yn(r);if(l<1)return r;var h=a?An(a,0,l).join(""):t.slice(0,l);if(u===i)return h+r;if(a&&(l+=h.length-l),Fi(u)){if(t.slice(l).search(u)){var v,w=h;for(u.global||(u=ni(u.source,J(eu.exec(u))+"g")),u.lastIndex=0;v=u.exec(w);)var m=v.index;h=h.slice(0,m===i?l:m)}}else if(t.indexOf(Dt(u),l)!=l){var S=h.lastIndexOf(u);S>-1&&(h=h.slice(0,S))}return h+r}function Bp(t){return t=J(t),t&&Yo.test(t)?t.replace(ji,ca):t}var Hp=jn(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),Xi=Os("toUpperCase");function Ro(t,n,e){return t=J(t),n=e?i:n,n===i?sa(t)?pa(t):Qf(t):t.match(n)||[]}var Oo=F(function(t,n){try{return bt(t,i,n)}catch(e){return Ui(e)?e:new D(e)}}),Up=pn(function(t,n){return zt(n,function(e){e=sn(e),hn(t,e,Bi(t[e],t))}),t});function Fp(t){var n=t==null?0:t.length,e=I();return t=n?ut(t,function(r){if(typeof r[1]!="function")throw new Xt(x);return[e(r[0]),r[1]]}):[],F(function(r){for(var u=-1;++u<n;){var o=t[u];if(bt(o[0],this,r))return bt(o[1],this,r)}})}function Wp(t){return cl(Gt(t,R))}function Ki(t){return function(){return t}}function zp(t,n){return t==null||t!==t?n:t}var Xp=Ls(),Kp=Ls(!0);function Ct(t){return t}function Gi(t){return is(typeof t=="function"?t:Gt(t,R))}function Gp(t){return ss(Gt(t,R))}function qp(t,n){return os(t,Gt(n,R))}var Yp=F(function(t,n){return function(e){return Se(e,t,n)}}),Jp=F(function(t,n){return function(e){return Se(t,e,n)}});function qi(t,n,e){var r=vt(n),u=ur(n,r);e==null&&!(st(n)&&(u.length||!r.length))&&(e=n,n=t,t=this,u=ur(n,vt(n)));var o=!(st(e)&&"chain"in e)||!!e.chain,a=_n(t);return zt(u,function(l){var h=n[l];t[l]=h,a&&(t.prototype[l]=function(){var v=this.__chain__;if(o||v){var w=t(this.__wrapped__),m=w.__actions__=Lt(this.__actions__);return m.push({func:h,args:arguments,thisArg:t}),w.__chain__=v,w}return h.apply(t,Sn([this.value()],arguments))})}),t}function Vp(){return wt._===this&&(wt._=xa),this}function Yi(){}function Zp(t){return t=H(t),F(function(n){return fs(n,t)})}var $p=Ei(ut),Qp=Ei(Iu),kp=Ei(Vr);function Ao(t){return Mi(t)?Zr(sn(t)):Ll(t)}function jp(t){return function(n){return t==null?i:Bn(t,n)}}var td=Ms(),nd=Ms(!0);function Ji(){return[]}function Vi(){return!1}function ed(){return{}}function rd(){return""}function id(){return!0}function ud(t,n){if(t=H(t),t<1||t>nt)return[];var e=en,r=xt(t,en);n=I(n),t-=en;for(var u=kr(r,n);++e<t;)n(e);return u}function sd(t){return P(t)?ut(t,sn):Pt(t)?[t]:Lt(Ys(J(t)))}function od(t){var n=++wa;return J(t)+n}var fd=cr(function(t,n){return t+n},0),ad=Ti("ceil"),ld=cr(function(t,n){return t/n},1),cd=Ti("floor");function hd(t){return t&&t.length?ir(t,Ct,ai):i}function gd(t,n){return t&&t.length?ir(t,I(n,2),ai):i}function pd(t){return bu(t,Ct)}function dd(t,n){return bu(t,I(n,2))}function _d(t){return t&&t.length?ir(t,Ct,gi):i}function vd(t,n){return t&&t.length?ir(t,I(n,2),gi):i}var wd=cr(function(t,n){return t*n},1),md=Ti("round"),xd=cr(function(t,n){return t-n},0);function Sd(t){return t&&t.length?Qr(t,Ct):0}function yd(t,n){return t&&t.length?Qr(t,I(n,2)):0}return s.after=Gh,s.ary=ro,s.assign=Cg,s.assignIn=wo,s.assignInWith=Tr,s.assignWith=bg,s.at=Ng,s.before=io,s.bind=Bi,s.bindAll=Up,s.bindKey=uo,s.castArray=eg,s.chain=to,s.chunk=cc,s.compact=hc,s.concat=gc,s.cond=Fp,s.conforms=Wp,s.constant=Ki,s.countBy=Sh,s.create=Dg,s.curry=so,s.curryRight=oo,s.debounce=fo,s.defaults=Pg,s.defaultsDeep=Bg,s.defer=qh,s.delay=Yh,s.difference=pc,s.differenceBy=dc,s.differenceWith=_c,s.drop=vc,s.dropRight=wc,s.dropRightWhile=mc,s.dropWhile=xc,s.fill=Sc,s.filter=Eh,s.flatMap=Oh,s.flatMapDeep=Ah,s.flatMapDepth=Lh,s.flatten=$s,s.flattenDeep=yc,s.flattenDepth=Ec,s.flip=Jh,s.flow=Xp,s.flowRight=Kp,s.fromPairs=Tc,s.functions=Kg,s.functionsIn=Gg,s.groupBy=Ih,s.initial=Oc,s.intersection=Ac,s.intersectionBy=Lc,s.intersectionWith=Ic,s.invert=Yg,s.invertBy=Jg,s.invokeMap=Ch,s.iteratee=Gi,s.keyBy=bh,s.keys=vt,s.keysIn=Mt,s.map=wr,s.mapKeys=Zg,s.mapValues=$g,s.matches=Gp,s.matchesProperty=qp,s.memoize=xr,s.merge=Qg,s.mergeWith=mo,s.method=Yp,s.methodOf=Jp,s.mixin=qi,s.negate=Sr,s.nthArg=Zp,s.omit=kg,s.omitBy=jg,s.once=Vh,s.orderBy=Nh,s.over=$p,s.overArgs=Zh,s.overEvery=Qp,s.overSome=kp,s.partial=Hi,s.partialRight=ao,s.partition=Dh,s.pick=tp,s.pickBy=xo,s.property=Ao,s.propertyOf=jp,s.pull=Nc,s.pullAll=ks,s.pullAllBy=Dc,s.pullAllWith=Pc,s.pullAt=Bc,s.range=td,s.rangeRight=nd,s.rearg=$h,s.reject=Hh,s.remove=Hc,s.rest=Qh,s.reverse=Di,s.sampleSize=Fh,s.set=ep,s.setWith=rp,s.shuffle=Wh,s.slice=Uc,s.sortBy=Kh,s.sortedUniq=qc,s.sortedUniqBy=Yc,s.split=Op,s.spread=kh,s.tail=Jc,s.take=Vc,s.takeRight=Zc,s.takeRightWhile=$c,s.takeWhile=Qc,s.tap=hh,s.throttle=jh,s.thru=vr,s.toArray=po,s.toPairs=So,s.toPairsIn=yo,s.toPath=sd,s.toPlainObject=vo,s.transform=ip,s.unary=tg,s.union=kc,s.unionBy=jc,s.unionWith=th,s.uniq=nh,s.uniqBy=eh,s.uniqWith=rh,s.unset=up,s.unzip=Pi,s.unzipWith=js,s.update=sp,s.updateWith=op,s.values=ee,s.valuesIn=fp,s.without=ih,s.words=Ro,s.wrap=ng,s.xor=uh,s.xorBy=sh,s.xorWith=oh,s.zip=fh,s.zipObject=ah,s.zipObjectDeep=lh,s.zipWith=ch,s.entries=So,s.entriesIn=yo,s.extend=wo,s.extendWith=Tr,qi(s,s),s.add=fd,s.attempt=Oo,s.camelCase=hp,s.capitalize=Eo,s.ceil=ad,s.clamp=ap,s.clone=rg,s.cloneDeep=ug,s.cloneDeepWith=sg,s.cloneWith=ig,s.conformsTo=og,s.deburr=To,s.defaultTo=zp,s.divide=ld,s.endsWith=gp,s.eq=tn,s.escape=pp,s.escapeRegExp=dp,s.every=yh,s.find=Th,s.findIndex=Vs,s.findKey=Hg,s.findLast=Rh,s.findLastIndex=Zs,s.findLastKey=Ug,s.floor=cd,s.forEach=no,s.forEachRight=eo,s.forIn=Fg,s.forInRight=Wg,s.forOwn=zg,s.forOwnRight=Xg,s.get=Wi,s.gt=fg,s.gte=ag,s.has=qg,s.hasIn=zi,s.head=Qs,s.identity=Ct,s.includes=Mh,s.indexOf=Rc,s.inRange=lp,s.invoke=Vg,s.isArguments=Fn,s.isArray=P,s.isArrayBuffer=lg,s.isArrayLike=It,s.isArrayLikeObject=lt,s.isBoolean=cg,s.isBuffer=Ln,s.isDate=hg,s.isElement=gg,s.isEmpty=pg,s.isEqual=dg,s.isEqualWith=_g,s.isError=Ui,s.isFinite=vg,s.isFunction=_n,s.isInteger=lo,s.isLength=yr,s.isMap=co,s.isMatch=wg,s.isMatchWith=mg,s.isNaN=xg,s.isNative=Sg,s.isNil=Eg,s.isNull=yg,s.isNumber=ho,s.isObject=st,s.isObjectLike=ot,s.isPlainObject=Ae,s.isRegExp=Fi,s.isSafeInteger=Tg,s.isSet=go,s.isString=Er,s.isSymbol=Pt,s.isTypedArray=ne,s.isUndefined=Rg,s.isWeakMap=Og,s.isWeakSet=Ag,s.join=Mc,s.kebabCase=_p,s.last=Yt,s.lastIndexOf=Cc,s.lowerCase=vp,s.lowerFirst=wp,s.lt=Lg,s.lte=Ig,s.max=hd,s.maxBy=gd,s.mean=pd,s.meanBy=dd,s.min=_d,s.minBy=vd,s.stubArray=Ji,s.stubFalse=Vi,s.stubObject=ed,s.stubString=rd,s.stubTrue=id,s.multiply=wd,s.nth=bc,s.noConflict=Vp,s.noop=Yi,s.now=mr,s.pad=mp,s.padEnd=xp,s.padStart=Sp,s.parseInt=yp,s.random=cp,s.reduce=Ph,s.reduceRight=Bh,s.repeat=Ep,s.replace=Tp,s.result=np,s.round=md,s.runInContext=c,s.sample=Uh,s.size=zh,s.snakeCase=Rp,s.some=Xh,s.sortedIndex=Fc,s.sortedIndexBy=Wc,s.sortedIndexOf=zc,s.sortedLastIndex=Xc,s.sortedLastIndexBy=Kc,s.sortedLastIndexOf=Gc,s.startCase=Ap,s.startsWith=Lp,s.subtract=xd,s.sum=Sd,s.sumBy=yd,s.template=Ip,s.times=ud,s.toFinite=vn,s.toInteger=H,s.toLength=_o,s.toLower=Mp,s.toNumber=Jt,s.toSafeInteger=Mg,s.toString=J,s.toUpper=Cp,s.trim=bp,s.trimEnd=Np,s.trimStart=Dp,s.truncate=Pp,s.unescape=Bp,s.uniqueId=od,s.upperCase=Hp,s.upperFirst=Xi,s.each=no,s.eachRight=eo,s.first=Qs,qi(s,function(){var t={};return rn(s,function(n,e){$.call(s.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),s.VERSION=p,zt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){s[t].placeholder=s}),zt(["drop","take"],function(t,n){X.prototype[t]=function(e){e=e===i?1:pt(H(e),0);var r=this.__filtered__&&!n?new X(this):this.clone();return r.__filtered__?r.__takeCount__=xt(e,r.__takeCount__):r.__views__.push({size:xt(e,en),type:t+(r.__dir__<0?"Right":"")}),r},X.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),zt(["filter","map","takeWhile"],function(t,n){var e=n+1,r=e==_t||e==fn;X.prototype[t]=function(u){var o=this.clone();return o.__iteratees__.push({iteratee:I(u,3),type:e}),o.__filtered__=o.__filtered__||r,o}}),zt(["head","last"],function(t,n){var e="take"+(n?"Right":"");X.prototype[t]=function(){return this[e](1).value()[0]}}),zt(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");X.prototype[t]=function(){return this.__filtered__?new X(this):this[e](1)}}),X.prototype.compact=function(){return this.filter(Ct)},X.prototype.find=function(t){return this.filter(t).head()},X.prototype.findLast=function(t){return this.reverse().find(t)},X.prototype.invokeMap=F(function(t,n){return typeof t=="function"?new X(this):this.map(function(e){return Se(e,t,n)})}),X.prototype.reject=function(t){return this.filter(Sr(I(t)))},X.prototype.slice=function(t,n){t=H(t);var e=this;return e.__filtered__&&(t>0||n<0)?new X(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==i&&(n=H(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},X.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},X.prototype.toArray=function(){return this.take(en)},rn(X.prototype,function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),u=s[r?"take"+(n=="last"?"Right":""):n],o=r||/^find/.test(n);u&&(s.prototype[n]=function(){var a=this.__wrapped__,l=r?[1]:arguments,h=a instanceof X,v=l[0],w=h||P(a),m=function(z){var G=u.apply(s,Sn([z],l));return r&&S?G[0]:G};w&&e&&typeof v=="function"&&v.length!=1&&(h=w=!1);var S=this.__chain__,O=!!this.__actions__.length,M=o&&!S,U=h&&!O;if(!o&&w){a=U?a:new X(this);var C=t.apply(a,l);return C.__actions__.push({func:vr,args:[m],thisArg:i}),new Kt(C,S)}return M&&U?t.apply(this,l):(C=this.thru(m),M?r?C.value()[0]:C.value():C)})}),zt(["pop","push","shift","sort","splice","unshift"],function(t){var n=Ke[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);s.prototype[t]=function(){var u=arguments;if(r&&!this.__chain__){var o=this.value();return n.apply(P(o)?o:[],u)}return this[e](function(a){return n.apply(P(a)?a:[],u)})}}),rn(X.prototype,function(t,n){var e=s[n];if(e){var r=e.name+"";$.call($n,r)||($n[r]=[]),$n[r].push({name:n,func:e})}}),$n[lr(i,W).name]=[{name:"wrapper",func:i}],X.prototype.clone=Ba,X.prototype.reverse=Ha,X.prototype.value=Ua,s.prototype.at=gh,s.prototype.chain=ph,s.prototype.commit=dh,s.prototype.next=_h,s.prototype.plant=wh,s.prototype.reverse=mh,s.prototype.toJSON=s.prototype.valueOf=s.prototype.value=xh,s.prototype.first=s.prototype.head,pe&&(s.prototype[pe]=vh),s},Jn=da();Cn?((Cn.exports=Jn)._=Jn,Gr._=Jn):wt._=Jn}).call(Le)})(Or,Or.exports);var Dd=Or.exports;const Vt=Rd(Dd);class Q{constructor(f,i){this.id=`point-id-${new Date().getTime().toString()}`,this.x=f,this.y=i,this.initialX=f,this.initialY=i}translate(f,i){this.x+=f,this.y+=i,this.initialX=this.x,this.initialY=this.y}clone(){return new Q(this.x,this.y)}serialize(){return`${this.x},${this.y}`}json(){return JSON.stringify(this)}deserialize(f){const[i,p]=f.split(",").map(_=>parseInt(_));return new Q(i,p)}static middlePoint(f,i){return new Q((f.x+i.x)/2,(f.y+i.y)/2)}static distance(f,i){return Math.sqrt((f.x-i.x)**2+(f.y-i.y)**2)}static isSame(f,i){return f.x===i.x&&f.y===i.y}static isNear(f,i,p=10){return Q.distance(f,i)<p}}class Pd extends Me{constructor(i,p){super(i,p);ft(this,"_point",null);ft(this,"_mouseDown",!1);ft(this,"_moveAll",!1);ft(this,"cursorDefault","default");ft(this,"cursorMove","move");ft(this,"cursorGrab","grab");ft(this,"cursorGrabbing","grabbing")}onEnter(){this.redraw()}onExit(){this._mouseDown=!1,this._point=null,this._moveAll=!1}handleMouseWheel(i,p){}handleMouseDown(i,p){this._mouseDown=!0;const _=this.stateMachine.coordinateSystem;if(!this.stateMachine.ctx||!_||!p)return;const x=this.stateMachine.element,b=this.stateMachine.elements;if(!x)return;const N=i.clientX,B=i.clientY,L=_.clientPointToViewPoint({clientX:N,clientY:B});if(!this._point)if(x.contains(L.x,L.y))this._moveAll=!0;else{const R=b.find(K=>K.contains(L.x,L.y));R&&R!==x?this.stateMachine.element=R:(this.stateMachine.element=null,this.stateMachine.setState(Ie.STATE_SELECT)),this.redraw()}}handleMouseMove(i,p){const _=this.stateMachine.coordinateSystem;if(!this.stateMachine.ctx||!_||!p)return;const x=this.stateMachine.element;if(!x)return;const b=i.clientX,N=i.clientY,B=_.clientPointToViewPoint({clientX:b,clientY:N}),L=x.rectangle.points;if(this._mouseDown){const R={x:i.movementX/_.scale,y:i.movementY/_.scale};this._point?(this._point.translate(R.x,R.y),this.stateMachine.element=x):this._moveAll&&(x.translate(R.x,R.y),this.stateMachine.element=x),this.redraw()}else{const R=L.find(K=>Q.isNear(K,new Q(B.x,B.y)))||null;this._point=R,p.style.cursor=this._point?"move":"default"}}handleMouseUp(i,p){this._mouseDown=!1,this._point=null,this._moveAll=!1,this.stateMachine.element&&this.stateMachine.element.rectangle.processDisplacement()}redraw(){const i=this.stateMachine.ctx,p=this.stateMachine.canvas;if(!i||!p)return;const _=this.stateMachine.element,E=this.stateMachine.elements;i.clearRect(0,0,p.width,p.height),Vt.each(E,x=>{x.draw(i)}),Vt.each(E,x=>{x.draw(i)}),_&&(_.drawBoundingBox(i),_.drawLines(i),_.drawPoints(i))}}class Bd extends Me{constructor(i,p){super(i,p);ft(this,"_handle",null);ft(this,"_mouseDown",!1);ft(this,"cursorDefault","default");ft(this,"cursorResize","nwse-resize")}onEnter(){this.redraw()}onExit(){this._mouseDown=!1,this._handle=null}handleMouseWheel(i,p){}handleMouseDown(i,p){this._mouseDown=!0}handleMouseMove(i,p){const _=this.stateMachine.coordinateSystem,E=this.stateMachine.ctx,x=this.stateMachine.element;if(!E||!_||!x)return;const b=i.clientX,N=i.clientY,B=_.clientPointToViewPoint({clientX:b,clientY:N}),L={x:i.movementX,y:i.movementY};if(this._mouseDown){if(this._handle){const R=x.rectangle.boundingBox,K=R.clone();switch(this._handle){case"topLeft":K.updateDimensions(R.topLeft.x+L.x,R.topLeft.y+L.y,R.width-L.x,R.height-L.y);break;case"topRight":K.updateDimensions(R.topLeft.x,R.topLeft.y+L.y,R.width+L.x,R.height-L.y);break;case"bottomLeft":K.updateDimensions(R.topLeft.x+L.x,R.topLeft.y,R.width-L.x,R.height+L.y);break;case"bottomRight":K.updateDimensions(R.topLeft.x,R.topLeft.y,R.width+L.x,R.height+L.y);break}x.resizeBoundingBox(K),this.redraw()}}else{const R=x.getBoundingBoxHandle(B.x,B.y);if(!R){p.style.cursor=this.cursorDefault;return}const K=x.handleToString(R);this._handle=K,p.style.cursor=this.cursorResize}}handleMouseUp(i,p){this._mouseDown=!1,this._handle=null,this.redraw()}redraw(){const i=this.stateMachine.ctx,p=this.stateMachine.canvas;if(!i||!p)return;const _=this.stateMachine.element,E=this.stateMachine.elements;i.clearRect(0,0,p.width,p.height),Vt.each(E,x=>{x.draw(i)}),_&&(_.drawBoundingBox(i),_.drawLines(i),_.drawBoundingBoxHandles(i))}}class Hd extends Me{constructor(i,p){super(i,p);ft(this,"isMouseDown",!1)}onEnter(){this.redraw()}onExit(){this.isMouseDown=!1}handleMouseDown(i,p){this.isMouseDown=!0}handleMouseWheel(i,p){this.isMouseDown||i.shiftKey&&this.stateMachine.coordinateSystem.scaleAtClientPoint(-.001*i.deltaY,{clientX:i.clientX,clientY:i.clientY})}handleMouseMove(i,p){}handleMouseUp(i,p){this.isMouseDown=!1;const _=this.stateMachine.coordinateSystem;if(!this.stateMachine.ctx||!_||!p)return;const x=this.stateMachine.elements,b=i.clientX,N=i.clientY,B=_.clientPointToViewPoint({clientX:b,clientY:N}),L=x.find(R=>R.contains(B.x,B.y));L?(this.stateMachine.element=L,this.stateMachine.setState(Ie.STATE_MOVE)):this.stateMachine.element=null,this.redraw()}redraw(){const i=this.stateMachine.ctx,p=this.stateMachine.canvas;if(!i||!p)return;const _=this.stateMachine.element,E=this.stateMachine.elements;i.clearRect(0,0,p.width,p.height),Vt.each(E,x=>{x.draw(i)}),_&&(_.drawLines(i),_.drawPoints(i))}}class Ud extends Me{constructor(f,i){super(f,i)}onEnter(){}onExit(){}handleMouseWheel(f,i){}handleMouseDown(f,i){}handleMouseMove(f,i){}handleMouseUp(f,i){}}const ie={Idle:"IDLE",Select:"SELECT",Move:"MOVE",Resize:"RESIZE",Zoom:"ZOOM"},yt=class yt{constructor(f){this._inputs=new Set,this._states={IDLE:new Nd(this,yt.STATE_IDLE),SELECT:new Hd(this,yt.STATE_SELECT),MOVE:new Pd(this,yt.STATE_MOVE),RESIZE:new Bd(this,yt.STATE_RESIZE),ZOOM:new Ud(this,yt.STATE_ZOOM)},this._initialState=f.initialState,this._state=this._states[this._initialState],this._mouseDown=!1,this._elements=f.canvasElements,this._element=null,this._coordinateSystem=f.coordinateSystem,this._canvas=f.canvas,this._ctx=f.ctx}get mouseDown(){return this._mouseDown}get state(){return this._state}set state(f){this._state=f}addState(f){this._states[f.name]=f}setState(f){if(f!==this._state.name){if(!this._states[f])throw new Error(`State ${f} not found`);this._state&&this._state.onExit(),this._state=this._states[f],this._state.onEnter(),console.log(`State changed to ${f}`)}}resetState(){this._element=null,this.setState(this._initialState)}handleMouseWheel(f,i){this._state.handleMouseWheel(f,i)}handleMouseDown(f,i){this._state.handleMouseDown(f,i)}handleMouseMove(f,i){this._state.handleMouseMove(f,i)}handleMouseUp(f,i){this._state.handleMouseUp(f,i)}handleKeyDown(f,i){if(f.ctrlKey&&this.state.name===yt.STATE_MOVE){this.setState(yt.STATE_RESIZE);return}}handleKeyUp(f,i){if(!f.ctrlKey&&this.state.name===yt.STATE_RESIZE){this.setState(yt.STATE_MOVE);return}}get inputs(){return this._inputs}set inputs(f){this._inputs=f}get element(){return this._element}set element(f){this._element=f}get elements(){return this._elements}set elements(f){this._elements=f}get coordinateSystem(){return this._coordinateSystem}set coordinateSystem(f){this._coordinateSystem=f}get canvas(){return this._canvas}set canvas(f){this._canvas=f}get ctx(){return this._ctx}set ctx(f){this._ctx=f}setCanvas(f){this.canvas=f}setCtx(f){this.ctx=f}setCoordinateSystem(f){this.coordinateSystem=f}};ft(yt,"STATE_IDLE",ie.Idle),ft(yt,"STATE_SELECT",ie.Select),ft(yt,"STATE_RESIZE",ie.Resize),ft(yt,"STATE_MOVE",ie.Move),ft(yt,"STATE_ZOOM",ie.Zoom);let Ie=yt,Wn=function(A){return A.AUTO="auto",A.COVER="cover",A.CONTAIN="contain",A}({});var Ot=function(A){return A.BACKGROUND="background",A.INTERFACE="interface",A}(Ot||{});const bo=Wn.CONTAIN,Co=[Ot.BACKGROUND,Ot.INTERFACE],Fd={display:"block",width:"100%",height:"100vh",position:"relative",backgroundColor:"lightblue"},Wd={display:"block",position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"transparent"},zd={size:bo,imageSrc:"./test.png",width:800,height:800},Xd={min:1,max:5};function Jd({initialState:A=ie.Idle,containerElementStyle:f=Fd,canvasElementStyle:i=Wd,background:p=zd,zoomExtents:_=Xd,elements:E=[],onViewChange:x}){const{containerRef:b,screenSize:N}=bd(),B=dt.useRef(null),L=dt.useRef({}),R=dt.useRef({}),K=dt.useRef(W()),rt=dt.useRef(E),ht=dt.useCallback(()=>new Ie({initialState:A,canvasElements:rt.current,coordinateSystem:K.current,canvas:L.current[Ot.INTERFACE],ctx:R.current[Ot.INTERFACE]}),[A]),V=dt.useRef(ht());dt.useEffect(()=>{const y=L.current[Ot.INTERFACE];if(!y)return;const Z=nt=>{V.current.handleMouseMove(nt,y)},q=nt=>{V.current.handleMouseUp(nt,y)},_t=nt=>{V.current.handleMouseDown(nt,y)},on=nt=>{V.current.handleKeyDown(nt,y)},fn=nt=>{V.current.handleKeyUp(nt,y)},At=nt=>{V.current.handleMouseWheel(nt,y)};return y.addEventListener("mousedown",_t),y.addEventListener("mousemove",Z),y.addEventListener("mouseup",q),y.addEventListener("wheel",At),y.addEventListener("keydown",on),y.addEventListener("keyup",fn),()=>{y.removeEventListener("mousedown",_t),y.removeEventListener("mousemove",Z),y.removeEventListener("mouseup",q),y.removeEventListener("wheel",At),y.removeEventListener("keydown",on),y.removeEventListener("keyup",fn)}},[]);function j(y){if(!p)return y;switch(p.size||(p.size=bo),p.size){case Wn.COVER:const Z=B.current;if(Z){const{width:q,height:_t}=Z;if(!p.useImageOriginSize){let on=y.width,fn=y.height;const At=q/_t;return fn=on/At,{width:on,height:fn}}return{width:q,height:_t}}break;case Wn.CONTAIN:return{width:p.width||0,height:p.height||0}}return y}function W(){const y=new Od(_,{width:1920,height:1080});return y.attachViewChangeListener(it),y}function it(y){V.current&&V.current.resetState();const Z=K.current;Z&&(Co.map(q=>R.current[q]).forEach(q=>{at(q);const _t=Z.transformMatrix;q.setTransform(_t.a,_t.b,_t.c,_t.d,_t.e,_t.f)}),Ce())}function at(y){Zt([y],()=>y.clearRect(0,0,y.canvas.width,y.canvas.height))}function Zt(y,Z){y.forEach(q=>{q.save(),q.setTransform(re.a,re.b,re.c,re.d,re.e,re.f)});try{Z()}finally{y.forEach(q=>q.restore())}}function Ut(y){K.current.documentSize={...y}}function mn({canvas:y,ctx:Z,image:q}){if(q&&q.complete&&y&&Z&&p)switch(p.size){case Wn.AUTO:Cd({canvas:y,ctx:Z,image:q});break;case Wn.COVER:Id({ctx:Z,image:q});break;case Wn.CONTAIN:default:Md({canvas:y,ctx:Z,image:q});break}}function Ft(y,Z=!1){let q=!1;const{canvas:_t}=K.current;if((_t.width!==y.width||_t.height!==y.height)&&(Ld(L.current,y),Ut(y),q=!0),Z||q){const on=y.width/K.current.initialViewSize.width,fn=y.height/K.current.initialViewSize.height;Vt.each(rt.current,At=>{At.rectangle.points.forEach(nt=>{nt.x=nt.initialX*on,nt.y=nt.initialY*fn})}),Ce()}}function Mn(){const y=L.current[Ot.BACKGROUND],Z=R.current[Ot.BACKGROUND],q=B.current;!y||!Z||(Z.clearRect(0,0,y.width,y.height),q&&mn({canvas:y,ctx:Z,image:q}))}function ue(){at(R.current[Ot.INTERFACE]),rt.current.forEach(y=>{y.draw(R.current[Ot.INTERFACE])})}function Ce(){Mn(),ue()}return dt.useEffect(()=>{const y=j(N);Ft(y),typeof x=="function"&&x(y)},[N]),dt.useEffect(()=>{V.current.setCanvas(L.current[Ot.INTERFACE]),V.current.setCtx(R.current[Ot.INTERFACE])},[L.current]),dt.useEffect(()=>{if(!(!p||!p.imageSrc||p.imageSrc==="")&&(!B.current||B.current.getAttribute("src")!==p.imageSrc)){const y=new Image;y.src=p.imageSrc,y.onload=()=>{const Z=j(N);Ft(Z,!0),K.current.initialViewSize=Z},y.onabort=()=>{B.current=null},B.current=y}},[p,B]),dt.useEffect(()=>{rt.current=E,V.current.resetState(),V.current.elements=E,R.current[Ot.INTERFACE].clearRect(0,0,N.width,N.height),Vt.each(rt.current,y=>{y.draw(R.current[Ot.INTERFACE])})},[E]),Io.jsx("div",{style:{...f},ref:b,children:Co.map(y=>{const Z=y===Ot.INTERFACE;return Io.jsx("canvas",{tabIndex:Z?1:0,ref:q=>{q&&(L.current[y]=q,R.current[y]=q.getContext("2d"),Z&&(K.current.canvas=q))},style:{...i}},y)})})}class $i{constructor(f){this._points=f}get points(){return this._points}set points(f){this._points=f}get boundingBox(){let f=this._points[0].x,i=this._points[0].y,p=this._points[0].x,_=this._points[0].y;return Vt.each(this._points,E=>{f=Math.min(f,E.x),i=Math.min(i,E.y),p=Math.max(p,E.x),_=Math.max(_,E.y)}),new In(f,i,p-f,_-i)}translate(f,i){Vt.each(this._points,p=>p.translate(f,i))}clone(){return new $i(this._points.map(f=>f.clone()))}serialize(){return Vt.map(this.points,f=>[f.x,f.y])}resize(f){const i=this.boundingBox,p=[];Vt.each(this._points,_=>{p.push({x:(_.x-i.topLeft.x)/i.width,y:(_.y-i.topLeft.y)/i.height})}),this._points=Vt.map(p,_=>new Q(f.topLeft.x+f.width*_.x,f.topLeft.y+f.height*_.y))}deserialize(f){this.points=Vt.map(f,i=>new Q(i[0],i[1]))}isNear(f,i=10){return this._points.some(p=>Q.isNear(p,f,i))}isPartOfPolygon(f){return this._points.some(i=>i.id===f.id)}contains(f,i){let p=!1;for(let _=0,E=this._points.length-1;_<this._points.length;E=_++){const x=this._points[_].x,b=this._points[_].y,N=this._points[E].x,B=this._points[E].y;b>i!=B>i&&f<(N-x)*(i-b)/(B-b)+x&&(p=!p)}return p}}class In extends $i{constructor(f=0,i=0,p=0,_=0){if(f instanceof Q&&i instanceof Q&&p instanceof Q&&_ instanceof Q)super([f,i,p,_]);else if(typeof f=="number"&&typeof i=="number"&&typeof p=="number"&&typeof _=="number")super(In.pointsFromBounds(f,i,p,_));else throw new Error("Invalid arguments")}static pointsFromBounds(f,i,p,_){return[new Q(f,i),new Q(f+p,i),new Q(f+p,i+_),new Q(f,i+_)]}get width(){return this._points[1].x-this._points[0].x}get height(){return this._points[2].y-this._points[1].y}get topLeft(){return this._points[0]}get topRight(){return this._points[1]}get bottomRight(){return this._points[2]}get bottomLeft(){return this._points[3]}get topMid(){return Q.middlePoint(this.topLeft,this.topRight)}get rightMid(){return Q.middlePoint(this.topRight,this.bottomRight)}get bottomMid(){return Q.middlePoint(this.bottomLeft,this.bottomRight)}get leftMid(){return Q.middlePoint(this.topLeft,this.bottomLeft)}updateDimensions(f,i,p,_){this.points=In.pointsFromBounds(f,i,p,_)}processDisplacement(){this.width<0&&([this._points[0],this._points[1]]=[this._points[1],this._points[0]],[this._points[2],this._points[3]]=[this._points[3],this._points[2]]),this.height<0&&([this._points[0],this._points[3]]=[this._points[3],this._points[0]],[this._points[1],this._points[2]]=[this._points[2],this._points[1]])}clone(){return new In(this._points[0].x,this._points[0].y,this.width,this.height)}json(){return JSON.stringify(this)}}const Kd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAYAAAA+VemSAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxMAAAsTAQCanBgAAAtGSURBVHhe7d3JblzXFUbhCiN2Yt+USBY7SWFkwwNPBHjgiaZ+AQ2SOH0iJ47j3pn60Z1zjCMg4l1X9yjYNeDmWgDFutSH39gDAyRAkbOJNtbW1r65vr7eaM9j6Tgdp+NCXYojSjpOx6VwG5ubm11jOkzH6bg4V/+y9O3UmI7TcTou1NW/3Nra6hrTDdNxOi7UXVxcbO7s7EyO6Tgdp+NCXUPfdY7pbqXjdFyoq2hvb69rTDdMx+m4aDfLcISO03GZ3M9fILdnrKKDg4PvdW+m43Tcslx75O7KEbo303H3yp2dnT08OjqaHNNxOk7Hhbrnz59X9MPUmI7TcTou1KU4oqTjdFwKV9F8Pv9Pz5humI7TcaHuNXrx4kXXmO7NdJyOC3UVnZycdI3phuk4HRfqPvzww62KPvnkk/X2IUzH6TgdF+1mBf3QOaa7lY7TcctwswxH6IbpuGyuPXJ35Qjdm+m4e+UqWiwWXWO6YTpOx4W6FEeUdJyOS+E++OCD7Z4xHafjdFyoS3FEScfpuBQuxRElHafjUrjX6OXLl2vtQ5iO03E6LtSlOKKk43RcFjfLcISO03GZ3CzDEbphOi6ba4/ce++9t9MzpuN0nI4LdR9//HHXmI7TcTou1DX0feeY7lY6TseFuhRHlHScjkvhXqNXr16ttg9hOk7H6bhQ99FHH+32jOk4HafjQl2KI0o6TselcCmOKOk4HZfF1e/E+v758+ddY7o303E6bhmu/ujKO3+EbpiOy+baI3dzc7N7eno6OabjdJyOC3VPnz7d6xnTcTpOx4W6FEeUdJyOS+FeoxcvXjxoH8J0nI7TcaEuxRElHafjUriK5vN515humI7TcaEuxRElHafjUriKjo6OusZ0w3Scjot2s4K+6xzT3UrH6bhluFmGI3TDdFw21x65ig4ODr7tGdMN03E6LtSlOKKk43RcCldR6ZueMd0wHafjQt1r9PLly1+2D2E6TsfpuFBX0c7OTteYbpiO03GhrnxeXdHXU2M6TsfpuFBX0dbW1tfl5eSYbpiO03GhrqLNzc2vysvJMd0wHafjot0swxE6TsdlcvX9JFpbW+sa0w3TcTru/3DjNfRledkzpruVjtNxoa6iBw8edI3phuk4HRfqUhxR0nE6LoVLcURJx+m4FK6ilZWVrjHdMB2n46JdFyrpOB2n40JdiiNKOk7HpXApjijpOB2Xw6U4QjeWjkvj6h89qHdMN0zH6bh3dW/trhyhezMdd69ciiNKOk7HpXBpvkbQYTouhUtxREnH6bgULsURJR2n41K4FEeUdJyOS+G6vqG6pON0nI4LdSmOKOk4HZfDpThCN5aOS+PqH5Oo58d8lHScjtNx7+re2n7nmI7TcTou1O1vbm52jekwHafj4tze3l5Fkz/aUsfpOB0X6ira2trqGtMN03E6LtSlOKKk43RcClfQwc7OTs+YDtJxOi7UNTT529J0nI7TcaGuovI2+XtKdZyO03HRrsI7f4SO03GZ3GwKXV1dHRweHr791/uXdJyO03Hv6tojd3FxUcz0mI7TcTou1FV0fHzcNaYbpuN0XKhr6NvOMd2tdJyOC3UVPXr0qGtMN0zH6bhQt1gsjnrGdJyO03GhrqLT09OuMd0wHafjQl2KI0o6TselcO+///7P6Mcff1xpH8J0nI7TcdFuluEIHafjMrnZFHr27Nlxz5iO03E67l1de+QqOj8//6ZnTDdMx+m4UJfiiJKO03EpXIojSjpOx6VwKY4o6Tgdl8Ld3NzMe8Z0nI7TcaGuoa87x3S30nE6LtSlOKKk43RcCpfiiJKO03FZ3KwHPX369JFumI7Tcctwk9+JdReO0A3Tcdlce+Qa+qpzTHcrHafjQl2KI0o6TselcCmOKOk4HZfCPXny5KRnTMfpOB0X6l6jn3766RftQ5iO03E6LtSlOKKk43RcCpfiiJKO03Ep3PX19WlBX06N6Tgdp+OiXf1OrDt/hI7TcZncrAednZ11jemG6Tgd966uPXJ35Qjdm+m4e+Wurq6KmR7TcTpOx4W6FEeUdJyOS+FSHFHScTouhavo5OTk3z1jumE6TseFuhRHlHScjkvhLi8vFz1jOk7H6bhQV9F8Pu8a0w3TcTou2s0K+qJzTHcrHafjluHq+0l0eHj4RXmp+590nI5bohuvoqOjo3+Vl5NjumE6TseFugIW+/v7k2M6TsfpuFDX0OftcTQdp+N0XKiraHd3t2tMN0zH6bhQ19A/2+NoOk7H6bhQV9H29nbXmG6YjtNxoa6hf7TH0XScjtNxoa6izc3NrjHdMB2n46LdrKDP2svR2pjuVjpOxy3DtZfjlaHF+vr65JiO03E6LtSlOKKk43RcClfR6urqq/Y4mo7TcTou1KU4oqTjdFwKV9HKykrXmG6YjtNxoS7FESUdp+NSuBRHlHScjsviulBJx+k4HRfqUhxR0nE6LoubdY2VN90wHafjluEmuwtH6IbpuHvlUhxR0nE6LoVLcURJx+m4FC7LF/g6TselcCmOKOk4HZfCpTiipON0XArX9Q3VJR2n43RcqEtxREnH6bgULsURJR2n43K49fX1rjEdpuN0XLhr799ammN1mI5L4VIcUdJxOu7uu/rvEB8+fDg5puN0nI4LdRWVt66fjqcbpuN0XKgr4Hx7e7tnTAfpOB0X6lIcUdJxOi6Fq2h3d3fyd7HoOB2n40Ld4eHh+cHBweSYjtNxOi7UFXTROaaDdJyOi3b1N5x1jemG6TgdtwzXXo7XxiZ/k7iO03E6LtSlOKKk43RcClc+/76cz+eTYzpOx+m4ULdYLLrGdJyO03GhrqLT09PP2+NoOk7H6bhQd3Z2dtUzpuN0nI4LdRWV/8u7xnTDdJyOC3UpjijpOB2XwjU0+QW0jtNxOi7a1S+OJ1H5/PtaN0zH6bhluPZyvIouLy+7xnTDdJyOC3WPHz+uaPJ7MnWcjtNxoS7FESUdp+NSuOvr68c9YzpOx+m4UNfQ5I/50HE6TseFuhRHlHScjkvhUhxR0nE6LoW7urp6Ut4mf6i0jtNxOi7UhY6VdJyO03G9rsI7f4SO03GZXHs5XkFPO8d0kI7TcaGuob+3x9F0nI7TcaEudKyk43ScjutyoWMlHafjdFyXu7y8/FVBf2uPo+k4HafjQl2KI0o6TselcCmOKOk4HZfCXVxc3PSM6Tgdp+NCXUN/bY+j6Tgdp+OiXYVdY7phOk7HLcO1l+Mt4z+qG6bjdFyXOz8//3XPmI7TcTou1DX0l/Y4mo7TcTou1KU4oqTjdFwKt1gsnpW3yTEdp+N0XKgLHSvpOB2n47pcQ39uj6PpOB2n40JdRScnJ11jumE6TseFuhRHlHScjsviZvP5/E/t5WjHx8fPdMN0nI5bhmsvx7sLR+iG6bh75Rr6Y3scTcfpOB0X6io6PDzsGtMN03E6LtQ19If2OJqO03E6LtRVtL+///v2OJqO03E6LtSlOKKk43RcCrezs/OsvH3aHkfTcTpOx4W6ira2trrGdMN0nI4LdQ39rj2OpuN0nI6LdrONjY2uMd0wHafjluHay/Ha2G/b42g6TsfpuFBX0erqateYbpiO03Ghbm1traLftMfRdJyO03GhrqKVlZWuMd0wHafjQl2KI0o6TselcCmOKOk4HZfCpTiipON0XAqX4oiSjtNxWVwXKuk4Hafjot2sa6y86YbpOB23DDfZXThCN0zH3SuX4oiSjtNxKVyKI0o6TselcFm+wNdxOi6FS3FEScfpuBQuxRElHafjUrgUR5R0nI5L4br+KVNJx+k4HRfqUhxR0nE6LodLcYRuLB2XxrX3b+1mY2Nj8kdglnScjtNx7+A2Pv0v5rAz6DVYBGkAAAAASUVORK5CYII=",Zi=new Image;Zi.src=Kd;class Ar{constructor(f,i,p,_,E,x,b){this._id=f,this._color=i,this._isCurrent=p,this._numberOfEquipments=_,this._rectangle=E,this._isEdit=typeof x=="boolean"?x:!0,this._isTemplate=b||!1}get id(){return this._id}set id(f){this._id=f}get color(){return this._color}get isCurrent(){return this._isCurrent}get numberOfEquipments(){return this._numberOfEquipments}get rectangle(){return this._rectangle}get isEdit(){return this._isEdit}get isTemplate(){return this._isTemplate}translate(f,i){this._rectangle.translate(f,i)}updateDimensions(f,i){this._rectangle.updateDimensions(this._rectangle.topLeft.x,this._rectangle.topLeft.y,f,i)}resizeBoundingBox(f){this._rectangle.resize(f)}draw(f){this.drawPolygon(f),this.drawNumberOfEquipments(f),this.drawIsCurrent(f),this.drawIsTemplate(f)}contains(f,i){return this.isEdit&&this.rectangle.contains(f,i)}drawDebug(f){f.fillStyle="black",f.fillText("TL",this.rectangle.topLeft.x,this.rectangle.topLeft.y,this.rectangle.width),f.fillText("TR",this.rectangle.topRight.x,this.rectangle.topRight.y,this.rectangle.width),f.fillText("BR",this.rectangle.bottomRight.x,this.rectangle.bottomRight.y,this.rectangle.width),f.fillText("BL",this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y,this.rectangle.width)}drawPolygon(f){const i=this.rectangle.points;f.fillStyle=this.color,f.beginPath(),f.moveTo(i[0].x,i[0].y);for(let p=1;p<i.length;p++)f.lineTo(i[p].x,i[p].y);f.closePath(),f.fill()}drawLines(f){const i=this.rectangle.points;f.fillStyle="black",f.lineWidth=1,f.setLineDash([]),f.beginPath(),f.moveTo(i[0].x,i[0].y);for(let p=1;p<i.length;p++)f.lineTo(i[p].x,i[p].y);f.closePath(),f.stroke()}drawIsCurrent(f){this.isCurrent&&(f.fillStyle="red",f.font="40px Arial",f.fillText("*",this.rectangle.topLeft.x,this.rectangle.topLeft.y+35,this.rectangle.width))}drawNumberOfEquipments(f){this.numberOfEquipments>0&&(f.fillStyle="black",f.font="14px Arial",f.fillText(`(${this.numberOfEquipments.toString()})`,this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y+14,this.rectangle.width))}drawIsTemplate(f){if(this.isTemplate&&Zi){const i=f.createPattern(Zi,"repeat");i&&(f.fillStyle=i,f.beginPath(),f.moveTo(this.rectangle.topLeft.x,this.rectangle.topLeft.y),f.lineTo(this.rectangle.topRight.x,this.rectangle.topRight.y),f.lineTo(this.rectangle.bottomRight.x,this.rectangle.bottomRight.y),f.lineTo(this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y),f.lineTo(this.rectangle.topLeft.x,this.rectangle.topLeft.y),f.closePath(),f.fill())}}drawBoundingBox(f){const i=this.rectangle.boundingBox;f.lineWidth=1,f.lineDashOffset=0,f.setLineDash([2,3]),f.beginPath(),f.moveTo(i.topLeft.x,i.topLeft.y),f.lineTo(i.topRight.x,i.topRight.y),f.lineTo(i.bottomRight.x,i.bottomRight.y),f.lineTo(i.bottomLeft.x,i.bottomLeft.y),f.lineTo(i.topLeft.x,i.topLeft.y),f.closePath(),f.stroke()}drawPoints(f){const i=this.rectangle.points;f.fillStyle="purple",i.forEach(p=>{f.beginPath(),f.arc(p.x,p.y,3,0,2*Math.PI),f.fill()}),f.closePath()}drawBoundingBoxHandles(f){const{topLeft:_,topRight:E,bottomRight:x,bottomLeft:b}=this.rectangle.boundingBox;f.strokeStyle="black",f.fillStyle="white",f.setLineDash([]),f.fillRect(_.x-3,_.y-3,6,6),f.fillRect(E.x-3,E.y-3,6,6),f.fillRect(x.x-3,x.y-3,6,6),f.fillRect(b.x-3,b.y-3,6,6),f.strokeRect(_.x-3,_.y-3,6,6),f.strokeRect(E.x-3,E.y-3,6,6),f.strokeRect(x.x-3,x.y-3,6,6),f.strokeRect(b.x-3,b.y-3,6,6),f.stroke()}getBoundingBoxHandle(f,i){const p=this.rectangle.boundingBox,_=[p.topLeft,p.topRight,p.bottomRight,p.bottomLeft],E=_.map(N=>Q.distance(N,new Q(f,i))),x=Math.min(...E),b=E.findIndex(N=>N===x&&N<10);return _[b]}handleToString(f){const{topLeft:i,topRight:p,bottomRight:_,bottomLeft:E}=this.rectangle.boundingBox;return Q.isSame(f,i)?"topLeft":Q.isSame(f,p)?"topRight":Q.isSame(f,_)?"bottomRight":Q.isSame(f,E)?"bottomLeft":null}clone(){const f=this.rectangle.points.map(i=>i.clone());return new Ar(this.id,this.color,this.isCurrent,this.numberOfEquipments,new In(f[0],f[1],f[2],f[3]),this.isEdit,this.isTemplate)}}const Gd="#ffff66";function Vd(){const A={size:Wn.COVER},f=dt.useRef(null),[i,p]=dt.useState([]),[_,E]=dt.useState(A),[x,b]=dt.useState(!1),N=W=>{f.current={...W}},B=W=>{E(it=>({...it,...W}))},L=W=>{const it=W.map(at=>{const Zt=new In(0,0,0,0);return Zt.deserialize(JSON.parse(at.JsonRectangle)),new Ar(at.id.toString(),at.Color,at.IsCurrent,at.NumberEquipment,Zt,at.IsEdit,at.IsTemplate)});p([...it])},R=W=>{N(W),B({imageSrc:W.imageSource}),L(W.data),b(W.viewMode)},K=()=>{const W=new In(0,0,100,100),it=new Ar(`${i.length+1}`,Gd,!1,4,W,!0);p([...i,it])},rt=()=>{f.current&&R(f.current)},ht=W=>{N({background:_,elements:i}),typeof W=="function"&&W(j())},V=()=>{const W=i.map(it=>({id:it.id,IsTemplate:!1,NumberEquipment:it.numberOfEquipments,Color:it.color,IsCurrent:it.isCurrent,JsonRectangle:it.rectangle.serialize(),isEdit:it.isEdit}));return console.log("exportRectangles: ",W),W},j=()=>{const W=i.map(it=>({id:parseInt(it.id),IsTemplate:!1,NumberEquipment:it.numberOfEquipments,Color:it.color,IsCurrent:it.isCurrent,JsonRectangle:JSON.stringify(it.rectangle.serialize()),isEdit:it.isEdit}));return JSON.stringify({background:_,data:W})};return{viewMode:x,background:_,elements:i,loadBackground:B,loadDataSource:L,loadAll:R,addRectangle:K,exportRectangles:V,toString:j,saveData:ht,resetData:rt}}export{Jd as C,Vd as u};
