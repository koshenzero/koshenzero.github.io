var md=Object.defineProperty;var xd=(I,a,u)=>a in I?md(I,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):I[a]=u;var en=(I,a,u)=>(xd(I,typeof a!="symbol"?a+"":a,u),u);import{r as gt,x as Ie,q as yd,j as _n}from"./index-BC3rt2Tj.js";import{C as Rd}from"./CCol-BO_cn80g.js";const Ef=Object.freeze({x:0,y:0,untransformedX:0,untransformedY:0}),Rr=Object.freeze({canvasWidth:0,canvasHeight:0,left:0,top:0,right:0,bottom:0,viewMin:Ef,viewMax:Ef}),ue=Object.freeze({a:1,b:0,c:0,d:1,e:0,f:0});class Sd{constructor(a,u){en(this,"_canvas",null);en(this,"_view",{scale:1,x:0,y:0});en(this,"_viewChangeListeners",new Set);this._scaleExtents=a,this._documentSize=u}get canvas(){return this._canvas}set canvas(a){this._canvas=a,this.setView()}get scale(){return this._view.scale}setScale(a){this.setView({scale:a})}get x(){return this._view.x}set x(a){this.setView({x:a})}get y(){return this._view.y}set y(a){this.setView({y:a})}get view(){return{...this._view}}get scaleExtents(){return{...this._scaleExtents}}set scaleExtents(a){this._scaleExtents={...a},this.setView()}get documentSize(){return{...this._documentSize}}set documentSize(a){this._documentSize={...a},this.setView()}get transformMatrix(){return{a:this._view.scale,b:0,c:0,d:this._view.scale,e:this._view.x,f:this._view.y}}get canvasBounds(){if(this._canvas){const{left:a,top:u,right:R,bottom:w}=this._canvas.getBoundingClientRect();return{viewMin:this.clientPointToViewPoint({clientX:a,clientY:u}),viewMax:this.clientPointToViewPoint({clientX:R,clientY:w}),left:a,top:u,right:R,bottom:w,canvasWidth:this._canvas.width,canvasHeight:this._canvas.height}}else return}get canvasRect(){if(this._canvas)return this._canvas.getBoundingClientRect()}clampView(a){const{min:u,max:R}=this._scaleExtents,{width:w,height:E}=this._documentSize,{left:L,top:C,right:x,bottom:H}=this.canvasRect||Rr,F=x-L,D=H-C,k=F/2,ft=-(w*this._view.scale-F/2),V=D/2,K=-(E*this._view.scale-D/2);return{scale:Math.min(Math.max(a.scale,u),R),x:Math.min(Math.max(a.x,ft),k),y:Math.min(Math.max(a.y,K),V)}}resetView(){this.setView({scale:1,x:0,y:0})}setView(a){const u=this.clampView({...this._view,...a||{}}),{scale:R,x:w,y:E}=this._view;return(u.scale!==R||u.x!==w||u.y!==E)&&(this._view=u,this._viewChangeListeners.forEach(L=>L&&L({view:u,transform:this.transformMatrix}))),{...this._view}}scaleAtClientPoint(a,u){const R=this.clientPointToViewPoint(u),w=this.clampView({...this._view,scale:this._view.scale+a}),E=this.viewPointToClientPoint(R,w);w.x=this._view.x-(E.clientX-u.clientX),w.y=this._view.y-(E.clientY-u.clientY);const{width:L,height:C}=this._documentSize,{left:x,top:H,right:F,bottom:D}=this.canvasRect||Rr,k=F-x,ft=D-H,V=k/2,K=-(L*w.scale-k/2),P=ft/2,et=-(C*w.scale-ft/2);return w.x=Math.min(Math.max(w.x,K),V),w.y=Math.min(Math.max(w.y,et),P),w.scale===this._scaleExtents.min&&(w.x=0,w.y=0),this.setView(w)}clientPointToViewPoint(a,u=this._view){const{left:R,top:w}=this.canvasRect||Rr,E=a.clientX-R,L=a.clientY-w;return{x:(E-u.x)/u.scale,y:(L-u.y)/u.scale,relativeClientX:E,relativeClientY:L}}viewPointToClientPoint(a,u=this._view){const{left:R,top:w}=this.canvasRect||Rr,E=a.x*u.scale+u.x,L=a.y*u.scale+u.y,C=E+R,x=L+w;return{clientX:C,clientY:x,relativeX:E,relativeY:L,x:C,y:x}}attachViewChangeListener(a){this._viewChangeListeners.add(a)}}const Ed=(I,a,u)=>{I.width=a,I.height=u,I.style.width=`${a}px`,I.style.height=`${u}px`},Ad=(I,a)=>{for(const u in I)Object.prototype.hasOwnProperty.call(I,u)&&Ed(I[u],a.width,a.height)};function Cd({ctx:I,image:a,x:u=0,y:R=0,w=I.canvas.width,h:E=I.canvas.height,offsetX:L=.5,offsetY:C=.5}){L<0&&(L=0),C<0&&(C=0),L>1&&(L=1),C>1&&(C=1);const x=a.width,H=a.height,F=Math.min(w/x,E/H);let D=x*F,k=H*F,ft,V,K,P,et=1;D<w&&(et=w/D),Math.abs(et-1)<1e-14&&k<E&&(et=E/k),D*=et,k*=et,K=x/(D/w),P=H/(k/E),ft=(x-K)*L,V=(H-P)*C,ft<0&&(ft=0),V<0&&(V=0),K>x&&(K=x),P>H&&(P=H),I.drawImage(a,ft,V,K,P,u,R,w,E)}function Ld({canvas:I,ctx:a,image:u}){if(u&&u.complete&&I&&a){const R=u.width,w=u.height,E=I.getBoundingClientRect(),L=E.width,C=E.height,x=R/w;let H=L,F=H/x;F>C&&(F=C,H=F*x),a.drawImage(u,0,0,R,w,0,0,H,F)}}function Id({canvas:I,ctx:a,image:u}){if(u&&u.complete&&I&&a){const R=u.width,w=u.height,E=I.getBoundingClientRect(),L=E.width,C=E.height;a.drawImage(u,0,0,R,w,0,0,L,C)}}function Md(I){const a=gt.useRef(null),[u,R]=gt.useState({width:window.innerWidth,height:window.innerHeight});return gt.useEffect(()=>{const w=new ResizeObserver(E=>{for(const L of E){if(L.contentRect){const{width:C,height:x}=L.contentRect;R({width:C,height:x})}typeof I=="function"&&I(L)}});return a.current&&w.observe(a.current),()=>{w.disconnect()}},[I]),{containerRef:a,screenSize:u}}class Td{constructor(a){en(this,"_selectedElement",null);en(this,"_canvas",null);en(this,"_ctx",null);this._states={},this._state=this._states[0],this._elements=a.canvasElements,this._elements=a.canvasElements,this._coordinateSystem=a.coordinateSystem,this._canvas=a.canvas,this._ctx=a.ctx}get state(){return this._state}set state(a){this._state=a}addState(a){this._states[a.name]=a}setState(a){if(!this._states[a])throw new Error(`State ${a} not found`);this._state=this._states[a]}handleMouseWheel(a,u){this._state.handleMouseWheel(a,u)}handleMouseDown(a,u){this._state.handleMouseDown(a,u)}handleMouseMove(a,u){this._state.handleMouseMove(a,u)}handleMouseUp(a,u){this._state.handleMouseUp(a,u)}handleKeyDown(a,u){this._state.handleKeyDown(a,u)}handleKeyUp(a,u){this._state.handleKeyUp(a,u)}set selectedElement(a){this._selectedElement=a}get selectedElement(){return this._selectedElement}get elements(){return this._elements}set elements(a){this._elements=a}get coordinateSystem(){return this._coordinateSystem}set coordinateSystem(a){this._coordinateSystem=a}get canvas(){return this._canvas}set canvas(a){this._canvas=a}get ctx(){return this._ctx}set ctx(a){this._ctx=a}setCanvas(a){this.canvas=a}setCtx(a){this.ctx=a}setCoordinateSystem(a){this.coordinateSystem=a}}var Sr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Sr.exports;(function(I,a){(function(){var u,R="4.17.21",w=200,E="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",L="Expected a function",C="Invalid `variable` option passed into `_.template`",x="__lodash_hash_undefined__",H=500,F="__lodash_placeholder__",D=1,k=2,ft=4,V=1,K=2,P=1,et=2,vn=4,Wt=8,wn=16,Bt=32,un=64,qt=128,Mn=256,Gn=512,m=30,X="...",$=800,_t=16,vt=1,Qt=2,Tn=3,ot=1/0,mn=9007199254740991,Mf=17976931348623157e292,Me=NaN,kt=4294967295,Tf=kt-1,Of=kt>>>1,bf=[["ary",qt],["bind",P],["bindKey",et],["curry",Wt],["curryRight",wn],["flip",Gn],["partial",Bt],["partialRight",un],["rearg",Mn]],Kn="[object Arguments]",Te="[object Array]",Df="[object AsyncFunction]",se="[object Boolean]",fe="[object Date]",Wf="[object DOMException]",Oe="[object Error]",be="[object Function]",Yi="[object GeneratorFunction]",$t="[object Map]",oe="[object Number]",Bf="[object Null]",sn="[object Object]",Xi="[object Promise]",Pf="[object Proxy]",ae="[object RegExp]",Yt="[object Set]",le="[object String]",De="[object Symbol]",Uf="[object Undefined]",ce="[object WeakMap]",Ff="[object WeakSet]",he="[object ArrayBuffer]",qn="[object DataView]",Er="[object Float32Array]",Ar="[object Float64Array]",Cr="[object Int8Array]",Lr="[object Int16Array]",Ir="[object Int32Array]",Mr="[object Uint8Array]",Tr="[object Uint8ClampedArray]",Or="[object Uint16Array]",br="[object Uint32Array]",Nf=/\b__p \+= '';/g,zf=/\b(__p \+=) '' \+/g,Hf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Zi=/&(?:amp|lt|gt|quot|#39);/g,Ji=/[&<>"']/g,Gf=RegExp(Zi.source),Kf=RegExp(Ji.source),qf=/<%-([\s\S]+?)%>/g,$f=/<%([\s\S]+?)%>/g,Vi=/<%=([\s\S]+?)%>/g,Yf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xf=/^\w*$/,Zf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dr=/[\\^$.*+?()[\]{}|]/g,Jf=RegExp(Dr.source),Wr=/^\s+/,Vf=/\s/,Qf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,kf=/\{\n\/\* \[wrapped with (.+)\] \*/,jf=/,? & /,to=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,no=/[()=,{}\[\]\/\s]/,eo=/\\(\\)?/g,ro=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Qi=/\w*$/,io=/^[-+]0x[0-9a-f]+$/i,uo=/^0b[01]+$/i,so=/^\[object .+?Constructor\]$/,fo=/^0o[0-7]+$/i,oo=/^(?:0|[1-9]\d*)$/,ao=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,We=/($^)/,lo=/['\n\r\u2028\u2029\\]/g,Be="\\ud800-\\udfff",co="\\u0300-\\u036f",ho="\\ufe20-\\ufe2f",go="\\u20d0-\\u20ff",ki=co+ho+go,ji="\\u2700-\\u27bf",tu="a-z\\xdf-\\xf6\\xf8-\\xff",po="\\xac\\xb1\\xd7\\xf7",_o="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vo="\\u2000-\\u206f",wo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nu="A-Z\\xc0-\\xd6\\xd8-\\xde",eu="\\ufe0e\\ufe0f",ru=po+_o+vo+wo,Br="['’]",mo="["+Be+"]",iu="["+ru+"]",Pe="["+ki+"]",uu="\\d+",xo="["+ji+"]",su="["+tu+"]",fu="[^"+Be+ru+uu+ji+tu+nu+"]",Pr="\\ud83c[\\udffb-\\udfff]",yo="(?:"+Pe+"|"+Pr+")",ou="[^"+Be+"]",Ur="(?:\\ud83c[\\udde6-\\uddff]){2}",Fr="[\\ud800-\\udbff][\\udc00-\\udfff]",$n="["+nu+"]",au="\\u200d",lu="(?:"+su+"|"+fu+")",Ro="(?:"+$n+"|"+fu+")",cu="(?:"+Br+"(?:d|ll|m|re|s|t|ve))?",hu="(?:"+Br+"(?:D|LL|M|RE|S|T|VE))?",gu=yo+"?",pu="["+eu+"]?",So="(?:"+au+"(?:"+[ou,Ur,Fr].join("|")+")"+pu+gu+")*",Eo="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ao="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",du=pu+gu+So,Co="(?:"+[xo,Ur,Fr].join("|")+")"+du,Lo="(?:"+[ou+Pe+"?",Pe,Ur,Fr,mo].join("|")+")",Io=RegExp(Br,"g"),Mo=RegExp(Pe,"g"),Nr=RegExp(Pr+"(?="+Pr+")|"+Lo+du,"g"),To=RegExp([$n+"?"+su+"+"+cu+"(?="+[iu,$n,"$"].join("|")+")",Ro+"+"+hu+"(?="+[iu,$n+lu,"$"].join("|")+")",$n+"?"+lu+"+"+cu,$n+"+"+hu,Ao,Eo,uu,Co].join("|"),"g"),Oo=RegExp("["+au+Be+ki+eu+"]"),bo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Do=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Wo=-1,tt={};tt[Er]=tt[Ar]=tt[Cr]=tt[Lr]=tt[Ir]=tt[Mr]=tt[Tr]=tt[Or]=tt[br]=!0,tt[Kn]=tt[Te]=tt[he]=tt[se]=tt[qn]=tt[fe]=tt[Oe]=tt[be]=tt[$t]=tt[oe]=tt[sn]=tt[ae]=tt[Yt]=tt[le]=tt[ce]=!1;var j={};j[Kn]=j[Te]=j[he]=j[qn]=j[se]=j[fe]=j[Er]=j[Ar]=j[Cr]=j[Lr]=j[Ir]=j[$t]=j[oe]=j[sn]=j[ae]=j[Yt]=j[le]=j[De]=j[Mr]=j[Tr]=j[Or]=j[br]=!0,j[Oe]=j[be]=j[ce]=!1;var Bo={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Po={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Uo={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},No=parseFloat,zo=parseInt,_u=typeof Ie=="object"&&Ie&&Ie.Object===Object&&Ie,Ho=typeof self=="object"&&self&&self.Object===Object&&self,pt=_u||Ho||Function("return this")(),zr=a&&!a.nodeType&&a,On=zr&&!0&&I&&!I.nodeType&&I,vu=On&&On.exports===zr,Hr=vu&&_u.process,Pt=function(){try{var c=On&&On.require&&On.require("util").types;return c||Hr&&Hr.binding&&Hr.binding("util")}catch{}}(),wu=Pt&&Pt.isArrayBuffer,mu=Pt&&Pt.isDate,xu=Pt&&Pt.isMap,yu=Pt&&Pt.isRegExp,Ru=Pt&&Pt.isSet,Su=Pt&&Pt.isTypedArray;function It(c,p,g){switch(g.length){case 0:return c.call(p);case 1:return c.call(p,g[0]);case 2:return c.call(p,g[0],g[1]);case 3:return c.call(p,g[0],g[1],g[2])}return c.apply(p,g)}function Go(c,p,g,S){for(var b=-1,Y=c==null?0:c.length;++b<Y;){var at=c[b];p(S,at,g(at),c)}return S}function Ut(c,p){for(var g=-1,S=c==null?0:c.length;++g<S&&p(c[g],g,c)!==!1;);return c}function Ko(c,p){for(var g=c==null?0:c.length;g--&&p(c[g],g,c)!==!1;);return c}function Eu(c,p){for(var g=-1,S=c==null?0:c.length;++g<S;)if(!p(c[g],g,c))return!1;return!0}function xn(c,p){for(var g=-1,S=c==null?0:c.length,b=0,Y=[];++g<S;){var at=c[g];p(at,g,c)&&(Y[b++]=at)}return Y}function Ue(c,p){var g=c==null?0:c.length;return!!g&&Yn(c,p,0)>-1}function Gr(c,p,g){for(var S=-1,b=c==null?0:c.length;++S<b;)if(g(p,c[S]))return!0;return!1}function nt(c,p){for(var g=-1,S=c==null?0:c.length,b=Array(S);++g<S;)b[g]=p(c[g],g,c);return b}function yn(c,p){for(var g=-1,S=p.length,b=c.length;++g<S;)c[b+g]=p[g];return c}function Kr(c,p,g,S){var b=-1,Y=c==null?0:c.length;for(S&&Y&&(g=c[++b]);++b<Y;)g=p(g,c[b],b,c);return g}function qo(c,p,g,S){var b=c==null?0:c.length;for(S&&b&&(g=c[--b]);b--;)g=p(g,c[b],b,c);return g}function qr(c,p){for(var g=-1,S=c==null?0:c.length;++g<S;)if(p(c[g],g,c))return!0;return!1}var $o=$r("length");function Yo(c){return c.split("")}function Xo(c){return c.match(to)||[]}function Au(c,p,g){var S;return g(c,function(b,Y,at){if(p(b,Y,at))return S=Y,!1}),S}function Fe(c,p,g,S){for(var b=c.length,Y=g+(S?1:-1);S?Y--:++Y<b;)if(p(c[Y],Y,c))return Y;return-1}function Yn(c,p,g){return p===p?ua(c,p,g):Fe(c,Cu,g)}function Zo(c,p,g,S){for(var b=g-1,Y=c.length;++b<Y;)if(S(c[b],p))return b;return-1}function Cu(c){return c!==c}function Lu(c,p){var g=c==null?0:c.length;return g?Xr(c,p)/g:Me}function $r(c){return function(p){return p==null?u:p[c]}}function Yr(c){return function(p){return c==null?u:c[p]}}function Iu(c,p,g,S,b){return b(c,function(Y,at,Q){g=S?(S=!1,Y):p(g,Y,at,Q)}),g}function Jo(c,p){var g=c.length;for(c.sort(p);g--;)c[g]=c[g].value;return c}function Xr(c,p){for(var g,S=-1,b=c.length;++S<b;){var Y=p(c[S]);Y!==u&&(g=g===u?Y:g+Y)}return g}function Zr(c,p){for(var g=-1,S=Array(c);++g<c;)S[g]=p(g);return S}function Vo(c,p){return nt(p,function(g){return[g,c[g]]})}function Mu(c){return c&&c.slice(0,Du(c)+1).replace(Wr,"")}function Mt(c){return function(p){return c(p)}}function Jr(c,p){return nt(p,function(g){return c[g]})}function ge(c,p){return c.has(p)}function Tu(c,p){for(var g=-1,S=c.length;++g<S&&Yn(p,c[g],0)>-1;);return g}function Ou(c,p){for(var g=c.length;g--&&Yn(p,c[g],0)>-1;);return g}function Qo(c,p){for(var g=c.length,S=0;g--;)c[g]===p&&++S;return S}var ko=Yr(Bo),jo=Yr(Po);function ta(c){return"\\"+Fo[c]}function na(c,p){return c==null?u:c[p]}function Xn(c){return Oo.test(c)}function ea(c){return bo.test(c)}function ra(c){for(var p,g=[];!(p=c.next()).done;)g.push(p.value);return g}function Vr(c){var p=-1,g=Array(c.size);return c.forEach(function(S,b){g[++p]=[b,S]}),g}function bu(c,p){return function(g){return c(p(g))}}function Rn(c,p){for(var g=-1,S=c.length,b=0,Y=[];++g<S;){var at=c[g];(at===p||at===F)&&(c[g]=F,Y[b++]=g)}return Y}function Ne(c){var p=-1,g=Array(c.size);return c.forEach(function(S){g[++p]=S}),g}function ia(c){var p=-1,g=Array(c.size);return c.forEach(function(S){g[++p]=[S,S]}),g}function ua(c,p,g){for(var S=g-1,b=c.length;++S<b;)if(c[S]===p)return S;return-1}function sa(c,p,g){for(var S=g+1;S--;)if(c[S]===p)return S;return S}function Zn(c){return Xn(c)?oa(c):$o(c)}function Xt(c){return Xn(c)?aa(c):Yo(c)}function Du(c){for(var p=c.length;p--&&Vf.test(c.charAt(p)););return p}var fa=Yr(Uo);function oa(c){for(var p=Nr.lastIndex=0;Nr.test(c);)++p;return p}function aa(c){return c.match(Nr)||[]}function la(c){return c.match(To)||[]}var ca=function c(p){p=p==null?pt:Jn.defaults(pt.Object(),p,Jn.pick(pt,Do));var g=p.Array,S=p.Date,b=p.Error,Y=p.Function,at=p.Math,Q=p.Object,Qr=p.RegExp,ha=p.String,Ft=p.TypeError,ze=g.prototype,ga=Y.prototype,Vn=Q.prototype,He=p["__core-js_shared__"],Ge=ga.toString,J=Vn.hasOwnProperty,pa=0,Wu=function(){var t=/[^.]+$/.exec(He&&He.keys&&He.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ke=Vn.toString,da=Ge.call(Q),_a=pt._,va=Qr("^"+Ge.call(J).replace(Dr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qe=vu?p.Buffer:u,Sn=p.Symbol,$e=p.Uint8Array,Bu=qe?qe.allocUnsafe:u,Ye=bu(Q.getPrototypeOf,Q),Pu=Q.create,Uu=Vn.propertyIsEnumerable,Xe=ze.splice,Fu=Sn?Sn.isConcatSpreadable:u,pe=Sn?Sn.iterator:u,bn=Sn?Sn.toStringTag:u,Ze=function(){try{var t=Un(Q,"defineProperty");return t({},"",{}),t}catch{}}(),wa=p.clearTimeout!==pt.clearTimeout&&p.clearTimeout,ma=S&&S.now!==pt.Date.now&&S.now,xa=p.setTimeout!==pt.setTimeout&&p.setTimeout,Je=at.ceil,Ve=at.floor,kr=Q.getOwnPropertySymbols,ya=qe?qe.isBuffer:u,Nu=p.isFinite,Ra=ze.join,Sa=bu(Q.keys,Q),lt=at.max,wt=at.min,Ea=S.now,Aa=p.parseInt,zu=at.random,Ca=ze.reverse,jr=Un(p,"DataView"),de=Un(p,"Map"),ti=Un(p,"Promise"),Qn=Un(p,"Set"),_e=Un(p,"WeakMap"),ve=Un(Q,"create"),Qe=_e&&new _e,kn={},La=Fn(jr),Ia=Fn(de),Ma=Fn(ti),Ta=Fn(Qn),Oa=Fn(_e),ke=Sn?Sn.prototype:u,we=ke?ke.valueOf:u,Hu=ke?ke.toString:u;function s(t){if(it(t)&&!W(t)&&!(t instanceof G)){if(t instanceof Nt)return t;if(J.call(t,"__wrapped__"))return Gs(t)}return new Nt(t)}var jn=function(){function t(){}return function(n){if(!rt(n))return{};if(Pu)return Pu(n);t.prototype=n;var e=new t;return t.prototype=u,e}}();function je(){}function Nt(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=u}s.templateSettings={escape:qf,evaluate:$f,interpolate:Vi,variable:"",imports:{_:s}},s.prototype=je.prototype,s.prototype.constructor=s,Nt.prototype=jn(je.prototype),Nt.prototype.constructor=Nt;function G(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=kt,this.__views__=[]}function ba(){var t=new G(this.__wrapped__);return t.__actions__=St(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=St(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=St(this.__views__),t}function Da(){if(this.__filtered__){var t=new G(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Wa(){var t=this.__wrapped__.value(),n=this.__dir__,e=W(t),r=n<0,i=e?t.length:0,f=Yl(0,i,this.__views__),o=f.start,l=f.end,h=l-o,d=r?l:o-1,_=this.__iteratees__,v=_.length,y=0,A=wt(h,this.__takeCount__);if(!e||!r&&i==h&&A==h)return cs(t,this.__actions__);var T=[];t:for(;h--&&y<A;){d+=n;for(var U=-1,O=t[d];++U<v;){var z=_[U],q=z.iteratee,bt=z.type,Rt=q(O);if(bt==Qt)O=Rt;else if(!Rt){if(bt==vt)continue t;break t}}T[y++]=O}return T}G.prototype=jn(je.prototype),G.prototype.constructor=G;function Dn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function Ba(){this.__data__=ve?ve(null):{},this.size=0}function Pa(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Ua(t){var n=this.__data__;if(ve){var e=n[t];return e===x?u:e}return J.call(n,t)?n[t]:u}function Fa(t){var n=this.__data__;return ve?n[t]!==u:J.call(n,t)}function Na(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=ve&&n===u?x:n,this}Dn.prototype.clear=Ba,Dn.prototype.delete=Pa,Dn.prototype.get=Ua,Dn.prototype.has=Fa,Dn.prototype.set=Na;function fn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function za(){this.__data__=[],this.size=0}function Ha(t){var n=this.__data__,e=tr(n,t);if(e<0)return!1;var r=n.length-1;return e==r?n.pop():Xe.call(n,e,1),--this.size,!0}function Ga(t){var n=this.__data__,e=tr(n,t);return e<0?u:n[e][1]}function Ka(t){return tr(this.__data__,t)>-1}function qa(t,n){var e=this.__data__,r=tr(e,t);return r<0?(++this.size,e.push([t,n])):e[r][1]=n,this}fn.prototype.clear=za,fn.prototype.delete=Ha,fn.prototype.get=Ga,fn.prototype.has=Ka,fn.prototype.set=qa;function on(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function $a(){this.size=0,this.__data__={hash:new Dn,map:new(de||fn),string:new Dn}}function Ya(t){var n=hr(this,t).delete(t);return this.size-=n?1:0,n}function Xa(t){return hr(this,t).get(t)}function Za(t){return hr(this,t).has(t)}function Ja(t,n){var e=hr(this,t),r=e.size;return e.set(t,n),this.size+=e.size==r?0:1,this}on.prototype.clear=$a,on.prototype.delete=Ya,on.prototype.get=Xa,on.prototype.has=Za,on.prototype.set=Ja;function Wn(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new on;++n<e;)this.add(t[n])}function Va(t){return this.__data__.set(t,x),this}function Qa(t){return this.__data__.has(t)}Wn.prototype.add=Wn.prototype.push=Va,Wn.prototype.has=Qa;function Zt(t){var n=this.__data__=new fn(t);this.size=n.size}function ka(){this.__data__=new fn,this.size=0}function ja(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}function tl(t){return this.__data__.get(t)}function nl(t){return this.__data__.has(t)}function el(t,n){var e=this.__data__;if(e instanceof fn){var r=e.__data__;if(!de||r.length<w-1)return r.push([t,n]),this.size=++e.size,this;e=this.__data__=new on(r)}return e.set(t,n),this.size=e.size,this}Zt.prototype.clear=ka,Zt.prototype.delete=ja,Zt.prototype.get=tl,Zt.prototype.has=nl,Zt.prototype.set=el;function Gu(t,n){var e=W(t),r=!e&&Nn(t),i=!e&&!r&&In(t),f=!e&&!r&&!i&&re(t),o=e||r||i||f,l=o?Zr(t.length,ha):[],h=l.length;for(var d in t)(n||J.call(t,d))&&!(o&&(d=="length"||i&&(d=="offset"||d=="parent")||f&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||hn(d,h)))&&l.push(d);return l}function Ku(t){var n=t.length;return n?t[ci(0,n-1)]:u}function rl(t,n){return gr(St(t),Bn(n,0,t.length))}function il(t){return gr(St(t))}function ni(t,n,e){(e!==u&&!Jt(t[n],e)||e===u&&!(n in t))&&an(t,n,e)}function me(t,n,e){var r=t[n];(!(J.call(t,n)&&Jt(r,e))||e===u&&!(n in t))&&an(t,n,e)}function tr(t,n){for(var e=t.length;e--;)if(Jt(t[e][0],n))return e;return-1}function ul(t,n,e,r){return En(t,function(i,f,o){n(r,i,e(i),o)}),r}function qu(t,n){return t&&tn(n,ht(n),t)}function sl(t,n){return t&&tn(n,At(n),t)}function an(t,n,e){n=="__proto__"&&Ze?Ze(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function ei(t,n){for(var e=-1,r=n.length,i=g(r),f=t==null;++e<r;)i[e]=f?u:Pi(t,n[e]);return i}function Bn(t,n,e){return t===t&&(e!==u&&(t=t<=e?t:e),n!==u&&(t=t>=n?t:n)),t}function zt(t,n,e,r,i,f){var o,l=n&D,h=n&k,d=n&ft;if(e&&(o=i?e(t,r,i,f):e(t)),o!==u)return o;if(!rt(t))return t;var _=W(t);if(_){if(o=Zl(t),!l)return St(t,o)}else{var v=mt(t),y=v==be||v==Yi;if(In(t))return ps(t,l);if(v==sn||v==Kn||y&&!i){if(o=h||y?{}:Ds(t),!l)return h?Ul(t,sl(o,t)):Pl(t,qu(o,t))}else{if(!j[v])return i?t:{};o=Jl(t,v,l)}}f||(f=new Zt);var A=f.get(t);if(A)return A;f.set(t,o),af(t)?t.forEach(function(O){o.add(zt(O,n,e,O,t,f))}):ff(t)&&t.forEach(function(O,z){o.set(z,zt(O,n,e,z,t,f))});var T=d?h?Ri:yi:h?At:ht,U=_?u:T(t);return Ut(U||t,function(O,z){U&&(z=O,O=t[z]),me(o,z,zt(O,n,e,z,t,f))}),o}function fl(t){var n=ht(t);return function(e){return $u(e,t,n)}}function $u(t,n,e){var r=e.length;if(t==null)return!r;for(t=Q(t);r--;){var i=e[r],f=n[i],o=t[i];if(o===u&&!(i in t)||!f(o))return!1}return!0}function Yu(t,n,e){if(typeof t!="function")throw new Ft(L);return Ce(function(){t.apply(u,e)},n)}function xe(t,n,e,r){var i=-1,f=Ue,o=!0,l=t.length,h=[],d=n.length;if(!l)return h;e&&(n=nt(n,Mt(e))),r?(f=Gr,o=!1):n.length>=w&&(f=ge,o=!1,n=new Wn(n));t:for(;++i<l;){var _=t[i],v=e==null?_:e(_);if(_=r||_!==0?_:0,o&&v===v){for(var y=d;y--;)if(n[y]===v)continue t;h.push(_)}else f(n,v,r)||h.push(_)}return h}var En=ms(jt),Xu=ms(ii,!0);function ol(t,n){var e=!0;return En(t,function(r,i,f){return e=!!n(r,i,f),e}),e}function nr(t,n,e){for(var r=-1,i=t.length;++r<i;){var f=t[r],o=n(f);if(o!=null&&(l===u?o===o&&!Ot(o):e(o,l)))var l=o,h=f}return h}function al(t,n,e,r){var i=t.length;for(e=B(e),e<0&&(e=-e>i?0:i+e),r=r===u||r>i?i:B(r),r<0&&(r+=i),r=e>r?0:cf(r);e<r;)t[e++]=n;return t}function Zu(t,n){var e=[];return En(t,function(r,i,f){n(r,i,f)&&e.push(r)}),e}function dt(t,n,e,r,i){var f=-1,o=t.length;for(e||(e=Ql),i||(i=[]);++f<o;){var l=t[f];n>0&&e(l)?n>1?dt(l,n-1,e,r,i):yn(i,l):r||(i[i.length]=l)}return i}var ri=xs(),Ju=xs(!0);function jt(t,n){return t&&ri(t,n,ht)}function ii(t,n){return t&&Ju(t,n,ht)}function er(t,n){return xn(n,function(e){return gn(t[e])})}function Pn(t,n){n=Cn(n,t);for(var e=0,r=n.length;t!=null&&e<r;)t=t[nn(n[e++])];return e&&e==r?t:u}function Vu(t,n,e){var r=n(t);return W(t)?r:yn(r,e(t))}function xt(t){return t==null?t===u?Uf:Bf:bn&&bn in Q(t)?$l(t):ic(t)}function ui(t,n){return t>n}function ll(t,n){return t!=null&&J.call(t,n)}function cl(t,n){return t!=null&&n in Q(t)}function hl(t,n,e){return t>=wt(n,e)&&t<lt(n,e)}function si(t,n,e){for(var r=e?Gr:Ue,i=t[0].length,f=t.length,o=f,l=g(f),h=1/0,d=[];o--;){var _=t[o];o&&n&&(_=nt(_,Mt(n))),h=wt(_.length,h),l[o]=!e&&(n||i>=120&&_.length>=120)?new Wn(o&&_):u}_=t[0];var v=-1,y=l[0];t:for(;++v<i&&d.length<h;){var A=_[v],T=n?n(A):A;if(A=e||A!==0?A:0,!(y?ge(y,T):r(d,T,e))){for(o=f;--o;){var U=l[o];if(!(U?ge(U,T):r(t[o],T,e)))continue t}y&&y.push(T),d.push(A)}}return d}function gl(t,n,e,r){return jt(t,function(i,f,o){n(r,e(i),f,o)}),r}function ye(t,n,e){n=Cn(n,t),t=Us(t,n);var r=t==null?t:t[nn(Gt(n))];return r==null?u:It(r,t,e)}function Qu(t){return it(t)&&xt(t)==Kn}function pl(t){return it(t)&&xt(t)==he}function dl(t){return it(t)&&xt(t)==fe}function Re(t,n,e,r,i){return t===n?!0:t==null||n==null||!it(t)&&!it(n)?t!==t&&n!==n:_l(t,n,e,r,Re,i)}function _l(t,n,e,r,i,f){var o=W(t),l=W(n),h=o?Te:mt(t),d=l?Te:mt(n);h=h==Kn?sn:h,d=d==Kn?sn:d;var _=h==sn,v=d==sn,y=h==d;if(y&&In(t)){if(!In(n))return!1;o=!0,_=!1}if(y&&!_)return f||(f=new Zt),o||re(t)?Ts(t,n,e,r,i,f):Kl(t,n,h,e,r,i,f);if(!(e&V)){var A=_&&J.call(t,"__wrapped__"),T=v&&J.call(n,"__wrapped__");if(A||T){var U=A?t.value():t,O=T?n.value():n;return f||(f=new Zt),i(U,O,e,r,f)}}return y?(f||(f=new Zt),ql(t,n,e,r,i,f)):!1}function vl(t){return it(t)&&mt(t)==$t}function fi(t,n,e,r){var i=e.length,f=i,o=!r;if(t==null)return!f;for(t=Q(t);i--;){var l=e[i];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++i<f;){l=e[i];var h=l[0],d=t[h],_=l[1];if(o&&l[2]){if(d===u&&!(h in t))return!1}else{var v=new Zt;if(r)var y=r(d,_,h,t,n,v);if(!(y===u?Re(_,d,V|K,r,v):y))return!1}}return!0}function ku(t){if(!rt(t)||jl(t))return!1;var n=gn(t)?va:so;return n.test(Fn(t))}function wl(t){return it(t)&&xt(t)==ae}function ml(t){return it(t)&&mt(t)==Yt}function xl(t){return it(t)&&mr(t.length)&&!!tt[xt(t)]}function ju(t){return typeof t=="function"?t:t==null?Ct:typeof t=="object"?W(t)?es(t[0],t[1]):ns(t):Rf(t)}function oi(t){if(!Ae(t))return Sa(t);var n=[];for(var e in Q(t))J.call(t,e)&&e!="constructor"&&n.push(e);return n}function yl(t){if(!rt(t))return rc(t);var n=Ae(t),e=[];for(var r in t)r=="constructor"&&(n||!J.call(t,r))||e.push(r);return e}function ai(t,n){return t<n}function ts(t,n){var e=-1,r=Et(t)?g(t.length):[];return En(t,function(i,f,o){r[++e]=n(i,f,o)}),r}function ns(t){var n=Ei(t);return n.length==1&&n[0][2]?Bs(n[0][0],n[0][1]):function(e){return e===t||fi(e,t,n)}}function es(t,n){return Ci(t)&&Ws(n)?Bs(nn(t),n):function(e){var r=Pi(e,t);return r===u&&r===n?Ui(e,t):Re(n,r,V|K)}}function rr(t,n,e,r,i){t!==n&&ri(n,function(f,o){if(i||(i=new Zt),rt(f))Rl(t,n,o,e,rr,r,i);else{var l=r?r(Ii(t,o),f,o+"",t,n,i):u;l===u&&(l=f),ni(t,o,l)}},At)}function Rl(t,n,e,r,i,f,o){var l=Ii(t,e),h=Ii(n,e),d=o.get(h);if(d){ni(t,e,d);return}var _=f?f(l,h,e+"",t,n,o):u,v=_===u;if(v){var y=W(h),A=!y&&In(h),T=!y&&!A&&re(h);_=h,y||A||T?W(l)?_=l:ut(l)?_=St(l):A?(v=!1,_=ps(h,!0)):T?(v=!1,_=ds(h,!0)):_=[]:Le(h)||Nn(h)?(_=l,Nn(l)?_=hf(l):(!rt(l)||gn(l))&&(_=Ds(h))):v=!1}v&&(o.set(h,_),i(_,h,r,f,o),o.delete(h)),ni(t,e,_)}function rs(t,n){var e=t.length;if(e)return n+=n<0?e:0,hn(n,e)?t[n]:u}function is(t,n,e){n.length?n=nt(n,function(f){return W(f)?function(o){return Pn(o,f.length===1?f[0]:f)}:f}):n=[Ct];var r=-1;n=nt(n,Mt(M()));var i=ts(t,function(f,o,l){var h=nt(n,function(d){return d(f)});return{criteria:h,index:++r,value:f}});return Jo(i,function(f,o){return Bl(f,o,e)})}function Sl(t,n){return us(t,n,function(e,r){return Ui(t,r)})}function us(t,n,e){for(var r=-1,i=n.length,f={};++r<i;){var o=n[r],l=Pn(t,o);e(l,o)&&Se(f,Cn(o,t),l)}return f}function El(t){return function(n){return Pn(n,t)}}function li(t,n,e,r){var i=r?Zo:Yn,f=-1,o=n.length,l=t;for(t===n&&(n=St(n)),e&&(l=nt(t,Mt(e)));++f<o;)for(var h=0,d=n[f],_=e?e(d):d;(h=i(l,_,h,r))>-1;)l!==t&&Xe.call(l,h,1),Xe.call(t,h,1);return t}function ss(t,n){for(var e=t?n.length:0,r=e-1;e--;){var i=n[e];if(e==r||i!==f){var f=i;hn(i)?Xe.call(t,i,1):pi(t,i)}}return t}function ci(t,n){return t+Ve(zu()*(n-t+1))}function Al(t,n,e,r){for(var i=-1,f=lt(Je((n-t)/(e||1)),0),o=g(f);f--;)o[r?f:++i]=t,t+=e;return o}function hi(t,n){var e="";if(!t||n<1||n>mn)return e;do n%2&&(e+=t),n=Ve(n/2),n&&(t+=t);while(n);return e}function N(t,n){return Mi(Ps(t,n,Ct),t+"")}function Cl(t){return Ku(ie(t))}function Ll(t,n){var e=ie(t);return gr(e,Bn(n,0,e.length))}function Se(t,n,e,r){if(!rt(t))return t;n=Cn(n,t);for(var i=-1,f=n.length,o=f-1,l=t;l!=null&&++i<f;){var h=nn(n[i]),d=e;if(h==="__proto__"||h==="constructor"||h==="prototype")return t;if(i!=o){var _=l[h];d=r?r(_,h,l):u,d===u&&(d=rt(_)?_:hn(n[i+1])?[]:{})}me(l,h,d),l=l[h]}return t}var fs=Qe?function(t,n){return Qe.set(t,n),t}:Ct,Il=Ze?function(t,n){return Ze(t,"toString",{configurable:!0,enumerable:!1,value:Ni(n),writable:!0})}:Ct;function Ml(t){return gr(ie(t))}function Ht(t,n,e){var r=-1,i=t.length;n<0&&(n=-n>i?0:i+n),e=e>i?i:e,e<0&&(e+=i),i=n>e?0:e-n>>>0,n>>>=0;for(var f=g(i);++r<i;)f[r]=t[r+n];return f}function Tl(t,n){var e;return En(t,function(r,i,f){return e=n(r,i,f),!e}),!!e}function ir(t,n,e){var r=0,i=t==null?r:t.length;if(typeof n=="number"&&n===n&&i<=Of){for(;r<i;){var f=r+i>>>1,o=t[f];o!==null&&!Ot(o)&&(e?o<=n:o<n)?r=f+1:i=f}return i}return gi(t,n,Ct,e)}function gi(t,n,e,r){var i=0,f=t==null?0:t.length;if(f===0)return 0;n=e(n);for(var o=n!==n,l=n===null,h=Ot(n),d=n===u;i<f;){var _=Ve((i+f)/2),v=e(t[_]),y=v!==u,A=v===null,T=v===v,U=Ot(v);if(o)var O=r||T;else d?O=T&&(r||y):l?O=T&&y&&(r||!A):h?O=T&&y&&!A&&(r||!U):A||U?O=!1:O=r?v<=n:v<n;O?i=_+1:f=_}return wt(f,Tf)}function os(t,n){for(var e=-1,r=t.length,i=0,f=[];++e<r;){var o=t[e],l=n?n(o):o;if(!e||!Jt(l,h)){var h=l;f[i++]=o===0?0:o}}return f}function as(t){return typeof t=="number"?t:Ot(t)?Me:+t}function Tt(t){if(typeof t=="string")return t;if(W(t))return nt(t,Tt)+"";if(Ot(t))return Hu?Hu.call(t):"";var n=t+"";return n=="0"&&1/t==-ot?"-0":n}function An(t,n,e){var r=-1,i=Ue,f=t.length,o=!0,l=[],h=l;if(e)o=!1,i=Gr;else if(f>=w){var d=n?null:Hl(t);if(d)return Ne(d);o=!1,i=ge,h=new Wn}else h=n?[]:l;t:for(;++r<f;){var _=t[r],v=n?n(_):_;if(_=e||_!==0?_:0,o&&v===v){for(var y=h.length;y--;)if(h[y]===v)continue t;n&&h.push(v),l.push(_)}else i(h,v,e)||(h!==l&&h.push(v),l.push(_))}return l}function pi(t,n){return n=Cn(n,t),t=Us(t,n),t==null||delete t[nn(Gt(n))]}function ls(t,n,e,r){return Se(t,n,e(Pn(t,n)),r)}function ur(t,n,e,r){for(var i=t.length,f=r?i:-1;(r?f--:++f<i)&&n(t[f],f,t););return e?Ht(t,r?0:f,r?f+1:i):Ht(t,r?f+1:0,r?i:f)}function cs(t,n){var e=t;return e instanceof G&&(e=e.value()),Kr(n,function(r,i){return i.func.apply(i.thisArg,yn([r],i.args))},e)}function di(t,n,e){var r=t.length;if(r<2)return r?An(t[0]):[];for(var i=-1,f=g(r);++i<r;)for(var o=t[i],l=-1;++l<r;)l!=i&&(f[i]=xe(f[i]||o,t[l],n,e));return An(dt(f,1),n,e)}function hs(t,n,e){for(var r=-1,i=t.length,f=n.length,o={};++r<i;){var l=r<f?n[r]:u;e(o,t[r],l)}return o}function _i(t){return ut(t)?t:[]}function vi(t){return typeof t=="function"?t:Ct}function Cn(t,n){return W(t)?t:Ci(t,n)?[t]:Hs(Z(t))}var Ol=N;function Ln(t,n,e){var r=t.length;return e=e===u?r:e,!n&&e>=r?t:Ht(t,n,e)}var gs=wa||function(t){return pt.clearTimeout(t)};function ps(t,n){if(n)return t.slice();var e=t.length,r=Bu?Bu(e):new t.constructor(e);return t.copy(r),r}function wi(t){var n=new t.constructor(t.byteLength);return new $e(n).set(new $e(t)),n}function bl(t,n){var e=n?wi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function Dl(t){var n=new t.constructor(t.source,Qi.exec(t));return n.lastIndex=t.lastIndex,n}function Wl(t){return we?Q(we.call(t)):{}}function ds(t,n){var e=n?wi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function _s(t,n){if(t!==n){var e=t!==u,r=t===null,i=t===t,f=Ot(t),o=n!==u,l=n===null,h=n===n,d=Ot(n);if(!l&&!d&&!f&&t>n||f&&o&&h&&!l&&!d||r&&o&&h||!e&&h||!i)return 1;if(!r&&!f&&!d&&t<n||d&&e&&i&&!r&&!f||l&&e&&i||!o&&i||!h)return-1}return 0}function Bl(t,n,e){for(var r=-1,i=t.criteria,f=n.criteria,o=i.length,l=e.length;++r<o;){var h=_s(i[r],f[r]);if(h){if(r>=l)return h;var d=e[r];return h*(d=="desc"?-1:1)}}return t.index-n.index}function vs(t,n,e,r){for(var i=-1,f=t.length,o=e.length,l=-1,h=n.length,d=lt(f-o,0),_=g(h+d),v=!r;++l<h;)_[l]=n[l];for(;++i<o;)(v||i<f)&&(_[e[i]]=t[i]);for(;d--;)_[l++]=t[i++];return _}function ws(t,n,e,r){for(var i=-1,f=t.length,o=-1,l=e.length,h=-1,d=n.length,_=lt(f-l,0),v=g(_+d),y=!r;++i<_;)v[i]=t[i];for(var A=i;++h<d;)v[A+h]=n[h];for(;++o<l;)(y||i<f)&&(v[A+e[o]]=t[i++]);return v}function St(t,n){var e=-1,r=t.length;for(n||(n=g(r));++e<r;)n[e]=t[e];return n}function tn(t,n,e,r){var i=!e;e||(e={});for(var f=-1,o=n.length;++f<o;){var l=n[f],h=r?r(e[l],t[l],l,e,t):u;h===u&&(h=t[l]),i?an(e,l,h):me(e,l,h)}return e}function Pl(t,n){return tn(t,Ai(t),n)}function Ul(t,n){return tn(t,Os(t),n)}function sr(t,n){return function(e,r){var i=W(e)?Go:ul,f=n?n():{};return i(e,t,M(r,2),f)}}function te(t){return N(function(n,e){var r=-1,i=e.length,f=i>1?e[i-1]:u,o=i>2?e[2]:u;for(f=t.length>3&&typeof f=="function"?(i--,f):u,o&&yt(e[0],e[1],o)&&(f=i<3?u:f,i=1),n=Q(n);++r<i;){var l=e[r];l&&t(n,l,r,f)}return n})}function ms(t,n){return function(e,r){if(e==null)return e;if(!Et(e))return t(e,r);for(var i=e.length,f=n?i:-1,o=Q(e);(n?f--:++f<i)&&r(o[f],f,o)!==!1;);return e}}function xs(t){return function(n,e,r){for(var i=-1,f=Q(n),o=r(n),l=o.length;l--;){var h=o[t?l:++i];if(e(f[h],h,f)===!1)break}return n}}function Fl(t,n,e){var r=n&P,i=Ee(t);function f(){var o=this&&this!==pt&&this instanceof f?i:t;return o.apply(r?e:this,arguments)}return f}function ys(t){return function(n){n=Z(n);var e=Xn(n)?Xt(n):u,r=e?e[0]:n.charAt(0),i=e?Ln(e,1).join(""):n.slice(1);return r[t]()+i}}function ne(t){return function(n){return Kr(xf(mf(n).replace(Io,"")),t,"")}}function Ee(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=jn(t.prototype),r=t.apply(e,n);return rt(r)?r:e}}function Nl(t,n,e){var r=Ee(t);function i(){for(var f=arguments.length,o=g(f),l=f,h=ee(i);l--;)o[l]=arguments[l];var d=f<3&&o[0]!==h&&o[f-1]!==h?[]:Rn(o,h);if(f-=d.length,f<e)return Cs(t,n,fr,i.placeholder,u,o,d,u,u,e-f);var _=this&&this!==pt&&this instanceof i?r:t;return It(_,this,o)}return i}function Rs(t){return function(n,e,r){var i=Q(n);if(!Et(n)){var f=M(e,3);n=ht(n),e=function(l){return f(i[l],l,i)}}var o=t(n,e,r);return o>-1?i[f?n[o]:o]:u}}function Ss(t){return cn(function(n){var e=n.length,r=e,i=Nt.prototype.thru;for(t&&n.reverse();r--;){var f=n[r];if(typeof f!="function")throw new Ft(L);if(i&&!o&&cr(f)=="wrapper")var o=new Nt([],!0)}for(r=o?r:e;++r<e;){f=n[r];var l=cr(f),h=l=="wrapper"?Si(f):u;h&&Li(h[0])&&h[1]==(qt|Wt|Bt|Mn)&&!h[4].length&&h[9]==1?o=o[cr(h[0])].apply(o,h[3]):o=f.length==1&&Li(f)?o[l]():o.thru(f)}return function(){var d=arguments,_=d[0];if(o&&d.length==1&&W(_))return o.plant(_).value();for(var v=0,y=e?n[v].apply(this,d):_;++v<e;)y=n[v].call(this,y);return y}})}function fr(t,n,e,r,i,f,o,l,h,d){var _=n&qt,v=n&P,y=n&et,A=n&(Wt|wn),T=n&Gn,U=y?u:Ee(t);function O(){for(var z=arguments.length,q=g(z),bt=z;bt--;)q[bt]=arguments[bt];if(A)var Rt=ee(O),Dt=Qo(q,Rt);if(r&&(q=vs(q,r,i,A)),f&&(q=ws(q,f,o,A)),z-=Dt,A&&z<d){var st=Rn(q,Rt);return Cs(t,n,fr,O.placeholder,e,q,st,l,h,d-z)}var Vt=v?e:this,dn=y?Vt[t]:t;return z=q.length,l?q=uc(q,l):T&&z>1&&q.reverse(),_&&h<z&&(q.length=h),this&&this!==pt&&this instanceof O&&(dn=U||Ee(dn)),dn.apply(Vt,q)}return O}function Es(t,n){return function(e,r){return gl(e,t,n(r),{})}}function or(t,n){return function(e,r){var i;if(e===u&&r===u)return n;if(e!==u&&(i=e),r!==u){if(i===u)return r;typeof e=="string"||typeof r=="string"?(e=Tt(e),r=Tt(r)):(e=as(e),r=as(r)),i=t(e,r)}return i}}function mi(t){return cn(function(n){return n=nt(n,Mt(M())),N(function(e){var r=this;return t(n,function(i){return It(i,r,e)})})})}function ar(t,n){n=n===u?" ":Tt(n);var e=n.length;if(e<2)return e?hi(n,t):n;var r=hi(n,Je(t/Zn(n)));return Xn(n)?Ln(Xt(r),0,t).join(""):r.slice(0,t)}function zl(t,n,e,r){var i=n&P,f=Ee(t);function o(){for(var l=-1,h=arguments.length,d=-1,_=r.length,v=g(_+h),y=this&&this!==pt&&this instanceof o?f:t;++d<_;)v[d]=r[d];for(;h--;)v[d++]=arguments[++l];return It(y,i?e:this,v)}return o}function As(t){return function(n,e,r){return r&&typeof r!="number"&&yt(n,e,r)&&(e=r=u),n=pn(n),e===u?(e=n,n=0):e=pn(e),r=r===u?n<e?1:-1:pn(r),Al(n,e,r,t)}}function lr(t){return function(n,e){return typeof n=="string"&&typeof e=="string"||(n=Kt(n),e=Kt(e)),t(n,e)}}function Cs(t,n,e,r,i,f,o,l,h,d){var _=n&Wt,v=_?o:u,y=_?u:o,A=_?f:u,T=_?u:f;n|=_?Bt:un,n&=~(_?un:Bt),n&vn||(n&=~(P|et));var U=[t,n,i,A,v,T,y,l,h,d],O=e.apply(u,U);return Li(t)&&Fs(O,U),O.placeholder=r,Ns(O,t,n)}function xi(t){var n=at[t];return function(e,r){if(e=Kt(e),r=r==null?0:wt(B(r),292),r&&Nu(e)){var i=(Z(e)+"e").split("e"),f=n(i[0]+"e"+(+i[1]+r));return i=(Z(f)+"e").split("e"),+(i[0]+"e"+(+i[1]-r))}return n(e)}}var Hl=Qn&&1/Ne(new Qn([,-0]))[1]==ot?function(t){return new Qn(t)}:Gi;function Ls(t){return function(n){var e=mt(n);return e==$t?Vr(n):e==Yt?ia(n):Vo(n,t(n))}}function ln(t,n,e,r,i,f,o,l){var h=n&et;if(!h&&typeof t!="function")throw new Ft(L);var d=r?r.length:0;if(d||(n&=~(Bt|un),r=i=u),o=o===u?o:lt(B(o),0),l=l===u?l:B(l),d-=i?i.length:0,n&un){var _=r,v=i;r=i=u}var y=h?u:Si(t),A=[t,n,e,r,i,_,v,f,o,l];if(y&&ec(A,y),t=A[0],n=A[1],e=A[2],r=A[3],i=A[4],l=A[9]=A[9]===u?h?0:t.length:lt(A[9]-d,0),!l&&n&(Wt|wn)&&(n&=~(Wt|wn)),!n||n==P)var T=Fl(t,n,e);else n==Wt||n==wn?T=Nl(t,n,l):(n==Bt||n==(P|Bt))&&!i.length?T=zl(t,n,e,r):T=fr.apply(u,A);var U=y?fs:Fs;return Ns(U(T,A),t,n)}function Is(t,n,e,r){return t===u||Jt(t,Vn[e])&&!J.call(r,e)?n:t}function Ms(t,n,e,r,i,f){return rt(t)&&rt(n)&&(f.set(n,t),rr(t,n,u,Ms,f),f.delete(n)),t}function Gl(t){return Le(t)?u:t}function Ts(t,n,e,r,i,f){var o=e&V,l=t.length,h=n.length;if(l!=h&&!(o&&h>l))return!1;var d=f.get(t),_=f.get(n);if(d&&_)return d==n&&_==t;var v=-1,y=!0,A=e&K?new Wn:u;for(f.set(t,n),f.set(n,t);++v<l;){var T=t[v],U=n[v];if(r)var O=o?r(U,T,v,n,t,f):r(T,U,v,t,n,f);if(O!==u){if(O)continue;y=!1;break}if(A){if(!qr(n,function(z,q){if(!ge(A,q)&&(T===z||i(T,z,e,r,f)))return A.push(q)})){y=!1;break}}else if(!(T===U||i(T,U,e,r,f))){y=!1;break}}return f.delete(t),f.delete(n),y}function Kl(t,n,e,r,i,f,o){switch(e){case qn:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case he:return!(t.byteLength!=n.byteLength||!f(new $e(t),new $e(n)));case se:case fe:case oe:return Jt(+t,+n);case Oe:return t.name==n.name&&t.message==n.message;case ae:case le:return t==n+"";case $t:var l=Vr;case Yt:var h=r&V;if(l||(l=Ne),t.size!=n.size&&!h)return!1;var d=o.get(t);if(d)return d==n;r|=K,o.set(t,n);var _=Ts(l(t),l(n),r,i,f,o);return o.delete(t),_;case De:if(we)return we.call(t)==we.call(n)}return!1}function ql(t,n,e,r,i,f){var o=e&V,l=yi(t),h=l.length,d=yi(n),_=d.length;if(h!=_&&!o)return!1;for(var v=h;v--;){var y=l[v];if(!(o?y in n:J.call(n,y)))return!1}var A=f.get(t),T=f.get(n);if(A&&T)return A==n&&T==t;var U=!0;f.set(t,n),f.set(n,t);for(var O=o;++v<h;){y=l[v];var z=t[y],q=n[y];if(r)var bt=o?r(q,z,y,n,t,f):r(z,q,y,t,n,f);if(!(bt===u?z===q||i(z,q,e,r,f):bt)){U=!1;break}O||(O=y=="constructor")}if(U&&!O){var Rt=t.constructor,Dt=n.constructor;Rt!=Dt&&"constructor"in t&&"constructor"in n&&!(typeof Rt=="function"&&Rt instanceof Rt&&typeof Dt=="function"&&Dt instanceof Dt)&&(U=!1)}return f.delete(t),f.delete(n),U}function cn(t){return Mi(Ps(t,u,$s),t+"")}function yi(t){return Vu(t,ht,Ai)}function Ri(t){return Vu(t,At,Os)}var Si=Qe?function(t){return Qe.get(t)}:Gi;function cr(t){for(var n=t.name+"",e=kn[n],r=J.call(kn,n)?e.length:0;r--;){var i=e[r],f=i.func;if(f==null||f==t)return i.name}return n}function ee(t){var n=J.call(s,"placeholder")?s:t;return n.placeholder}function M(){var t=s.iteratee||zi;return t=t===zi?ju:t,arguments.length?t(arguments[0],arguments[1]):t}function hr(t,n){var e=t.__data__;return kl(n)?e[typeof n=="string"?"string":"hash"]:e.map}function Ei(t){for(var n=ht(t),e=n.length;e--;){var r=n[e],i=t[r];n[e]=[r,i,Ws(i)]}return n}function Un(t,n){var e=na(t,n);return ku(e)?e:u}function $l(t){var n=J.call(t,bn),e=t[bn];try{t[bn]=u;var r=!0}catch{}var i=Ke.call(t);return r&&(n?t[bn]=e:delete t[bn]),i}var Ai=kr?function(t){return t==null?[]:(t=Q(t),xn(kr(t),function(n){return Uu.call(t,n)}))}:Ki,Os=kr?function(t){for(var n=[];t;)yn(n,Ai(t)),t=Ye(t);return n}:Ki,mt=xt;(jr&&mt(new jr(new ArrayBuffer(1)))!=qn||de&&mt(new de)!=$t||ti&&mt(ti.resolve())!=Xi||Qn&&mt(new Qn)!=Yt||_e&&mt(new _e)!=ce)&&(mt=function(t){var n=xt(t),e=n==sn?t.constructor:u,r=e?Fn(e):"";if(r)switch(r){case La:return qn;case Ia:return $t;case Ma:return Xi;case Ta:return Yt;case Oa:return ce}return n});function Yl(t,n,e){for(var r=-1,i=e.length;++r<i;){var f=e[r],o=f.size;switch(f.type){case"drop":t+=o;break;case"dropRight":n-=o;break;case"take":n=wt(n,t+o);break;case"takeRight":t=lt(t,n-o);break}}return{start:t,end:n}}function Xl(t){var n=t.match(kf);return n?n[1].split(jf):[]}function bs(t,n,e){n=Cn(n,t);for(var r=-1,i=n.length,f=!1;++r<i;){var o=nn(n[r]);if(!(f=t!=null&&e(t,o)))break;t=t[o]}return f||++r!=i?f:(i=t==null?0:t.length,!!i&&mr(i)&&hn(o,i)&&(W(t)||Nn(t)))}function Zl(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&J.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function Ds(t){return typeof t.constructor=="function"&&!Ae(t)?jn(Ye(t)):{}}function Jl(t,n,e){var r=t.constructor;switch(n){case he:return wi(t);case se:case fe:return new r(+t);case qn:return bl(t,e);case Er:case Ar:case Cr:case Lr:case Ir:case Mr:case Tr:case Or:case br:return ds(t,e);case $t:return new r;case oe:case le:return new r(t);case ae:return Dl(t);case Yt:return new r;case De:return Wl(t)}}function Vl(t,n){var e=n.length;if(!e)return t;var r=e-1;return n[r]=(e>1?"& ":"")+n[r],n=n.join(e>2?", ":" "),t.replace(Qf,`{
/* [wrapped with `+n+`] */
`)}function Ql(t){return W(t)||Nn(t)||!!(Fu&&t&&t[Fu])}function hn(t,n){var e=typeof t;return n=n??mn,!!n&&(e=="number"||e!="symbol"&&oo.test(t))&&t>-1&&t%1==0&&t<n}function yt(t,n,e){if(!rt(e))return!1;var r=typeof n;return(r=="number"?Et(e)&&hn(n,e.length):r=="string"&&n in e)?Jt(e[n],t):!1}function Ci(t,n){if(W(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||Ot(t)?!0:Xf.test(t)||!Yf.test(t)||n!=null&&t in Q(n)}function kl(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Li(t){var n=cr(t),e=s[n];if(typeof e!="function"||!(n in G.prototype))return!1;if(t===e)return!0;var r=Si(e);return!!r&&t===r[0]}function jl(t){return!!Wu&&Wu in t}var tc=He?gn:qi;function Ae(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||Vn;return t===e}function Ws(t){return t===t&&!rt(t)}function Bs(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==u||t in Q(e))}}function nc(t){var n=vr(t,function(r){return e.size===H&&e.clear(),r}),e=n.cache;return n}function ec(t,n){var e=t[1],r=n[1],i=e|r,f=i<(P|et|qt),o=r==qt&&e==Wt||r==qt&&e==Mn&&t[7].length<=n[8]||r==(qt|Mn)&&n[7].length<=n[8]&&e==Wt;if(!(f||o))return t;r&P&&(t[2]=n[2],i|=e&P?0:vn);var l=n[3];if(l){var h=t[3];t[3]=h?vs(h,l,n[4]):l,t[4]=h?Rn(t[3],F):n[4]}return l=n[5],l&&(h=t[5],t[5]=h?ws(h,l,n[6]):l,t[6]=h?Rn(t[5],F):n[6]),l=n[7],l&&(t[7]=l),r&qt&&(t[8]=t[8]==null?n[8]:wt(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=i,t}function rc(t){var n=[];if(t!=null)for(var e in Q(t))n.push(e);return n}function ic(t){return Ke.call(t)}function Ps(t,n,e){return n=lt(n===u?t.length-1:n,0),function(){for(var r=arguments,i=-1,f=lt(r.length-n,0),o=g(f);++i<f;)o[i]=r[n+i];i=-1;for(var l=g(n+1);++i<n;)l[i]=r[i];return l[n]=e(o),It(t,this,l)}}function Us(t,n){return n.length<2?t:Pn(t,Ht(n,0,-1))}function uc(t,n){for(var e=t.length,r=wt(n.length,e),i=St(t);r--;){var f=n[r];t[r]=hn(f,e)?i[f]:u}return t}function Ii(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var Fs=zs(fs),Ce=xa||function(t,n){return pt.setTimeout(t,n)},Mi=zs(Il);function Ns(t,n,e){var r=n+"";return Mi(t,Vl(r,sc(Xl(r),e)))}function zs(t){var n=0,e=0;return function(){var r=Ea(),i=_t-(r-e);if(e=r,i>0){if(++n>=$)return arguments[0]}else n=0;return t.apply(u,arguments)}}function gr(t,n){var e=-1,r=t.length,i=r-1;for(n=n===u?r:n;++e<n;){var f=ci(e,i),o=t[f];t[f]=t[e],t[e]=o}return t.length=n,t}var Hs=nc(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(Zf,function(e,r,i,f){n.push(i?f.replace(eo,"$1"):r||e)}),n});function nn(t){if(typeof t=="string"||Ot(t))return t;var n=t+"";return n=="0"&&1/t==-ot?"-0":n}function Fn(t){if(t!=null){try{return Ge.call(t)}catch{}try{return t+""}catch{}}return""}function sc(t,n){return Ut(bf,function(e){var r="_."+e[0];n&e[1]&&!Ue(t,r)&&t.push(r)}),t.sort()}function Gs(t){if(t instanceof G)return t.clone();var n=new Nt(t.__wrapped__,t.__chain__);return n.__actions__=St(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function fc(t,n,e){(e?yt(t,n,e):n===u)?n=1:n=lt(B(n),0);var r=t==null?0:t.length;if(!r||n<1)return[];for(var i=0,f=0,o=g(Je(r/n));i<r;)o[f++]=Ht(t,i,i+=n);return o}function oc(t){for(var n=-1,e=t==null?0:t.length,r=0,i=[];++n<e;){var f=t[n];f&&(i[r++]=f)}return i}function ac(){var t=arguments.length;if(!t)return[];for(var n=g(t-1),e=arguments[0],r=t;r--;)n[r-1]=arguments[r];return yn(W(e)?St(e):[e],dt(n,1))}var lc=N(function(t,n){return ut(t)?xe(t,dt(n,1,ut,!0)):[]}),cc=N(function(t,n){var e=Gt(n);return ut(e)&&(e=u),ut(t)?xe(t,dt(n,1,ut,!0),M(e,2)):[]}),hc=N(function(t,n){var e=Gt(n);return ut(e)&&(e=u),ut(t)?xe(t,dt(n,1,ut,!0),u,e):[]});function gc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===u?1:B(n),Ht(t,n<0?0:n,r)):[]}function pc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===u?1:B(n),n=r-n,Ht(t,0,n<0?0:n)):[]}function dc(t,n){return t&&t.length?ur(t,M(n,3),!0,!0):[]}function _c(t,n){return t&&t.length?ur(t,M(n,3),!0):[]}function vc(t,n,e,r){var i=t==null?0:t.length;return i?(e&&typeof e!="number"&&yt(t,n,e)&&(e=0,r=i),al(t,n,e,r)):[]}function Ks(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var i=e==null?0:B(e);return i<0&&(i=lt(r+i,0)),Fe(t,M(n,3),i)}function qs(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var i=r-1;return e!==u&&(i=B(e),i=e<0?lt(r+i,0):wt(i,r-1)),Fe(t,M(n,3),i,!0)}function $s(t){var n=t==null?0:t.length;return n?dt(t,1):[]}function wc(t){var n=t==null?0:t.length;return n?dt(t,ot):[]}function mc(t,n){var e=t==null?0:t.length;return e?(n=n===u?1:B(n),dt(t,n)):[]}function xc(t){for(var n=-1,e=t==null?0:t.length,r={};++n<e;){var i=t[n];r[i[0]]=i[1]}return r}function Ys(t){return t&&t.length?t[0]:u}function yc(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var i=e==null?0:B(e);return i<0&&(i=lt(r+i,0)),Yn(t,n,i)}function Rc(t){var n=t==null?0:t.length;return n?Ht(t,0,-1):[]}var Sc=N(function(t){var n=nt(t,_i);return n.length&&n[0]===t[0]?si(n):[]}),Ec=N(function(t){var n=Gt(t),e=nt(t,_i);return n===Gt(e)?n=u:e.pop(),e.length&&e[0]===t[0]?si(e,M(n,2)):[]}),Ac=N(function(t){var n=Gt(t),e=nt(t,_i);return n=typeof n=="function"?n:u,n&&e.pop(),e.length&&e[0]===t[0]?si(e,u,n):[]});function Cc(t,n){return t==null?"":Ra.call(t,n)}function Gt(t){var n=t==null?0:t.length;return n?t[n-1]:u}function Lc(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var i=r;return e!==u&&(i=B(e),i=i<0?lt(r+i,0):wt(i,r-1)),n===n?sa(t,n,i):Fe(t,Cu,i,!0)}function Ic(t,n){return t&&t.length?rs(t,B(n)):u}var Mc=N(Xs);function Xs(t,n){return t&&t.length&&n&&n.length?li(t,n):t}function Tc(t,n,e){return t&&t.length&&n&&n.length?li(t,n,M(e,2)):t}function Oc(t,n,e){return t&&t.length&&n&&n.length?li(t,n,u,e):t}var bc=cn(function(t,n){var e=t==null?0:t.length,r=ei(t,n);return ss(t,nt(n,function(i){return hn(i,e)?+i:i}).sort(_s)),r});function Dc(t,n){var e=[];if(!(t&&t.length))return e;var r=-1,i=[],f=t.length;for(n=M(n,3);++r<f;){var o=t[r];n(o,r,t)&&(e.push(o),i.push(r))}return ss(t,i),e}function Ti(t){return t==null?t:Ca.call(t)}function Wc(t,n,e){var r=t==null?0:t.length;return r?(e&&typeof e!="number"&&yt(t,n,e)?(n=0,e=r):(n=n==null?0:B(n),e=e===u?r:B(e)),Ht(t,n,e)):[]}function Bc(t,n){return ir(t,n)}function Pc(t,n,e){return gi(t,n,M(e,2))}function Uc(t,n){var e=t==null?0:t.length;if(e){var r=ir(t,n);if(r<e&&Jt(t[r],n))return r}return-1}function Fc(t,n){return ir(t,n,!0)}function Nc(t,n,e){return gi(t,n,M(e,2),!0)}function zc(t,n){var e=t==null?0:t.length;if(e){var r=ir(t,n,!0)-1;if(Jt(t[r],n))return r}return-1}function Hc(t){return t&&t.length?os(t):[]}function Gc(t,n){return t&&t.length?os(t,M(n,2)):[]}function Kc(t){var n=t==null?0:t.length;return n?Ht(t,1,n):[]}function qc(t,n,e){return t&&t.length?(n=e||n===u?1:B(n),Ht(t,0,n<0?0:n)):[]}function $c(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===u?1:B(n),n=r-n,Ht(t,n<0?0:n,r)):[]}function Yc(t,n){return t&&t.length?ur(t,M(n,3),!1,!0):[]}function Xc(t,n){return t&&t.length?ur(t,M(n,3)):[]}var Zc=N(function(t){return An(dt(t,1,ut,!0))}),Jc=N(function(t){var n=Gt(t);return ut(n)&&(n=u),An(dt(t,1,ut,!0),M(n,2))}),Vc=N(function(t){var n=Gt(t);return n=typeof n=="function"?n:u,An(dt(t,1,ut,!0),u,n)});function Qc(t){return t&&t.length?An(t):[]}function kc(t,n){return t&&t.length?An(t,M(n,2)):[]}function jc(t,n){return n=typeof n=="function"?n:u,t&&t.length?An(t,u,n):[]}function Oi(t){if(!(t&&t.length))return[];var n=0;return t=xn(t,function(e){if(ut(e))return n=lt(e.length,n),!0}),Zr(n,function(e){return nt(t,$r(e))})}function Zs(t,n){if(!(t&&t.length))return[];var e=Oi(t);return n==null?e:nt(e,function(r){return It(n,u,r)})}var th=N(function(t,n){return ut(t)?xe(t,n):[]}),nh=N(function(t){return di(xn(t,ut))}),eh=N(function(t){var n=Gt(t);return ut(n)&&(n=u),di(xn(t,ut),M(n,2))}),rh=N(function(t){var n=Gt(t);return n=typeof n=="function"?n:u,di(xn(t,ut),u,n)}),ih=N(Oi);function uh(t,n){return hs(t||[],n||[],me)}function sh(t,n){return hs(t||[],n||[],Se)}var fh=N(function(t){var n=t.length,e=n>1?t[n-1]:u;return e=typeof e=="function"?(t.pop(),e):u,Zs(t,e)});function Js(t){var n=s(t);return n.__chain__=!0,n}function oh(t,n){return n(t),t}function pr(t,n){return n(t)}var ah=cn(function(t){var n=t.length,e=n?t[0]:0,r=this.__wrapped__,i=function(f){return ei(f,t)};return n>1||this.__actions__.length||!(r instanceof G)||!hn(e)?this.thru(i):(r=r.slice(e,+e+(n?1:0)),r.__actions__.push({func:pr,args:[i],thisArg:u}),new Nt(r,this.__chain__).thru(function(f){return n&&!f.length&&f.push(u),f}))});function lh(){return Js(this)}function ch(){return new Nt(this.value(),this.__chain__)}function hh(){this.__values__===u&&(this.__values__=lf(this.value()));var t=this.__index__>=this.__values__.length,n=t?u:this.__values__[this.__index__++];return{done:t,value:n}}function gh(){return this}function ph(t){for(var n,e=this;e instanceof je;){var r=Gs(e);r.__index__=0,r.__values__=u,n?i.__wrapped__=r:n=r;var i=r;e=e.__wrapped__}return i.__wrapped__=t,n}function dh(){var t=this.__wrapped__;if(t instanceof G){var n=t;return this.__actions__.length&&(n=new G(this)),n=n.reverse(),n.__actions__.push({func:pr,args:[Ti],thisArg:u}),new Nt(n,this.__chain__)}return this.thru(Ti)}function _h(){return cs(this.__wrapped__,this.__actions__)}var vh=sr(function(t,n,e){J.call(t,e)?++t[e]:an(t,e,1)});function wh(t,n,e){var r=W(t)?Eu:ol;return e&&yt(t,n,e)&&(n=u),r(t,M(n,3))}function mh(t,n){var e=W(t)?xn:Zu;return e(t,M(n,3))}var xh=Rs(Ks),yh=Rs(qs);function Rh(t,n){return dt(dr(t,n),1)}function Sh(t,n){return dt(dr(t,n),ot)}function Eh(t,n,e){return e=e===u?1:B(e),dt(dr(t,n),e)}function Vs(t,n){var e=W(t)?Ut:En;return e(t,M(n,3))}function Qs(t,n){var e=W(t)?Ko:Xu;return e(t,M(n,3))}var Ah=sr(function(t,n,e){J.call(t,e)?t[e].push(n):an(t,e,[n])});function Ch(t,n,e,r){t=Et(t)?t:ie(t),e=e&&!r?B(e):0;var i=t.length;return e<0&&(e=lt(i+e,0)),xr(t)?e<=i&&t.indexOf(n,e)>-1:!!i&&Yn(t,n,e)>-1}var Lh=N(function(t,n,e){var r=-1,i=typeof n=="function",f=Et(t)?g(t.length):[];return En(t,function(o){f[++r]=i?It(n,o,e):ye(o,n,e)}),f}),Ih=sr(function(t,n,e){an(t,e,n)});function dr(t,n){var e=W(t)?nt:ts;return e(t,M(n,3))}function Mh(t,n,e,r){return t==null?[]:(W(n)||(n=n==null?[]:[n]),e=r?u:e,W(e)||(e=e==null?[]:[e]),is(t,n,e))}var Th=sr(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]});function Oh(t,n,e){var r=W(t)?Kr:Iu,i=arguments.length<3;return r(t,M(n,4),e,i,En)}function bh(t,n,e){var r=W(t)?qo:Iu,i=arguments.length<3;return r(t,M(n,4),e,i,Xu)}function Dh(t,n){var e=W(t)?xn:Zu;return e(t,wr(M(n,3)))}function Wh(t){var n=W(t)?Ku:Cl;return n(t)}function Bh(t,n,e){(e?yt(t,n,e):n===u)?n=1:n=B(n);var r=W(t)?rl:Ll;return r(t,n)}function Ph(t){var n=W(t)?il:Ml;return n(t)}function Uh(t){if(t==null)return 0;if(Et(t))return xr(t)?Zn(t):t.length;var n=mt(t);return n==$t||n==Yt?t.size:oi(t).length}function Fh(t,n,e){var r=W(t)?qr:Tl;return e&&yt(t,n,e)&&(n=u),r(t,M(n,3))}var Nh=N(function(t,n){if(t==null)return[];var e=n.length;return e>1&&yt(t,n[0],n[1])?n=[]:e>2&&yt(n[0],n[1],n[2])&&(n=[n[0]]),is(t,dt(n,1),[])}),_r=ma||function(){return pt.Date.now()};function zh(t,n){if(typeof n!="function")throw new Ft(L);return t=B(t),function(){if(--t<1)return n.apply(this,arguments)}}function ks(t,n,e){return n=e?u:n,n=t&&n==null?t.length:n,ln(t,qt,u,u,u,u,n)}function js(t,n){var e;if(typeof n!="function")throw new Ft(L);return t=B(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=u),e}}var bi=N(function(t,n,e){var r=P;if(e.length){var i=Rn(e,ee(bi));r|=Bt}return ln(t,r,n,e,i)}),tf=N(function(t,n,e){var r=P|et;if(e.length){var i=Rn(e,ee(tf));r|=Bt}return ln(n,r,t,e,i)});function nf(t,n,e){n=e?u:n;var r=ln(t,Wt,u,u,u,u,u,n);return r.placeholder=nf.placeholder,r}function ef(t,n,e){n=e?u:n;var r=ln(t,wn,u,u,u,u,u,n);return r.placeholder=ef.placeholder,r}function rf(t,n,e){var r,i,f,o,l,h,d=0,_=!1,v=!1,y=!0;if(typeof t!="function")throw new Ft(L);n=Kt(n)||0,rt(e)&&(_=!!e.leading,v="maxWait"in e,f=v?lt(Kt(e.maxWait)||0,n):f,y="trailing"in e?!!e.trailing:y);function A(st){var Vt=r,dn=i;return r=i=u,d=st,o=t.apply(dn,Vt),o}function T(st){return d=st,l=Ce(z,n),_?A(st):o}function U(st){var Vt=st-h,dn=st-d,Sf=n-Vt;return v?wt(Sf,f-dn):Sf}function O(st){var Vt=st-h,dn=st-d;return h===u||Vt>=n||Vt<0||v&&dn>=f}function z(){var st=_r();if(O(st))return q(st);l=Ce(z,U(st))}function q(st){return l=u,y&&r?A(st):(r=i=u,o)}function bt(){l!==u&&gs(l),d=0,r=h=i=l=u}function Rt(){return l===u?o:q(_r())}function Dt(){var st=_r(),Vt=O(st);if(r=arguments,i=this,h=st,Vt){if(l===u)return T(h);if(v)return gs(l),l=Ce(z,n),A(h)}return l===u&&(l=Ce(z,n)),o}return Dt.cancel=bt,Dt.flush=Rt,Dt}var Hh=N(function(t,n){return Yu(t,1,n)}),Gh=N(function(t,n,e){return Yu(t,Kt(n)||0,e)});function Kh(t){return ln(t,Gn)}function vr(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new Ft(L);var e=function(){var r=arguments,i=n?n.apply(this,r):r[0],f=e.cache;if(f.has(i))return f.get(i);var o=t.apply(this,r);return e.cache=f.set(i,o)||f,o};return e.cache=new(vr.Cache||on),e}vr.Cache=on;function wr(t){if(typeof t!="function")throw new Ft(L);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function qh(t){return js(2,t)}var $h=Ol(function(t,n){n=n.length==1&&W(n[0])?nt(n[0],Mt(M())):nt(dt(n,1),Mt(M()));var e=n.length;return N(function(r){for(var i=-1,f=wt(r.length,e);++i<f;)r[i]=n[i].call(this,r[i]);return It(t,this,r)})}),Di=N(function(t,n){var e=Rn(n,ee(Di));return ln(t,Bt,u,n,e)}),uf=N(function(t,n){var e=Rn(n,ee(uf));return ln(t,un,u,n,e)}),Yh=cn(function(t,n){return ln(t,Mn,u,u,u,n)});function Xh(t,n){if(typeof t!="function")throw new Ft(L);return n=n===u?n:B(n),N(t,n)}function Zh(t,n){if(typeof t!="function")throw new Ft(L);return n=n==null?0:lt(B(n),0),N(function(e){var r=e[n],i=Ln(e,0,n);return r&&yn(i,r),It(t,this,i)})}function Jh(t,n,e){var r=!0,i=!0;if(typeof t!="function")throw new Ft(L);return rt(e)&&(r="leading"in e?!!e.leading:r,i="trailing"in e?!!e.trailing:i),rf(t,n,{leading:r,maxWait:n,trailing:i})}function Vh(t){return ks(t,1)}function Qh(t,n){return Di(vi(n),t)}function kh(){if(!arguments.length)return[];var t=arguments[0];return W(t)?t:[t]}function jh(t){return zt(t,ft)}function tg(t,n){return n=typeof n=="function"?n:u,zt(t,ft,n)}function ng(t){return zt(t,D|ft)}function eg(t,n){return n=typeof n=="function"?n:u,zt(t,D|ft,n)}function rg(t,n){return n==null||$u(t,n,ht(n))}function Jt(t,n){return t===n||t!==t&&n!==n}var ig=lr(ui),ug=lr(function(t,n){return t>=n}),Nn=Qu(function(){return arguments}())?Qu:function(t){return it(t)&&J.call(t,"callee")&&!Uu.call(t,"callee")},W=g.isArray,sg=wu?Mt(wu):pl;function Et(t){return t!=null&&mr(t.length)&&!gn(t)}function ut(t){return it(t)&&Et(t)}function fg(t){return t===!0||t===!1||it(t)&&xt(t)==se}var In=ya||qi,og=mu?Mt(mu):dl;function ag(t){return it(t)&&t.nodeType===1&&!Le(t)}function lg(t){if(t==null)return!0;if(Et(t)&&(W(t)||typeof t=="string"||typeof t.splice=="function"||In(t)||re(t)||Nn(t)))return!t.length;var n=mt(t);if(n==$t||n==Yt)return!t.size;if(Ae(t))return!oi(t).length;for(var e in t)if(J.call(t,e))return!1;return!0}function cg(t,n){return Re(t,n)}function hg(t,n,e){e=typeof e=="function"?e:u;var r=e?e(t,n):u;return r===u?Re(t,n,u,e):!!r}function Wi(t){if(!it(t))return!1;var n=xt(t);return n==Oe||n==Wf||typeof t.message=="string"&&typeof t.name=="string"&&!Le(t)}function gg(t){return typeof t=="number"&&Nu(t)}function gn(t){if(!rt(t))return!1;var n=xt(t);return n==be||n==Yi||n==Df||n==Pf}function sf(t){return typeof t=="number"&&t==B(t)}function mr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=mn}function rt(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function it(t){return t!=null&&typeof t=="object"}var ff=xu?Mt(xu):vl;function pg(t,n){return t===n||fi(t,n,Ei(n))}function dg(t,n,e){return e=typeof e=="function"?e:u,fi(t,n,Ei(n),e)}function _g(t){return of(t)&&t!=+t}function vg(t){if(tc(t))throw new b(E);return ku(t)}function wg(t){return t===null}function mg(t){return t==null}function of(t){return typeof t=="number"||it(t)&&xt(t)==oe}function Le(t){if(!it(t)||xt(t)!=sn)return!1;var n=Ye(t);if(n===null)return!0;var e=J.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&Ge.call(e)==da}var Bi=yu?Mt(yu):wl;function xg(t){return sf(t)&&t>=-mn&&t<=mn}var af=Ru?Mt(Ru):ml;function xr(t){return typeof t=="string"||!W(t)&&it(t)&&xt(t)==le}function Ot(t){return typeof t=="symbol"||it(t)&&xt(t)==De}var re=Su?Mt(Su):xl;function yg(t){return t===u}function Rg(t){return it(t)&&mt(t)==ce}function Sg(t){return it(t)&&xt(t)==Ff}var Eg=lr(ai),Ag=lr(function(t,n){return t<=n});function lf(t){if(!t)return[];if(Et(t))return xr(t)?Xt(t):St(t);if(pe&&t[pe])return ra(t[pe]());var n=mt(t),e=n==$t?Vr:n==Yt?Ne:ie;return e(t)}function pn(t){if(!t)return t===0?t:0;if(t=Kt(t),t===ot||t===-ot){var n=t<0?-1:1;return n*Mf}return t===t?t:0}function B(t){var n=pn(t),e=n%1;return n===n?e?n-e:n:0}function cf(t){return t?Bn(B(t),0,kt):0}function Kt(t){if(typeof t=="number")return t;if(Ot(t))return Me;if(rt(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=rt(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=Mu(t);var e=uo.test(t);return e||fo.test(t)?zo(t.slice(2),e?2:8):io.test(t)?Me:+t}function hf(t){return tn(t,At(t))}function Cg(t){return t?Bn(B(t),-mn,mn):t===0?t:0}function Z(t){return t==null?"":Tt(t)}var Lg=te(function(t,n){if(Ae(n)||Et(n)){tn(n,ht(n),t);return}for(var e in n)J.call(n,e)&&me(t,e,n[e])}),gf=te(function(t,n){tn(n,At(n),t)}),yr=te(function(t,n,e,r){tn(n,At(n),t,r)}),Ig=te(function(t,n,e,r){tn(n,ht(n),t,r)}),Mg=cn(ei);function Tg(t,n){var e=jn(t);return n==null?e:qu(e,n)}var Og=N(function(t,n){t=Q(t);var e=-1,r=n.length,i=r>2?n[2]:u;for(i&&yt(n[0],n[1],i)&&(r=1);++e<r;)for(var f=n[e],o=At(f),l=-1,h=o.length;++l<h;){var d=o[l],_=t[d];(_===u||Jt(_,Vn[d])&&!J.call(t,d))&&(t[d]=f[d])}return t}),bg=N(function(t){return t.push(u,Ms),It(pf,u,t)});function Dg(t,n){return Au(t,M(n,3),jt)}function Wg(t,n){return Au(t,M(n,3),ii)}function Bg(t,n){return t==null?t:ri(t,M(n,3),At)}function Pg(t,n){return t==null?t:Ju(t,M(n,3),At)}function Ug(t,n){return t&&jt(t,M(n,3))}function Fg(t,n){return t&&ii(t,M(n,3))}function Ng(t){return t==null?[]:er(t,ht(t))}function zg(t){return t==null?[]:er(t,At(t))}function Pi(t,n,e){var r=t==null?u:Pn(t,n);return r===u?e:r}function Hg(t,n){return t!=null&&bs(t,n,ll)}function Ui(t,n){return t!=null&&bs(t,n,cl)}var Gg=Es(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=Ke.call(n)),t[n]=e},Ni(Ct)),Kg=Es(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=Ke.call(n)),J.call(t,n)?t[n].push(e):t[n]=[e]},M),qg=N(ye);function ht(t){return Et(t)?Gu(t):oi(t)}function At(t){return Et(t)?Gu(t,!0):yl(t)}function $g(t,n){var e={};return n=M(n,3),jt(t,function(r,i,f){an(e,n(r,i,f),r)}),e}function Yg(t,n){var e={};return n=M(n,3),jt(t,function(r,i,f){an(e,i,n(r,i,f))}),e}var Xg=te(function(t,n,e){rr(t,n,e)}),pf=te(function(t,n,e,r){rr(t,n,e,r)}),Zg=cn(function(t,n){var e={};if(t==null)return e;var r=!1;n=nt(n,function(f){return f=Cn(f,t),r||(r=f.length>1),f}),tn(t,Ri(t),e),r&&(e=zt(e,D|k|ft,Gl));for(var i=n.length;i--;)pi(e,n[i]);return e});function Jg(t,n){return df(t,wr(M(n)))}var Vg=cn(function(t,n){return t==null?{}:Sl(t,n)});function df(t,n){if(t==null)return{};var e=nt(Ri(t),function(r){return[r]});return n=M(n),us(t,e,function(r,i){return n(r,i[0])})}function Qg(t,n,e){n=Cn(n,t);var r=-1,i=n.length;for(i||(i=1,t=u);++r<i;){var f=t==null?u:t[nn(n[r])];f===u&&(r=i,f=e),t=gn(f)?f.call(t):f}return t}function kg(t,n,e){return t==null?t:Se(t,n,e)}function jg(t,n,e,r){return r=typeof r=="function"?r:u,t==null?t:Se(t,n,e,r)}var _f=Ls(ht),vf=Ls(At);function tp(t,n,e){var r=W(t),i=r||In(t)||re(t);if(n=M(n,4),e==null){var f=t&&t.constructor;i?e=r?new f:[]:rt(t)?e=gn(f)?jn(Ye(t)):{}:e={}}return(i?Ut:jt)(t,function(o,l,h){return n(e,o,l,h)}),e}function np(t,n){return t==null?!0:pi(t,n)}function ep(t,n,e){return t==null?t:ls(t,n,vi(e))}function rp(t,n,e,r){return r=typeof r=="function"?r:u,t==null?t:ls(t,n,vi(e),r)}function ie(t){return t==null?[]:Jr(t,ht(t))}function ip(t){return t==null?[]:Jr(t,At(t))}function up(t,n,e){return e===u&&(e=n,n=u),e!==u&&(e=Kt(e),e=e===e?e:0),n!==u&&(n=Kt(n),n=n===n?n:0),Bn(Kt(t),n,e)}function sp(t,n,e){return n=pn(n),e===u?(e=n,n=0):e=pn(e),t=Kt(t),hl(t,n,e)}function fp(t,n,e){if(e&&typeof e!="boolean"&&yt(t,n,e)&&(n=e=u),e===u&&(typeof n=="boolean"?(e=n,n=u):typeof t=="boolean"&&(e=t,t=u)),t===u&&n===u?(t=0,n=1):(t=pn(t),n===u?(n=t,t=0):n=pn(n)),t>n){var r=t;t=n,n=r}if(e||t%1||n%1){var i=zu();return wt(t+i*(n-t+No("1e-"+((i+"").length-1))),n)}return ci(t,n)}var op=ne(function(t,n,e){return n=n.toLowerCase(),t+(e?wf(n):n)});function wf(t){return Fi(Z(t).toLowerCase())}function mf(t){return t=Z(t),t&&t.replace(ao,ko).replace(Mo,"")}function ap(t,n,e){t=Z(t),n=Tt(n);var r=t.length;e=e===u?r:Bn(B(e),0,r);var i=e;return e-=n.length,e>=0&&t.slice(e,i)==n}function lp(t){return t=Z(t),t&&Kf.test(t)?t.replace(Ji,jo):t}function cp(t){return t=Z(t),t&&Jf.test(t)?t.replace(Dr,"\\$&"):t}var hp=ne(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),gp=ne(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),pp=ys("toLowerCase");function dp(t,n,e){t=Z(t),n=B(n);var r=n?Zn(t):0;if(!n||r>=n)return t;var i=(n-r)/2;return ar(Ve(i),e)+t+ar(Je(i),e)}function _p(t,n,e){t=Z(t),n=B(n);var r=n?Zn(t):0;return n&&r<n?t+ar(n-r,e):t}function vp(t,n,e){t=Z(t),n=B(n);var r=n?Zn(t):0;return n&&r<n?ar(n-r,e)+t:t}function wp(t,n,e){return e||n==null?n=0:n&&(n=+n),Aa(Z(t).replace(Wr,""),n||0)}function mp(t,n,e){return(e?yt(t,n,e):n===u)?n=1:n=B(n),hi(Z(t),n)}function xp(){var t=arguments,n=Z(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var yp=ne(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()});function Rp(t,n,e){return e&&typeof e!="number"&&yt(t,n,e)&&(n=e=u),e=e===u?kt:e>>>0,e?(t=Z(t),t&&(typeof n=="string"||n!=null&&!Bi(n))&&(n=Tt(n),!n&&Xn(t))?Ln(Xt(t),0,e):t.split(n,e)):[]}var Sp=ne(function(t,n,e){return t+(e?" ":"")+Fi(n)});function Ep(t,n,e){return t=Z(t),e=e==null?0:Bn(B(e),0,t.length),n=Tt(n),t.slice(e,e+n.length)==n}function Ap(t,n,e){var r=s.templateSettings;e&&yt(t,n,e)&&(n=u),t=Z(t),n=yr({},n,r,Is);var i=yr({},n.imports,r.imports,Is),f=ht(i),o=Jr(i,f),l,h,d=0,_=n.interpolate||We,v="__p += '",y=Qr((n.escape||We).source+"|"+_.source+"|"+(_===Vi?ro:We).source+"|"+(n.evaluate||We).source+"|$","g"),A="//# sourceURL="+(J.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Wo+"]")+`
`;t.replace(y,function(O,z,q,bt,Rt,Dt){return q||(q=bt),v+=t.slice(d,Dt).replace(lo,ta),z&&(l=!0,v+=`' +
__e(`+z+`) +
'`),Rt&&(h=!0,v+=`';
`+Rt+`;
__p += '`),q&&(v+=`' +
((__t = (`+q+`)) == null ? '' : __t) +
'`),d=Dt+O.length,O}),v+=`';
`;var T=J.call(n,"variable")&&n.variable;if(!T)v=`with (obj) {
`+v+`
}
`;else if(no.test(T))throw new b(C);v=(h?v.replace(Nf,""):v).replace(zf,"$1").replace(Hf,"$1;"),v="function("+(T||"obj")+`) {
`+(T?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(l?", __e = _.escape":"")+(h?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+v+`return __p
}`;var U=yf(function(){return Y(f,A+"return "+v).apply(u,o)});if(U.source=v,Wi(U))throw U;return U}function Cp(t){return Z(t).toLowerCase()}function Lp(t){return Z(t).toUpperCase()}function Ip(t,n,e){if(t=Z(t),t&&(e||n===u))return Mu(t);if(!t||!(n=Tt(n)))return t;var r=Xt(t),i=Xt(n),f=Tu(r,i),o=Ou(r,i)+1;return Ln(r,f,o).join("")}function Mp(t,n,e){if(t=Z(t),t&&(e||n===u))return t.slice(0,Du(t)+1);if(!t||!(n=Tt(n)))return t;var r=Xt(t),i=Ou(r,Xt(n))+1;return Ln(r,0,i).join("")}function Tp(t,n,e){if(t=Z(t),t&&(e||n===u))return t.replace(Wr,"");if(!t||!(n=Tt(n)))return t;var r=Xt(t),i=Tu(r,Xt(n));return Ln(r,i).join("")}function Op(t,n){var e=m,r=X;if(rt(n)){var i="separator"in n?n.separator:i;e="length"in n?B(n.length):e,r="omission"in n?Tt(n.omission):r}t=Z(t);var f=t.length;if(Xn(t)){var o=Xt(t);f=o.length}if(e>=f)return t;var l=e-Zn(r);if(l<1)return r;var h=o?Ln(o,0,l).join(""):t.slice(0,l);if(i===u)return h+r;if(o&&(l+=h.length-l),Bi(i)){if(t.slice(l).search(i)){var d,_=h;for(i.global||(i=Qr(i.source,Z(Qi.exec(i))+"g")),i.lastIndex=0;d=i.exec(_);)var v=d.index;h=h.slice(0,v===u?l:v)}}else if(t.indexOf(Tt(i),l)!=l){var y=h.lastIndexOf(i);y>-1&&(h=h.slice(0,y))}return h+r}function bp(t){return t=Z(t),t&&Gf.test(t)?t.replace(Zi,fa):t}var Dp=ne(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),Fi=ys("toUpperCase");function xf(t,n,e){return t=Z(t),n=e?u:n,n===u?ea(t)?la(t):Xo(t):t.match(n)||[]}var yf=N(function(t,n){try{return It(t,u,n)}catch(e){return Wi(e)?e:new b(e)}}),Wp=cn(function(t,n){return Ut(n,function(e){e=nn(e),an(t,e,bi(t[e],t))}),t});function Bp(t){var n=t==null?0:t.length,e=M();return t=n?nt(t,function(r){if(typeof r[1]!="function")throw new Ft(L);return[e(r[0]),r[1]]}):[],N(function(r){for(var i=-1;++i<n;){var f=t[i];if(It(f[0],this,r))return It(f[1],this,r)}})}function Pp(t){return fl(zt(t,D))}function Ni(t){return function(){return t}}function Up(t,n){return t==null||t!==t?n:t}var Fp=Ss(),Np=Ss(!0);function Ct(t){return t}function zi(t){return ju(typeof t=="function"?t:zt(t,D))}function zp(t){return ns(zt(t,D))}function Hp(t,n){return es(t,zt(n,D))}var Gp=N(function(t,n){return function(e){return ye(e,t,n)}}),Kp=N(function(t,n){return function(e){return ye(t,e,n)}});function Hi(t,n,e){var r=ht(n),i=er(n,r);e==null&&!(rt(n)&&(i.length||!r.length))&&(e=n,n=t,t=this,i=er(n,ht(n)));var f=!(rt(e)&&"chain"in e)||!!e.chain,o=gn(t);return Ut(i,function(l){var h=n[l];t[l]=h,o&&(t.prototype[l]=function(){var d=this.__chain__;if(f||d){var _=t(this.__wrapped__),v=_.__actions__=St(this.__actions__);return v.push({func:h,args:arguments,thisArg:t}),_.__chain__=d,_}return h.apply(t,yn([this.value()],arguments))})}),t}function qp(){return pt._===this&&(pt._=_a),this}function Gi(){}function $p(t){return t=B(t),N(function(n){return rs(n,t)})}var Yp=mi(nt),Xp=mi(Eu),Zp=mi(qr);function Rf(t){return Ci(t)?$r(nn(t)):El(t)}function Jp(t){return function(n){return t==null?u:Pn(t,n)}}var Vp=As(),Qp=As(!0);function Ki(){return[]}function qi(){return!1}function kp(){return{}}function jp(){return""}function td(){return!0}function nd(t,n){if(t=B(t),t<1||t>mn)return[];var e=kt,r=wt(t,kt);n=M(n),t-=kt;for(var i=Zr(r,n);++e<t;)n(e);return i}function ed(t){return W(t)?nt(t,nn):Ot(t)?[t]:St(Hs(Z(t)))}function rd(t){var n=++pa;return Z(t)+n}var id=or(function(t,n){return t+n},0),ud=xi("ceil"),sd=or(function(t,n){return t/n},1),fd=xi("floor");function od(t){return t&&t.length?nr(t,Ct,ui):u}function ad(t,n){return t&&t.length?nr(t,M(n,2),ui):u}function ld(t){return Lu(t,Ct)}function cd(t,n){return Lu(t,M(n,2))}function hd(t){return t&&t.length?nr(t,Ct,ai):u}function gd(t,n){return t&&t.length?nr(t,M(n,2),ai):u}var pd=or(function(t,n){return t*n},1),dd=xi("round"),_d=or(function(t,n){return t-n},0);function vd(t){return t&&t.length?Xr(t,Ct):0}function wd(t,n){return t&&t.length?Xr(t,M(n,2)):0}return s.after=zh,s.ary=ks,s.assign=Lg,s.assignIn=gf,s.assignInWith=yr,s.assignWith=Ig,s.at=Mg,s.before=js,s.bind=bi,s.bindAll=Wp,s.bindKey=tf,s.castArray=kh,s.chain=Js,s.chunk=fc,s.compact=oc,s.concat=ac,s.cond=Bp,s.conforms=Pp,s.constant=Ni,s.countBy=vh,s.create=Tg,s.curry=nf,s.curryRight=ef,s.debounce=rf,s.defaults=Og,s.defaultsDeep=bg,s.defer=Hh,s.delay=Gh,s.difference=lc,s.differenceBy=cc,s.differenceWith=hc,s.drop=gc,s.dropRight=pc,s.dropRightWhile=dc,s.dropWhile=_c,s.fill=vc,s.filter=mh,s.flatMap=Rh,s.flatMapDeep=Sh,s.flatMapDepth=Eh,s.flatten=$s,s.flattenDeep=wc,s.flattenDepth=mc,s.flip=Kh,s.flow=Fp,s.flowRight=Np,s.fromPairs=xc,s.functions=Ng,s.functionsIn=zg,s.groupBy=Ah,s.initial=Rc,s.intersection=Sc,s.intersectionBy=Ec,s.intersectionWith=Ac,s.invert=Gg,s.invertBy=Kg,s.invokeMap=Lh,s.iteratee=zi,s.keyBy=Ih,s.keys=ht,s.keysIn=At,s.map=dr,s.mapKeys=$g,s.mapValues=Yg,s.matches=zp,s.matchesProperty=Hp,s.memoize=vr,s.merge=Xg,s.mergeWith=pf,s.method=Gp,s.methodOf=Kp,s.mixin=Hi,s.negate=wr,s.nthArg=$p,s.omit=Zg,s.omitBy=Jg,s.once=qh,s.orderBy=Mh,s.over=Yp,s.overArgs=$h,s.overEvery=Xp,s.overSome=Zp,s.partial=Di,s.partialRight=uf,s.partition=Th,s.pick=Vg,s.pickBy=df,s.property=Rf,s.propertyOf=Jp,s.pull=Mc,s.pullAll=Xs,s.pullAllBy=Tc,s.pullAllWith=Oc,s.pullAt=bc,s.range=Vp,s.rangeRight=Qp,s.rearg=Yh,s.reject=Dh,s.remove=Dc,s.rest=Xh,s.reverse=Ti,s.sampleSize=Bh,s.set=kg,s.setWith=jg,s.shuffle=Ph,s.slice=Wc,s.sortBy=Nh,s.sortedUniq=Hc,s.sortedUniqBy=Gc,s.split=Rp,s.spread=Zh,s.tail=Kc,s.take=qc,s.takeRight=$c,s.takeRightWhile=Yc,s.takeWhile=Xc,s.tap=oh,s.throttle=Jh,s.thru=pr,s.toArray=lf,s.toPairs=_f,s.toPairsIn=vf,s.toPath=ed,s.toPlainObject=hf,s.transform=tp,s.unary=Vh,s.union=Zc,s.unionBy=Jc,s.unionWith=Vc,s.uniq=Qc,s.uniqBy=kc,s.uniqWith=jc,s.unset=np,s.unzip=Oi,s.unzipWith=Zs,s.update=ep,s.updateWith=rp,s.values=ie,s.valuesIn=ip,s.without=th,s.words=xf,s.wrap=Qh,s.xor=nh,s.xorBy=eh,s.xorWith=rh,s.zip=ih,s.zipObject=uh,s.zipObjectDeep=sh,s.zipWith=fh,s.entries=_f,s.entriesIn=vf,s.extend=gf,s.extendWith=yr,Hi(s,s),s.add=id,s.attempt=yf,s.camelCase=op,s.capitalize=wf,s.ceil=ud,s.clamp=up,s.clone=jh,s.cloneDeep=ng,s.cloneDeepWith=eg,s.cloneWith=tg,s.conformsTo=rg,s.deburr=mf,s.defaultTo=Up,s.divide=sd,s.endsWith=ap,s.eq=Jt,s.escape=lp,s.escapeRegExp=cp,s.every=wh,s.find=xh,s.findIndex=Ks,s.findKey=Dg,s.findLast=yh,s.findLastIndex=qs,s.findLastKey=Wg,s.floor=fd,s.forEach=Vs,s.forEachRight=Qs,s.forIn=Bg,s.forInRight=Pg,s.forOwn=Ug,s.forOwnRight=Fg,s.get=Pi,s.gt=ig,s.gte=ug,s.has=Hg,s.hasIn=Ui,s.head=Ys,s.identity=Ct,s.includes=Ch,s.indexOf=yc,s.inRange=sp,s.invoke=qg,s.isArguments=Nn,s.isArray=W,s.isArrayBuffer=sg,s.isArrayLike=Et,s.isArrayLikeObject=ut,s.isBoolean=fg,s.isBuffer=In,s.isDate=og,s.isElement=ag,s.isEmpty=lg,s.isEqual=cg,s.isEqualWith=hg,s.isError=Wi,s.isFinite=gg,s.isFunction=gn,s.isInteger=sf,s.isLength=mr,s.isMap=ff,s.isMatch=pg,s.isMatchWith=dg,s.isNaN=_g,s.isNative=vg,s.isNil=mg,s.isNull=wg,s.isNumber=of,s.isObject=rt,s.isObjectLike=it,s.isPlainObject=Le,s.isRegExp=Bi,s.isSafeInteger=xg,s.isSet=af,s.isString=xr,s.isSymbol=Ot,s.isTypedArray=re,s.isUndefined=yg,s.isWeakMap=Rg,s.isWeakSet=Sg,s.join=Cc,s.kebabCase=hp,s.last=Gt,s.lastIndexOf=Lc,s.lowerCase=gp,s.lowerFirst=pp,s.lt=Eg,s.lte=Ag,s.max=od,s.maxBy=ad,s.mean=ld,s.meanBy=cd,s.min=hd,s.minBy=gd,s.stubArray=Ki,s.stubFalse=qi,s.stubObject=kp,s.stubString=jp,s.stubTrue=td,s.multiply=pd,s.nth=Ic,s.noConflict=qp,s.noop=Gi,s.now=_r,s.pad=dp,s.padEnd=_p,s.padStart=vp,s.parseInt=wp,s.random=fp,s.reduce=Oh,s.reduceRight=bh,s.repeat=mp,s.replace=xp,s.result=Qg,s.round=dd,s.runInContext=c,s.sample=Wh,s.size=Uh,s.snakeCase=yp,s.some=Fh,s.sortedIndex=Bc,s.sortedIndexBy=Pc,s.sortedIndexOf=Uc,s.sortedLastIndex=Fc,s.sortedLastIndexBy=Nc,s.sortedLastIndexOf=zc,s.startCase=Sp,s.startsWith=Ep,s.subtract=_d,s.sum=vd,s.sumBy=wd,s.template=Ap,s.times=nd,s.toFinite=pn,s.toInteger=B,s.toLength=cf,s.toLower=Cp,s.toNumber=Kt,s.toSafeInteger=Cg,s.toString=Z,s.toUpper=Lp,s.trim=Ip,s.trimEnd=Mp,s.trimStart=Tp,s.truncate=Op,s.unescape=bp,s.uniqueId=rd,s.upperCase=Dp,s.upperFirst=Fi,s.each=Vs,s.eachRight=Qs,s.first=Ys,Hi(s,function(){var t={};return jt(s,function(n,e){J.call(s.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),s.VERSION=R,Ut(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){s[t].placeholder=s}),Ut(["drop","take"],function(t,n){G.prototype[t]=function(e){e=e===u?1:lt(B(e),0);var r=this.__filtered__&&!n?new G(this):this.clone();return r.__filtered__?r.__takeCount__=wt(e,r.__takeCount__):r.__views__.push({size:wt(e,kt),type:t+(r.__dir__<0?"Right":"")}),r},G.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Ut(["filter","map","takeWhile"],function(t,n){var e=n+1,r=e==vt||e==Tn;G.prototype[t]=function(i){var f=this.clone();return f.__iteratees__.push({iteratee:M(i,3),type:e}),f.__filtered__=f.__filtered__||r,f}}),Ut(["head","last"],function(t,n){var e="take"+(n?"Right":"");G.prototype[t]=function(){return this[e](1).value()[0]}}),Ut(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");G.prototype[t]=function(){return this.__filtered__?new G(this):this[e](1)}}),G.prototype.compact=function(){return this.filter(Ct)},G.prototype.find=function(t){return this.filter(t).head()},G.prototype.findLast=function(t){return this.reverse().find(t)},G.prototype.invokeMap=N(function(t,n){return typeof t=="function"?new G(this):this.map(function(e){return ye(e,t,n)})}),G.prototype.reject=function(t){return this.filter(wr(M(t)))},G.prototype.slice=function(t,n){t=B(t);var e=this;return e.__filtered__&&(t>0||n<0)?new G(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==u&&(n=B(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},G.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},G.prototype.toArray=function(){return this.take(kt)},jt(G.prototype,function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),i=s[r?"take"+(n=="last"?"Right":""):n],f=r||/^find/.test(n);i&&(s.prototype[n]=function(){var o=this.__wrapped__,l=r?[1]:arguments,h=o instanceof G,d=l[0],_=h||W(o),v=function(z){var q=i.apply(s,yn([z],l));return r&&y?q[0]:q};_&&e&&typeof d=="function"&&d.length!=1&&(h=_=!1);var y=this.__chain__,A=!!this.__actions__.length,T=f&&!y,U=h&&!A;if(!f&&_){o=U?o:new G(this);var O=t.apply(o,l);return O.__actions__.push({func:pr,args:[v],thisArg:u}),new Nt(O,y)}return T&&U?t.apply(this,l):(O=this.thru(v),T?r?O.value()[0]:O.value():O)})}),Ut(["pop","push","shift","sort","splice","unshift"],function(t){var n=ze[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);s.prototype[t]=function(){var i=arguments;if(r&&!this.__chain__){var f=this.value();return n.apply(W(f)?f:[],i)}return this[e](function(o){return n.apply(W(o)?o:[],i)})}}),jt(G.prototype,function(t,n){var e=s[n];if(e){var r=e.name+"";J.call(kn,r)||(kn[r]=[]),kn[r].push({name:n,func:e})}}),kn[fr(u,et).name]=[{name:"wrapper",func:u}],G.prototype.clone=ba,G.prototype.reverse=Da,G.prototype.value=Wa,s.prototype.at=ah,s.prototype.chain=lh,s.prototype.commit=ch,s.prototype.next=hh,s.prototype.plant=ph,s.prototype.reverse=dh,s.prototype.toJSON=s.prototype.valueOf=s.prototype.value=_h,s.prototype.first=s.prototype.head,pe&&(s.prototype[pe]=gh),s},Jn=ca();On?((On.exports=Jn)._=Jn,zr._=Jn):pt._=Jn}).call(Ie)})(Sr,Sr.exports);var Od=Sr.exports;const rn=yd(Od);class Lf{constructor(a,u){this._stateMachine=a,this._name=u,this._inputs=[]}get stateMachine(){return this._stateMachine}get name(){return this._name}}class bd extends Lf{constructor(a){super(a,"IDLE")}handleMouseWheel(a,u){throw new Error("Method not implemented.")}handleMouseDown(a,u){console.log("IdleState.handleMouseDown")}handleMouseMove(a,u){console.log("IdleState.handleMouseMove")}handleMouseUp(a,u){console.log("IdleState.handleMouseUp")}handleKeyDown(a,u){console.log("IdleState.handleKeyDown")}handleKeyUp(a,u){console.log("IdleState.handleKeyUp")}}class Dd extends Lf{constructor(u){super(u,"DEFAULT");en(this,"mouseDown",!1);en(this,"isResizing",!1);en(this,"anchor","")}handleMouseDown(u,R){u.preventDefault();const w=this.stateMachine.coordinateSystem,E=this.stateMachine.ctx;if(!E||!w||!R)return;const L=this.stateMachine.elements,C=u.clientX,x=u.clientY,H=w.clientPointToViewPoint({clientX:C,clientY:x}),F=L.find(D=>D.contains(H.x,H.y));if(this.stateMachine.selectedElement){const D=this.stateMachine.selectedElement.anchorToString(this.stateMachine.selectedElement.getNearestAnchor(H.x,H.y));D?(this.isResizing=!0,this.anchor=D):(F?(this.stateMachine.selectedElement=F,E.clearRect(0,0,R.width,R.height),rn.each(L,k=>{k.draw(E)}),this.stateMachine.selectedElement.drawBoundingBoxWithHandles(E)):(this.stateMachine.selectedElement=null,E.clearRect(0,0,R.width,R.height),rn.each(L,k=>{k.draw(E)})),this.isResizing=!1)}else F?(this.stateMachine.selectedElement=F,E.clearRect(0,0,R.width,R.height),rn.each(L,D=>{D.draw(E)}),this.stateMachine.selectedElement.drawBoundingBoxWithHandles(E)):(this.stateMachine.selectedElement=null,E.clearRect(0,0,R.width,R.height),rn.each(L,D=>{D.draw(E)}));this.mouseDown=!0}handleMouseWheel(u,R){u.shiftKey&&this.stateMachine.coordinateSystem.scaleAtClientPoint(-.001*u.deltaY,{clientX:u.clientX,clientY:u.clientY})}handleMouseMove(u,R){const w=this.stateMachine.coordinateSystem,E=this.stateMachine.ctx;if(!E||!w||!R)return;const L=this.stateMachine.elements;if(this.mouseDown&&this.stateMachine.selectedElement){const C={x:u.movementX/w.scale,y:u.movementY/w.scale},x=this.stateMachine.selectedElement;if(this.isResizing&&this.anchor)switch(this.anchor){case"topLeft":x.rectangle.updateDimensions(x.rectangle.topLeft.x+C.x,x.rectangle.topLeft.y+C.y,x.rectangle.width-C.x,x.rectangle.height-C.y);break;case"topRight":x.rectangle.updateDimensions(x.rectangle.topLeft.x,x.rectangle.topLeft.y+C.y,x.rectangle.width+C.x,x.rectangle.height-C.y);break;case"bottomRight":x.rectangle.updateDimensions(x.rectangle.topLeft.x,x.rectangle.topLeft.y,x.rectangle.width+C.x,x.rectangle.height+C.y);break;case"bottomLeft":x.rectangle.updateDimensions(x.rectangle.topLeft.x+C.x,x.rectangle.topLeft.y,x.rectangle.width-C.x,x.rectangle.height+C.y);break;case"topMid":x.rectangle.updateDimensions(x.rectangle.topLeft.x,x.rectangle.topLeft.y+C.y,x.rectangle.width,x.rectangle.height-C.y);break;case"rightMid":x.rectangle.updateDimensions(x.rectangle.topLeft.x,x.rectangle.topLeft.y,x.rectangle.width+C.x,x.rectangle.height);break;case"bottomMid":x.rectangle.updateDimensions(x.rectangle.topLeft.x,x.rectangle.topLeft.y,x.rectangle.width,x.rectangle.height+C.y);break;case"leftMid":x.rectangle.updateDimensions(x.rectangle.topLeft.x+C.x,x.rectangle.topLeft.y,x.rectangle.width-C.x,x.rectangle.height);break}else this.stateMachine.selectedElement.translate(C.x,C.y);const H=L.findIndex(F=>F.id===x.id);this.stateMachine.elements[H]=x,E.clearRect(0,0,R.width,R.height),rn.each(L,F=>{F.draw(E)}),this.stateMachine.selectedElement.drawBoundingBoxWithHandles(E)}}handleMouseUp(u,R){this.isResizing&&this.stateMachine.selectedElement&&this.stateMachine.selectedElement.rectangle.processDisplacement(),this.mouseDown=!1,this.isResizing=!1,this.anchor=""}handleKeyDown(u,R){}handleKeyUp(u,R){}}let zn=function(I){return I.AUTO="auto",I.COVER="cover",I.CONTAIN="contain",I}({});var Lt=function(I){return I.BACKGROUND="background",I.INTERFACE="interface",I}(Lt||{});const If=zn.CONTAIN,Af=[Lt.BACKGROUND,Lt.INTERFACE],Wd={display:"block",width:"100%",height:"100vh",position:"relative",backgroundColor:"lightblue"},Bd={display:"block",position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"transparent"},Pd={size:If,imageSrc:"./test.png",width:800,height:800},Ud={min:1,max:5};function Fd({containerElementStyle:I=Wd,canvasElementStyle:a=Bd,background:u=Pd,zoomExtents:R=Ud,elements:w=[],onViewChange:E}){const{containerRef:L,screenSize:C}=Md(),x=gt.useRef(null),H=gt.useRef({}),F=gt.useRef({}),D=gt.useRef(P()),k=gt.useRef(w),ft=gt.useCallback(()=>{const m=new Td({canvasElements:k.current,coordinateSystem:D.current,canvas:H.current[Lt.INTERFACE],ctx:F.current[Lt.INTERFACE]}),X=new Dd(m),$=new bd(m);return m.addState(X),m.addState($),m.setState(X.name),m},[]),V=gt.useRef(ft());gt.useEffect(()=>{const m=H.current[Lt.INTERFACE];if(!m)return;const X=ot=>{V.current.handleMouseMove(ot,m)},$=ot=>{V.current.handleMouseUp(ot,m)},_t=ot=>{V.current.handleMouseDown(ot,m)},vt=ot=>{V.current.handleKeyDown(ot,m)},Qt=ot=>{V.current.handleKeyUp(ot,m)},Tn=ot=>{V.current.handleMouseWheel(ot,m)};return m.addEventListener("mousedown",_t),m.addEventListener("mousemove",X),m.addEventListener("mouseup",$),m.addEventListener("wheel",Tn),m.addEventListener("keydown",vt),m.addEventListener("keyup",Qt),()=>{m.removeEventListener("mousedown",_t),m.removeEventListener("mousemove",X),m.removeEventListener("mouseup",$),m.removeEventListener("wheel",Tn),m.removeEventListener("keydown",vt),m.removeEventListener("keyup",Qt)}},[]);function K(m){if(!u)return m;switch(u.size||(u.size=If),u.size){case zn.COVER:const X=x.current;if(X){const{width:$,height:_t}=X;if(!u.useImageOriginSize){let vt=m.width,Qt=m.height;const Tn=$/_t;return Qt=vt/Tn,Qt>m.height&&(Qt=m.height,vt=Qt*Tn),{width:vt,height:Qt}}return{width:$,height:_t}}break;case zn.CONTAIN:return{width:u.width||0,height:u.height||0}}return m}function P(){const m=new Sd(R,C);return m.attachViewChangeListener(et),m}function et({view:m,transform:X}){console.log("applyView",m,X);const $=D.current;$&&(Af.map(_t=>F.current[_t]).forEach(_t=>{vn(_t);const vt=$.transformMatrix;_t.setTransform(vt.a,vt.b,vt.c,vt.d,vt.e,vt.f)}),Gn())}function vn(m){Wt([m],()=>m.clearRect(0,0,m.canvas.width,m.canvas.height))}function Wt(m,X){m.forEach($=>{$.save(),$.setTransform(ue.a,ue.b,ue.c,ue.d,ue.e,ue.f)});try{X()}finally{m.forEach($=>$.restore())}}function wn(m){D.current.documentSize={...m}}function Bt({canvas:m,ctx:X,image:$}){if($&&$.complete&&m&&X&&u)switch(u.size){case zn.AUTO:Id({canvas:m,ctx:X,image:$});break;case zn.COVER:Cd({ctx:X,image:$});break;case zn.CONTAIN:default:Ld({canvas:m,ctx:X,image:$});break}}function un(m,X=!1){let $=!1;const{canvas:_t}=D.current;console.log("handle view change",m,_t),(_t.width!==m.width||_t.height!==m.height)&&(Ad(H.current,m),wn(m),$=!0),(X||$)&&Gn()}function qt(){console.log("update canvas background");const m=H.current[Lt.BACKGROUND],X=F.current[Lt.BACKGROUND],$=x.current;!m||!X||(X.clearRect(0,0,m.width,m.height),$&&Bt({canvas:m,ctx:X,image:$}))}function Mn(){console.log("re-draw geometries"),vn(F.current[Lt.INTERFACE]),k.current.forEach(m=>{m.draw(F.current[Lt.INTERFACE])})}function Gn(){console.log("redraw all"),qt(),Mn()}return gt.useEffect(()=>{console.log("resize container effect",C);const m=K(C);console.log("newSize",m),un(m),typeof E=="function"&&E(m)},[C]),gt.useEffect(()=>{V.current.setCanvas(H.current[Lt.INTERFACE]),V.current.setCtx(F.current[Lt.INTERFACE])},[H.current]),gt.useEffect(()=>{if(!(!u||!u.imageSrc||u.imageSrc==="")&&(!x.current||x.current.getAttribute("src")!==u.imageSrc)){console.log("Draw background image",u,x.current);const m=new Image;m.src=u.imageSrc,m.onload=()=>{console.log("load image success");const X=K(C);console.log("load image success newSize",X),un(X,!0)},m.onabort=()=>{x.current=null},x.current=m}},[u,x]),gt.useEffect(()=>{console.log("update elements",w),k.current=w,V.current.elements=w,rn.each(k.current,m=>{m.draw(F.current[Lt.INTERFACE])})},[w]),_n.jsx("div",{style:{...I},ref:L,children:Af.map(m=>{const X=m===Lt.INTERFACE;return _n.jsx("canvas",{ref:$=>{$&&(H.current[m]=$,F.current[m]=$.getContext("2d"),X&&(D.current.canvas=$))},style:{...a}},m)})})}class ct{constructor(a,u){this.x=a,this.y=u}translate(a,u){this.x+=a,this.y+=u}clone(){return new ct(this.x,this.y)}serialize(){return`${this.x},${this.y}`}json(){return JSON.stringify(this)}deserialize(a){const[u,R]=a.split(",").map(w=>parseInt(w));return new ct(u,R)}static middlePoint(a,u){return new ct((a.x+u.x)/2,(a.y+u.y)/2)}static distance(a,u){return Math.sqrt((a.x-u.x)**2+(a.y-u.y)**2)}static isSame(a,u){return a.x===u.x&&a.y===u.y}}class $i{constructor(a){this._points=a}get points(){return this._points}set points(a){this._points=a}get boundingBox(){let a=this._points[0].x,u=this._points[0].y,R=this._points[0].x,w=this._points[0].y;return rn.each(this._points,E=>{a=Math.min(a,E.x),u=Math.min(u,E.y),R=Math.max(R,E.x),w=Math.max(w,E.y)}),new Hn(a,u,R-a,w-u)}translate(a,u){rn.each(this._points,R=>R.translate(a,u))}clone(){return new $i(this._points.map(a=>a.clone()))}serialize(){return rn.map(this.points,a=>[a.x,a.y])}deserialize(a){this.points=rn.map(a,u=>new ct(u[0],u[1]))}}class Hn extends $i{constructor(a=0,u=0,R=0,w=0){if(a instanceof ct&&u instanceof ct&&R instanceof ct&&w instanceof ct)super([a,u,R,w]);else if(typeof a=="number"&&typeof u=="number"&&typeof R=="number"&&typeof w=="number")super(Hn.pointsFromBounds(a,u,R,w));else throw new Error("Invalid arguments")}static pointsFromBounds(a,u,R,w){return[new ct(a,u),new ct(a+R,u),new ct(a+R,u+w),new ct(a,u+w)]}get width(){return this._points[1].x-this._points[0].x}get height(){return this._points[2].y-this._points[1].y}get topLeft(){return this._points[0]}get topRight(){return this._points[1]}get bottomRight(){return this._points[2]}get bottomLeft(){return this._points[3]}get topMid(){return ct.middlePoint(this.topLeft,this.topRight)}get rightMid(){return ct.middlePoint(this.topRight,this.bottomRight)}get bottomMid(){return ct.middlePoint(this.bottomLeft,this.bottomRight)}get leftMid(){return ct.middlePoint(this.topLeft,this.bottomLeft)}contains(a,u){return a>=this.topLeft.x&&a<=this.topRight.x&&u>=this.topLeft.y&&u<=this.bottomLeft.y}updateDimensions(a,u,R,w){this.points=Hn.pointsFromBounds(a,u,R,w)}processDisplacement(){this.width<0&&([this._points[0],this._points[1]]=[this._points[1],this._points[0]],[this._points[2],this._points[3]]=[this._points[3],this._points[2]]),this.height<0&&([this._points[0],this._points[3]]=[this._points[3],this._points[0]],[this._points[1],this._points[2]]=[this._points[2],this._points[1]])}clone(){return new Hn(this._points[0].x,this._points[0].y,this.width,this.height)}json(){return JSON.stringify(this)}}class Cf{constructor(a,u,R,w,E){this._id=a,this._color=u,this._isCurrent=R,this._numberOfEquipments=w,this._rectangle=E}get id(){return this._id}get color(){return this._color}get isCurrent(){return this._isCurrent}get numberOfEquipments(){return this._numberOfEquipments}get rectangle(){return this._rectangle}translate(a,u){this._rectangle.translate(a,u)}updateDimensions(a,u){this._rectangle.updateDimensions(this._rectangle.topLeft.x,this._rectangle.topLeft.y,a,u)}draw(a){this.drawPolygon(a),this.drawNumberOfEquipments(a),this.drawIsCurrent(a)}contains(a,u){return this.rectangle.contains(a,u)}drawDebug(a){a.fillStyle="black",a.fillText("TL",this.rectangle.topLeft.x,this.rectangle.topLeft.y,this.rectangle.width),a.fillText("TR",this.rectangle.topRight.x,this.rectangle.topRight.y,this.rectangle.width),a.fillText("BR",this.rectangle.bottomRight.x,this.rectangle.bottomRight.y,this.rectangle.width),a.fillText("BL",this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y,this.rectangle.width)}drawPolygon(a){a.fillStyle=this.color,a.fillRect(this.rectangle.topLeft.x,this.rectangle.topLeft.y,this.rectangle.width,this.rectangle.height)}drawIsCurrent(a){this.isCurrent&&(a.fillStyle="red",a.font="40px Arial",a.fillText("*",this.rectangle.topLeft.x,this.rectangle.topLeft.y+35,this.rectangle.width))}drawNumberOfEquipments(a){this.numberOfEquipments>0&&(a.fillStyle="black",a.font="14px Arial",a.fillText(`(${this.numberOfEquipments.toString()})`,this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y+14,this.rectangle.width))}drawBoundingBox(a){a.strokeStyle="black",a.strokeRect(this.rectangle.topLeft.x,this.rectangle.topLeft.y,this.rectangle.width,this.rectangle.height)}drawBoundingBoxWithHandles(a){this.drawBoundingBox(a),this.drawHandles(a)}drawHandles(a){a.fillStyle="black",a.fillRect(this.rectangle.topLeft.x-3,this.rectangle.topLeft.y-3,6,6),a.fillRect(this.rectangle.topRight.x-3,this.rectangle.topRight.y-3,6,6),a.fillRect(this.rectangle.bottomRight.x-3,this.rectangle.bottomRight.y-3,6,6),a.fillRect(this.rectangle.bottomLeft.x-3,this.rectangle.bottomLeft.y-3,6,6),this.rectangle.height>30&&(a.fillRect(this.rectangle.rightMid.x-3,this.rectangle.rightMid.y-3,6,6),a.fillRect(this.rectangle.leftMid.x-3,this.rectangle.leftMid.y-3,6,6)),this.rectangle.width>30&&(a.fillRect(this.rectangle.topMid.x-3,this.rectangle.topMid.y-3,6,6),a.fillRect(this.rectangle.bottomMid.x-3,this.rectangle.bottomMid.y-3,6,6))}getNearestAnchor(a,u){const R=[this.rectangle.topLeft,this.rectangle.topMid,this.rectangle.topRight,this.rectangle.rightMid,this.rectangle.bottomRight,this.rectangle.bottomMid,this.rectangle.bottomLeft,this.rectangle.leftMid],w=R.map(C=>ct.distance(C,new ct(a,u))),E=Math.min(...w),L=w.findIndex(C=>C===E&&C<10);return R[L]}anchorToString(a){return a===this.rectangle.topLeft?"topLeft":a===this.rectangle.topMid?"topMid":a===this.rectangle.topRight?"topRight":a===this.rectangle.rightMid?"rightMid":a===this.rectangle.bottomRight?"bottomRight":a===this.rectangle.bottomMid?"bottomMid":a===this.rectangle.bottomLeft?"bottomLeft":a===this.rectangle.leftMid?"leftMid":""}}const Nd="#ffff66";function zd(){const I={size:zn.COVER},a=gt.useRef(null),[u,R]=gt.useState([]),[w,E]=gt.useState(I),L=K=>{a.current={...K}},C=K=>{E(P=>({...P,...K}))},x=K=>{const P=K.map(et=>{const vn=new Hn(0,0,0,0);return vn.deserialize(JSON.parse(et.JsonRectangle)),new Cf(et.id.toString(),et.Color,et.IsCurrent,et.NumberEquipment,vn)});R([...P])},H=K=>{L(K)},F=()=>{const K=new Hn(0,0,100,100),P=new Cf(`${u.length+1}`,Nd,!1,4,K);R([...u,P])},D=()=>{a.current&&H(a.current)},k=K=>{L({background:w,elements:u}),typeof K=="function"&&K(V())},ft=()=>{const K=u.map(P=>({id:P.id,IsTemplate:!1,NumberEquipment:P.numberOfEquipments,Color:P.color,IsCurrent:P.isCurrent,JsonRectangle:P.rectangle.serialize()}));return console.log("exportRectangles: ",K),K},V=()=>{const K=u.map(P=>({id:parseInt(P.id),IsTemplate:!1,NumberEquipment:P.numberOfEquipments,Color:P.color,IsCurrent:P.isCurrent,JsonRectangle:JSON.stringify(P.rectangle.serialize())}));return JSON.stringify({background:w,data:K})};return{background:w,elements:u,loadBackground:C,loadDataSource:x,loadAll:H,addRectangle:F,exportRectangles:ft,toString:V,saveData:k,resetData:D}}const Hd={imageSource:"./test1.png",data:[{id:1,IsTemplate:!1,NumberEquipment:2,Color:"#ffff66",IsCurrent:!0,JsonRectangle:"[[100,50],[200,50],[200,150],[100,150]]"},{id:2,IsTemplate:!1,NumberEquipment:3,Color:"#ffff66",IsCurrent:!1,JsonRectangle:"[[150,100],[250,100],[250,200],[150,200]]"},{id:3,IsTemplate:!1,NumberEquipment:4,Color:"#ffff66",IsCurrent:!1,JsonRectangle:"[[300,200],[400,200],[400,300],[300,300]]"}]},$d=()=>{const{background:I,elements:a,loadBackground:u,exportRectangles:R,saveData:w,addRectangle:E,loadDataSource:L}=zd(),C=D=>{D.preventDefault(),E()},x=D=>{D.preventDefault(),L(Hd.data)},H=D=>{D.preventDefault(),u({imageSrc:"./test1.png"})},F=D=>{D.preventDefault(),w(function(k){console.log(k)})};return _n.jsxs(Rd,{children:[_n.jsxs("div",{className:"map-tools",children:[_n.jsx("button",{onClick:x,children:"load"}),_n.jsx("button",{onClick:C,children:"create"}),_n.jsx("button",{onClick:H,children:"image"}),_n.jsx("button",{onClick:F,children:"save"})]}),_n.jsx(Fd,{elements:a,background:I})]})};export{$d as default};
