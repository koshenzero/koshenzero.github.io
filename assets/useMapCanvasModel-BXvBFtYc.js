var F_=Object.defineProperty;var N_=(g,o,i)=>o in g?F_(g,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):g[o]=i;var vt=(g,o,i)=>(N_(g,typeof o!="symbol"?o+"":o,i),i);import{r as wt,y as De,q as G_,R as H_,j as Go}from"./index-BIUFc63u.js";const Ho=Object.freeze({x:0,y:0,untransformedX:0,untransformedY:0}),Ir=Object.freeze({canvasWidth:0,canvasHeight:0,left:0,top:0,right:0,bottom:0,viewMin:Ho,viewMax:Ho}),fe=Object.freeze({a:1,b:0,c:0,d:1,e:0,f:0});class q_{constructor(o,i){vt(this,"_canvas",null);vt(this,"_view",{scale:1,x:0,y:0});vt(this,"_viewChangeListeners",new Set);vt(this,"_initialViewSize",{width:0,height:0});this._scaleExtents=o,this._documentSize=i}get canvas(){return this._canvas}set canvas(o){this._canvas=o,this.setView()}get scale(){return this._view.scale}setScale(o){this.setView({scale:o})}get initialViewSize(){return this._initialViewSize}set initialViewSize(o){this._initialViewSize=o}get x(){return this._view.x}set x(o){this.setView({x:o})}get y(){return this._view.y}set y(o){this.setView({y:o})}get view(){return{...this._view}}get scaleExtents(){return{...this._scaleExtents}}set scaleExtents(o){this._scaleExtents={...o},this.setView()}get documentSize(){return{...this._documentSize}}set documentSize(o){this._documentSize={...o},this.setView()}get transformMatrix(){return{a:this._view.scale,b:0,c:0,d:this._view.scale,e:this._view.x,f:this._view.y}}get canvasBounds(){if(this._canvas){const{left:o,top:i,right:d,bottom:v}=this._canvas.getBoundingClientRect();return{viewMin:this.clientPointToViewPoint({clientX:o,clientY:i}),viewMax:this.clientPointToViewPoint({clientX:d,clientY:v}),left:o,top:i,right:d,bottom:v,canvasWidth:this._canvas.width,canvasHeight:this._canvas.height}}else return}get canvasRect(){if(this._canvas)return this._canvas.getBoundingClientRect()}clampView(o){const{min:i,max:d}=this._scaleExtents,{width:v,height:M}=this._documentSize,{left:S,top:B,right:W,bottom:N}=this.canvasRect||Ir,D=W-S,C=N-B,J=D/2,ut=-(v*this._view.scale-D/2),gt=C/2,nt=-(M*this._view.scale-C/2);return{scale:Math.min(Math.max(o.scale,i),d),x:Math.min(Math.max(o.x,ut),J),y:Math.min(Math.max(o.y,nt),gt)}}resetView(){this.setView({scale:1,x:0,y:0})}setView(o){const i=this.clampView({...this._view,...o||{}}),{scale:d,x:v,y:M}=this._view;return(i.scale!==d||i.x!==v||i.y!==M)&&(this._view=i,this._viewChangeListeners.forEach(S=>S&&S({view:i,transform:this.transformMatrix}))),{...this._view}}scaleAtClientPoint(o,i){const d=this.clientPointToViewPoint(i),v=this.clampView({...this._view,scale:this._view.scale+o}),M=this.viewPointToClientPoint(d,v);v.x=this._view.x-(M.clientX-i.clientX),v.y=this._view.y-(M.clientY-i.clientY);const{width:S,height:B}=this._documentSize,{left:W,top:N,right:D,bottom:C}=this.canvasRect||Ir,J=D-W,ut=C-N,gt=J/2,nt=-(S*v.scale-J/2),it=ut/2,Y=-(B*v.scale-ut/2);return v.x=Math.min(Math.max(v.x,nt),gt),v.y=Math.min(Math.max(v.y,Y),it),v.scale===this._scaleExtents.min&&(v.x=0,v.y=0),this.setView(v)}clientPointToViewPoint(o,i=this._view){const{left:d,top:v}=this.canvasRect||Ir,M=o.clientX-d,S=o.clientY-v;return{x:(M-i.x)/i.scale,y:(S-i.y)/i.scale,relativeClientX:M,relativeClientY:S}}viewPointToClientPoint(o,i=this._view){const{left:d,top:v}=this.canvasRect||Ir,M=o.x*i.scale+i.x,S=o.y*i.scale+i.y,B=M+d,W=S+v;return{clientX:B,clientY:W,relativeX:M,relativeY:S,x:B,y:W}}attachViewChangeListener(o){this._viewChangeListeners.add(o)}}const K_=(g,o,i)=>{g.width=o,g.height=i,g.style.width=`${o}px`,g.style.height=`${i}px`},Y_=(g,o)=>{for(const i in g)Object.prototype.hasOwnProperty.call(g,i)&&K_(g[i],o.width,o.height)};function V_({ctx:g,image:o,x:i=0,y:d=0,w:v=g.canvas.width,h:M=g.canvas.height,offsetX:S=.5,offsetY:B=.5}){S<0&&(S=0),B<0&&(B=0),S>1&&(S=1),B>1&&(B=1);const W=o.width,N=o.height,D=Math.min(v/W,M/N);let C=W*D,J=N*D,ut,gt,nt,it,Y=1;C<v&&(Y=v/C),Math.abs(Y-1)<1e-14&&J<M&&(Y=M/J),C*=Y,J*=Y,nt=W/(C/v),it=N/(J/M),ut=(W-nt)*S,gt=(N-it)*B,ut<0&&(ut=0),gt<0&&(gt=0),nt>W&&(nt=W),it>N&&(it=N),g.drawImage(o,ut,gt,nt,it,i,d,v,M)}function $_({canvas:g,ctx:o,image:i}){if(i&&i.complete&&g&&o){const d=i.width,v=i.height,M=g.getBoundingClientRect(),S=M.width,B=M.height,W=d/v;let N=S,D=N/W;D>B&&(D=B,N=D*W),o.drawImage(i,0,0,d,v,0,0,N,D)}}function X_({canvas:g,ctx:o,image:i}){if(i&&i.complete&&g&&o){const d=i.width,v=i.height,M=g.getBoundingClientRect(),S=M.width,B=M.height;o.drawImage(i,0,0,d,v,0,0,S,B)}}function Z_(g){const o=wt.useRef(null),[i,d]=wt.useState({width:window.innerWidth,height:window.innerHeight});return wt.useEffect(()=>{const v=new ResizeObserver(M=>{for(const S of M){if(S.contentRect){const{width:B,height:W}=S.contentRect;d({width:B,height:W})}typeof g=="function"&&g(S)}});return o.current&&v.observe(o.current),()=>{v.disconnect()}},[g]),{containerRef:o,screenSize:i}}class Ue{constructor(o,i){this._stateMachine=o,this._name=i}get stateMachine(){return this._stateMachine}get name(){return this._name}}class J_ extends Ue{constructor(o,i){super(o,i)}onEnter(){}onExit(){}handleMouseWheel(o,i){}handleMouseDown(o,i){}handleMouseMove(o,i){}handleMouseUp(o,i){}}var br={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */br.exports;(function(g,o){(function(){var i,d="4.17.21",v=200,M="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",S="Expected a function",B="Invalid `variable` option passed into `_.template`",W="__lodash_hash_undefined__",N=500,D="__lodash_placeholder__",C=1,J=2,ut=4,gt=1,nt=2,it=1,Y=2,ot=4,_t=8,Ot=16,bt=32,Gt=64,Dt=128,A=256,O=512,U=30,p="...",R=800,E=16,T=1,P=2,j=3,z=1/0,F=9007199254740991,Lt=17976931348623157e292,Yn=NaN,cn=4294967295,Jo=cn-1,Qo=cn>>>1,ko=[["ary",Dt],["bind",it],["bindKey",Y],["curry",_t],["curryRight",Ot],["flip",O],["partial",bt],["partialRight",Gt],["rearg",A]],Vn="[object Arguments]",ze="[object Array]",jo="[object AsyncFunction]",ce="[object Boolean]",he="[object Date]",tf="[object DOMException]",Fe="[object Error]",Ne="[object Function]",as="[object GeneratorFunction]",rn="[object Map]",de="[object Number]",nf="[object Null]",_n="[object Object]",ls="[object Promise]",ef="[object Proxy]",ge="[object RegExp]",sn="[object Set]",_e="[object String]",Ge="[object Symbol]",rf="[object Undefined]",pe="[object WeakMap]",sf="[object WeakSet]",ve="[object ArrayBuffer]",$n="[object DataView]",Br="[object Float32Array]",Wr="[object Float64Array]",Ur="[object Int8Array]",zr="[object Int16Array]",Fr="[object Int32Array]",Nr="[object Uint8Array]",Gr="[object Uint8ClampedArray]",Hr="[object Uint16Array]",qr="[object Uint32Array]",uf=/\b__p \+= '';/g,of=/\b(__p \+=) '' \+/g,ff=/(__e\(.*?\)|\b__t\)) \+\n'';/g,cs=/&(?:amp|lt|gt|quot|#39);/g,hs=/[&<>"']/g,af=RegExp(cs.source),lf=RegExp(hs.source),cf=/<%-([\s\S]+?)%>/g,hf=/<%([\s\S]+?)%>/g,ds=/<%=([\s\S]+?)%>/g,df=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gf=/^\w*$/,_f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Kr=/[\\^$.*+?()[\]{}|]/g,pf=RegExp(Kr.source),Yr=/^\s+/,vf=/\s/,wf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,mf=/\{\n\/\* \[wrapped with (.+)\] \*/,xf=/,? & /,yf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Sf=/[()=,{}\[\]\/\s]/,Ef=/\\(\\)?/g,Af=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gs=/\w*$/,Rf=/^[-+]0x[0-9a-f]+$/i,Tf=/^0b[01]+$/i,Lf=/^\[object .+?Constructor\]$/,Mf=/^0o[0-7]+$/i,Cf=/^(?:0|[1-9]\d*)$/,If=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,He=/($^)/,Of=/['\n\r\u2028\u2029\\]/g,qe="\\ud800-\\udfff",bf="\\u0300-\\u036f",Df="\\ufe20-\\ufe2f",Pf="\\u20d0-\\u20ff",_s=bf+Df+Pf,ps="\\u2700-\\u27bf",vs="a-z\\xdf-\\xf6\\xf8-\\xff",Bf="\\xac\\xb1\\xd7\\xf7",Wf="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Uf="\\u2000-\\u206f",zf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ws="A-Z\\xc0-\\xd6\\xd8-\\xde",ms="\\ufe0e\\ufe0f",xs=Bf+Wf+Uf+zf,Vr="['’]",Ff="["+qe+"]",ys="["+xs+"]",Ke="["+_s+"]",Ss="\\d+",Nf="["+ps+"]",Es="["+vs+"]",As="[^"+qe+xs+Ss+ps+vs+ws+"]",$r="\\ud83c[\\udffb-\\udfff]",Gf="(?:"+Ke+"|"+$r+")",Rs="[^"+qe+"]",Xr="(?:\\ud83c[\\udde6-\\uddff]){2}",Zr="[\\ud800-\\udbff][\\udc00-\\udfff]",Xn="["+ws+"]",Ts="\\u200d",Ls="(?:"+Es+"|"+As+")",Hf="(?:"+Xn+"|"+As+")",Ms="(?:"+Vr+"(?:d|ll|m|re|s|t|ve))?",Cs="(?:"+Vr+"(?:D|LL|M|RE|S|T|VE))?",Is=Gf+"?",Os="["+ms+"]?",qf="(?:"+Ts+"(?:"+[Rs,Xr,Zr].join("|")+")"+Os+Is+")*",Kf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Yf="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bs=Os+Is+qf,Vf="(?:"+[Nf,Xr,Zr].join("|")+")"+bs,$f="(?:"+[Rs+Ke+"?",Ke,Xr,Zr,Ff].join("|")+")",Xf=RegExp(Vr,"g"),Zf=RegExp(Ke,"g"),Jr=RegExp($r+"(?="+$r+")|"+$f+bs,"g"),Jf=RegExp([Xn+"?"+Es+"+"+Ms+"(?="+[ys,Xn,"$"].join("|")+")",Hf+"+"+Cs+"(?="+[ys,Xn+Ls,"$"].join("|")+")",Xn+"?"+Ls+"+"+Ms,Xn+"+"+Cs,Yf,Kf,Ss,Vf].join("|"),"g"),Qf=RegExp("["+Ts+qe+_s+ms+"]"),kf=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,jf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ta=-1,ct={};ct[Br]=ct[Wr]=ct[Ur]=ct[zr]=ct[Fr]=ct[Nr]=ct[Gr]=ct[Hr]=ct[qr]=!0,ct[Vn]=ct[ze]=ct[ve]=ct[ce]=ct[$n]=ct[he]=ct[Fe]=ct[Ne]=ct[rn]=ct[de]=ct[_n]=ct[ge]=ct[sn]=ct[_e]=ct[pe]=!1;var lt={};lt[Vn]=lt[ze]=lt[ve]=lt[$n]=lt[ce]=lt[he]=lt[Br]=lt[Wr]=lt[Ur]=lt[zr]=lt[Fr]=lt[rn]=lt[de]=lt[_n]=lt[ge]=lt[sn]=lt[_e]=lt[Ge]=lt[Nr]=lt[Gr]=lt[Hr]=lt[qr]=!0,lt[Fe]=lt[Ne]=lt[pe]=!1;var na={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ea={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ra={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ia={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},sa=parseFloat,ua=parseInt,Ds=typeof De=="object"&&De&&De.Object===Object&&De,oa=typeof self=="object"&&self&&self.Object===Object&&self,Rt=Ds||oa||Function("return this")(),Qr=o&&!o.nodeType&&o,Bn=Qr&&!0&&g&&!g.nodeType&&g,Ps=Bn&&Bn.exports===Qr,kr=Ps&&Ds.process,Zt=function(){try{var c=Bn&&Bn.require&&Bn.require("util").types;return c||kr&&kr.binding&&kr.binding("util")}catch{}}(),Bs=Zt&&Zt.isArrayBuffer,Ws=Zt&&Zt.isDate,Us=Zt&&Zt.isMap,zs=Zt&&Zt.isRegExp,Fs=Zt&&Zt.isSet,Ns=Zt&&Zt.isTypedArray;function Ht(c,w,_){switch(_.length){case 0:return c.call(w);case 1:return c.call(w,_[0]);case 2:return c.call(w,_[0],_[1]);case 3:return c.call(w,_[0],_[1],_[2])}return c.apply(w,_)}function fa(c,w,_,I){for(var K=-1,et=c==null?0:c.length;++K<et;){var yt=c[K];w(I,yt,_(yt),c)}return I}function Jt(c,w){for(var _=-1,I=c==null?0:c.length;++_<I&&w(c[_],_,c)!==!1;);return c}function aa(c,w){for(var _=c==null?0:c.length;_--&&w(c[_],_,c)!==!1;);return c}function Gs(c,w){for(var _=-1,I=c==null?0:c.length;++_<I;)if(!w(c[_],_,c))return!1;return!0}function Rn(c,w){for(var _=-1,I=c==null?0:c.length,K=0,et=[];++_<I;){var yt=c[_];w(yt,_,c)&&(et[K++]=yt)}return et}function Ye(c,w){var _=c==null?0:c.length;return!!_&&Zn(c,w,0)>-1}function jr(c,w,_){for(var I=-1,K=c==null?0:c.length;++I<K;)if(_(w,c[I]))return!0;return!1}function ht(c,w){for(var _=-1,I=c==null?0:c.length,K=Array(I);++_<I;)K[_]=w(c[_],_,c);return K}function Tn(c,w){for(var _=-1,I=w.length,K=c.length;++_<I;)c[K+_]=w[_];return c}function ti(c,w,_,I){var K=-1,et=c==null?0:c.length;for(I&&et&&(_=c[++K]);++K<et;)_=w(_,c[K],K,c);return _}function la(c,w,_,I){var K=c==null?0:c.length;for(I&&K&&(_=c[--K]);K--;)_=w(_,c[K],K,c);return _}function ni(c,w){for(var _=-1,I=c==null?0:c.length;++_<I;)if(w(c[_],_,c))return!0;return!1}var ca=ei("length");function ha(c){return c.split("")}function da(c){return c.match(yf)||[]}function Hs(c,w,_){var I;return _(c,function(K,et,yt){if(w(K,et,yt))return I=et,!1}),I}function Ve(c,w,_,I){for(var K=c.length,et=_+(I?1:-1);I?et--:++et<K;)if(w(c[et],et,c))return et;return-1}function Zn(c,w,_){return w===w?Ra(c,w,_):Ve(c,qs,_)}function ga(c,w,_,I){for(var K=_-1,et=c.length;++K<et;)if(I(c[K],w))return K;return-1}function qs(c){return c!==c}function Ks(c,w){var _=c==null?0:c.length;return _?ii(c,w)/_:Yn}function ei(c){return function(w){return w==null?i:w[c]}}function ri(c){return function(w){return c==null?i:c[w]}}function Ys(c,w,_,I,K){return K(c,function(et,yt,at){_=I?(I=!1,et):w(_,et,yt,at)}),_}function _a(c,w){var _=c.length;for(c.sort(w);_--;)c[_]=c[_].value;return c}function ii(c,w){for(var _,I=-1,K=c.length;++I<K;){var et=w(c[I]);et!==i&&(_=_===i?et:_+et)}return _}function si(c,w){for(var _=-1,I=Array(c);++_<c;)I[_]=w(_);return I}function pa(c,w){return ht(w,function(_){return[_,c[_]]})}function Vs(c){return c&&c.slice(0,Js(c)+1).replace(Yr,"")}function qt(c){return function(w){return c(w)}}function ui(c,w){return ht(w,function(_){return c[_]})}function we(c,w){return c.has(w)}function $s(c,w){for(var _=-1,I=c.length;++_<I&&Zn(w,c[_],0)>-1;);return _}function Xs(c,w){for(var _=c.length;_--&&Zn(w,c[_],0)>-1;);return _}function va(c,w){for(var _=c.length,I=0;_--;)c[_]===w&&++I;return I}var wa=ri(na),ma=ri(ea);function xa(c){return"\\"+ia[c]}function ya(c,w){return c==null?i:c[w]}function Jn(c){return Qf.test(c)}function Sa(c){return kf.test(c)}function Ea(c){for(var w,_=[];!(w=c.next()).done;)_.push(w.value);return _}function oi(c){var w=-1,_=Array(c.size);return c.forEach(function(I,K){_[++w]=[K,I]}),_}function Zs(c,w){return function(_){return c(w(_))}}function Ln(c,w){for(var _=-1,I=c.length,K=0,et=[];++_<I;){var yt=c[_];(yt===w||yt===D)&&(c[_]=D,et[K++]=_)}return et}function $e(c){var w=-1,_=Array(c.size);return c.forEach(function(I){_[++w]=I}),_}function Aa(c){var w=-1,_=Array(c.size);return c.forEach(function(I){_[++w]=[I,I]}),_}function Ra(c,w,_){for(var I=_-1,K=c.length;++I<K;)if(c[I]===w)return I;return-1}function Ta(c,w,_){for(var I=_+1;I--;)if(c[I]===w)return I;return I}function Qn(c){return Jn(c)?Ma(c):ca(c)}function un(c){return Jn(c)?Ca(c):ha(c)}function Js(c){for(var w=c.length;w--&&vf.test(c.charAt(w)););return w}var La=ri(ra);function Ma(c){for(var w=Jr.lastIndex=0;Jr.test(c);)++w;return w}function Ca(c){return c.match(Jr)||[]}function Ia(c){return c.match(Jf)||[]}var Oa=function c(w){w=w==null?Rt:kn.defaults(Rt.Object(),w,kn.pick(Rt,jf));var _=w.Array,I=w.Date,K=w.Error,et=w.Function,yt=w.Math,at=w.Object,fi=w.RegExp,ba=w.String,Qt=w.TypeError,Xe=_.prototype,Da=et.prototype,jn=at.prototype,Ze=w["__core-js_shared__"],Je=Da.toString,st=jn.hasOwnProperty,Pa=0,Qs=function(){var t=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Qe=jn.toString,Ba=Je.call(at),Wa=Rt._,Ua=fi("^"+Je.call(st).replace(Kr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ke=Ps?w.Buffer:i,Mn=w.Symbol,je=w.Uint8Array,ks=ke?ke.allocUnsafe:i,tr=Zs(at.getPrototypeOf,at),js=at.create,tu=jn.propertyIsEnumerable,nr=Xe.splice,nu=Mn?Mn.isConcatSpreadable:i,me=Mn?Mn.iterator:i,Wn=Mn?Mn.toStringTag:i,er=function(){try{var t=Gn(at,"defineProperty");return t({},"",{}),t}catch{}}(),za=w.clearTimeout!==Rt.clearTimeout&&w.clearTimeout,Fa=I&&I.now!==Rt.Date.now&&I.now,Na=w.setTimeout!==Rt.setTimeout&&w.setTimeout,rr=yt.ceil,ir=yt.floor,ai=at.getOwnPropertySymbols,Ga=ke?ke.isBuffer:i,eu=w.isFinite,Ha=Xe.join,qa=Zs(at.keys,at),St=yt.max,Mt=yt.min,Ka=I.now,Ya=w.parseInt,ru=yt.random,Va=Xe.reverse,li=Gn(w,"DataView"),xe=Gn(w,"Map"),ci=Gn(w,"Promise"),te=Gn(w,"Set"),ye=Gn(w,"WeakMap"),Se=Gn(at,"create"),sr=ye&&new ye,ne={},$a=Hn(li),Xa=Hn(xe),Za=Hn(ci),Ja=Hn(te),Qa=Hn(ye),ur=Mn?Mn.prototype:i,Ee=ur?ur.valueOf:i,iu=ur?ur.toString:i;function u(t){if(pt(t)&&!V(t)&&!(t instanceof k)){if(t instanceof kt)return t;if(st.call(t,"__wrapped__"))return so(t)}return new kt(t)}var ee=function(){function t(){}return function(n){if(!dt(n))return{};if(js)return js(n);t.prototype=n;var e=new t;return t.prototype=i,e}}();function or(){}function kt(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=i}u.templateSettings={escape:cf,evaluate:hf,interpolate:ds,variable:"",imports:{_:u}},u.prototype=or.prototype,u.prototype.constructor=u,kt.prototype=ee(or.prototype),kt.prototype.constructor=kt;function k(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=cn,this.__views__=[]}function ka(){var t=new k(this.__wrapped__);return t.__actions__=Ut(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ut(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ut(this.__views__),t}function ja(){if(this.__filtered__){var t=new k(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function tl(){var t=this.__wrapped__.value(),n=this.__dir__,e=V(t),r=n<0,s=e?t.length:0,f=hc(0,s,this.__views__),a=f.start,l=f.end,h=l-a,m=r?l:a-1,x=this.__iteratees__,y=x.length,L=0,b=Mt(h,this.__takeCount__);if(!e||!r&&s==h&&b==h)return Mu(t,this.__actions__);var H=[];t:for(;h--&&L<b;){m+=n;for(var X=-1,q=t[m];++X<y;){var Q=x[X],tt=Q.iteratee,Vt=Q.type,Wt=tt(q);if(Vt==P)q=Wt;else if(!Wt){if(Vt==T)continue t;break t}}H[L++]=q}return H}k.prototype=ee(or.prototype),k.prototype.constructor=k;function Un(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function nl(){this.__data__=Se?Se(null):{},this.size=0}function el(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function rl(t){var n=this.__data__;if(Se){var e=n[t];return e===W?i:e}return st.call(n,t)?n[t]:i}function il(t){var n=this.__data__;return Se?n[t]!==i:st.call(n,t)}function sl(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Se&&n===i?W:n,this}Un.prototype.clear=nl,Un.prototype.delete=el,Un.prototype.get=rl,Un.prototype.has=il,Un.prototype.set=sl;function pn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function ul(){this.__data__=[],this.size=0}function ol(t){var n=this.__data__,e=fr(n,t);if(e<0)return!1;var r=n.length-1;return e==r?n.pop():nr.call(n,e,1),--this.size,!0}function fl(t){var n=this.__data__,e=fr(n,t);return e<0?i:n[e][1]}function al(t){return fr(this.__data__,t)>-1}function ll(t,n){var e=this.__data__,r=fr(e,t);return r<0?(++this.size,e.push([t,n])):e[r][1]=n,this}pn.prototype.clear=ul,pn.prototype.delete=ol,pn.prototype.get=fl,pn.prototype.has=al,pn.prototype.set=ll;function vn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}function cl(){this.size=0,this.__data__={hash:new Un,map:new(xe||pn),string:new Un}}function hl(t){var n=xr(this,t).delete(t);return this.size-=n?1:0,n}function dl(t){return xr(this,t).get(t)}function gl(t){return xr(this,t).has(t)}function _l(t,n){var e=xr(this,t),r=e.size;return e.set(t,n),this.size+=e.size==r?0:1,this}vn.prototype.clear=cl,vn.prototype.delete=hl,vn.prototype.get=dl,vn.prototype.has=gl,vn.prototype.set=_l;function zn(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new vn;++n<e;)this.add(t[n])}function pl(t){return this.__data__.set(t,W),this}function vl(t){return this.__data__.has(t)}zn.prototype.add=zn.prototype.push=pl,zn.prototype.has=vl;function on(t){var n=this.__data__=new pn(t);this.size=n.size}function wl(){this.__data__=new pn,this.size=0}function ml(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}function xl(t){return this.__data__.get(t)}function yl(t){return this.__data__.has(t)}function Sl(t,n){var e=this.__data__;if(e instanceof pn){var r=e.__data__;if(!xe||r.length<v-1)return r.push([t,n]),this.size=++e.size,this;e=this.__data__=new vn(r)}return e.set(t,n),this.size=e.size,this}on.prototype.clear=wl,on.prototype.delete=ml,on.prototype.get=xl,on.prototype.has=yl,on.prototype.set=Sl;function su(t,n){var e=V(t),r=!e&&qn(t),s=!e&&!r&&Dn(t),f=!e&&!r&&!s&&ue(t),a=e||r||s||f,l=a?si(t.length,ba):[],h=l.length;for(var m in t)(n||st.call(t,m))&&!(a&&(m=="length"||s&&(m=="offset"||m=="parent")||f&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||yn(m,h)))&&l.push(m);return l}function uu(t){var n=t.length;return n?t[Si(0,n-1)]:i}function El(t,n){return yr(Ut(t),Fn(n,0,t.length))}function Al(t){return yr(Ut(t))}function hi(t,n,e){(e!==i&&!fn(t[n],e)||e===i&&!(n in t))&&wn(t,n,e)}function Ae(t,n,e){var r=t[n];(!(st.call(t,n)&&fn(r,e))||e===i&&!(n in t))&&wn(t,n,e)}function fr(t,n){for(var e=t.length;e--;)if(fn(t[e][0],n))return e;return-1}function Rl(t,n,e,r){return Cn(t,function(s,f,a){n(r,s,e(s),a)}),r}function ou(t,n){return t&&dn(n,Et(n),t)}function Tl(t,n){return t&&dn(n,Ft(n),t)}function wn(t,n,e){n=="__proto__"&&er?er(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function di(t,n){for(var e=-1,r=n.length,s=_(r),f=t==null;++e<r;)s[e]=f?i:$i(t,n[e]);return s}function Fn(t,n,e){return t===t&&(e!==i&&(t=t<=e?t:e),n!==i&&(t=t>=n?t:n)),t}function jt(t,n,e,r,s,f){var a,l=n&C,h=n&J,m=n&ut;if(e&&(a=s?e(t,r,s,f):e(t)),a!==i)return a;if(!dt(t))return t;var x=V(t);if(x){if(a=gc(t),!l)return Ut(t,a)}else{var y=Ct(t),L=y==Ne||y==as;if(Dn(t))return Ou(t,l);if(y==_n||y==Vn||L&&!s){if(a=h||L?{}:Ju(t),!l)return h?rc(t,Tl(a,t)):ec(t,ou(a,t))}else{if(!lt[y])return s?t:{};a=_c(t,y,l)}}f||(f=new on);var b=f.get(t);if(b)return b;f.set(t,a),To(t)?t.forEach(function(q){a.add(jt(q,n,e,q,t,f))}):Ao(t)&&t.forEach(function(q,Q){a.set(Q,jt(q,n,e,Q,t,f))});var H=m?h?Di:bi:h?Ft:Et,X=x?i:H(t);return Jt(X||t,function(q,Q){X&&(Q=q,q=t[Q]),Ae(a,Q,jt(q,n,e,Q,t,f))}),a}function Ll(t){var n=Et(t);return function(e){return fu(e,t,n)}}function fu(t,n,e){var r=e.length;if(t==null)return!r;for(t=at(t);r--;){var s=e[r],f=n[s],a=t[s];if(a===i&&!(s in t)||!f(a))return!1}return!0}function au(t,n,e){if(typeof t!="function")throw new Qt(S);return Oe(function(){t.apply(i,e)},n)}function Re(t,n,e,r){var s=-1,f=Ye,a=!0,l=t.length,h=[],m=n.length;if(!l)return h;e&&(n=ht(n,qt(e))),r?(f=jr,a=!1):n.length>=v&&(f=we,a=!1,n=new zn(n));t:for(;++s<l;){var x=t[s],y=e==null?x:e(x);if(x=r||x!==0?x:0,a&&y===y){for(var L=m;L--;)if(n[L]===y)continue t;h.push(x)}else f(n,y,r)||h.push(x)}return h}var Cn=Wu(hn),lu=Wu(_i,!0);function Ml(t,n){var e=!0;return Cn(t,function(r,s,f){return e=!!n(r,s,f),e}),e}function ar(t,n,e){for(var r=-1,s=t.length;++r<s;){var f=t[r],a=n(f);if(a!=null&&(l===i?a===a&&!Yt(a):e(a,l)))var l=a,h=f}return h}function Cl(t,n,e,r){var s=t.length;for(e=$(e),e<0&&(e=-e>s?0:s+e),r=r===i||r>s?s:$(r),r<0&&(r+=s),r=e>r?0:Mo(r);e<r;)t[e++]=n;return t}function cu(t,n){var e=[];return Cn(t,function(r,s,f){n(r,s,f)&&e.push(r)}),e}function Tt(t,n,e,r,s){var f=-1,a=t.length;for(e||(e=vc),s||(s=[]);++f<a;){var l=t[f];n>0&&e(l)?n>1?Tt(l,n-1,e,r,s):Tn(s,l):r||(s[s.length]=l)}return s}var gi=Uu(),hu=Uu(!0);function hn(t,n){return t&&gi(t,n,Et)}function _i(t,n){return t&&hu(t,n,Et)}function lr(t,n){return Rn(n,function(e){return Sn(t[e])})}function Nn(t,n){n=On(n,t);for(var e=0,r=n.length;t!=null&&e<r;)t=t[gn(n[e++])];return e&&e==r?t:i}function du(t,n,e){var r=n(t);return V(t)?r:Tn(r,e(t))}function Pt(t){return t==null?t===i?rf:nf:Wn&&Wn in at(t)?cc(t):Ac(t)}function pi(t,n){return t>n}function Il(t,n){return t!=null&&st.call(t,n)}function Ol(t,n){return t!=null&&n in at(t)}function bl(t,n,e){return t>=Mt(n,e)&&t<St(n,e)}function vi(t,n,e){for(var r=e?jr:Ye,s=t[0].length,f=t.length,a=f,l=_(f),h=1/0,m=[];a--;){var x=t[a];a&&n&&(x=ht(x,qt(n))),h=Mt(x.length,h),l[a]=!e&&(n||s>=120&&x.length>=120)?new zn(a&&x):i}x=t[0];var y=-1,L=l[0];t:for(;++y<s&&m.length<h;){var b=x[y],H=n?n(b):b;if(b=e||b!==0?b:0,!(L?we(L,H):r(m,H,e))){for(a=f;--a;){var X=l[a];if(!(X?we(X,H):r(t[a],H,e)))continue t}L&&L.push(H),m.push(b)}}return m}function Dl(t,n,e,r){return hn(t,function(s,f,a){n(r,e(s),f,a)}),r}function Te(t,n,e){n=On(n,t),t=to(t,n);var r=t==null?t:t[gn(nn(n))];return r==null?i:Ht(r,t,e)}function gu(t){return pt(t)&&Pt(t)==Vn}function Pl(t){return pt(t)&&Pt(t)==ve}function Bl(t){return pt(t)&&Pt(t)==he}function Le(t,n,e,r,s){return t===n?!0:t==null||n==null||!pt(t)&&!pt(n)?t!==t&&n!==n:Wl(t,n,e,r,Le,s)}function Wl(t,n,e,r,s,f){var a=V(t),l=V(n),h=a?ze:Ct(t),m=l?ze:Ct(n);h=h==Vn?_n:h,m=m==Vn?_n:m;var x=h==_n,y=m==_n,L=h==m;if(L&&Dn(t)){if(!Dn(n))return!1;a=!0,x=!1}if(L&&!x)return f||(f=new on),a||ue(t)?$u(t,n,e,r,s,f):ac(t,n,h,e,r,s,f);if(!(e&gt)){var b=x&&st.call(t,"__wrapped__"),H=y&&st.call(n,"__wrapped__");if(b||H){var X=b?t.value():t,q=H?n.value():n;return f||(f=new on),s(X,q,e,r,f)}}return L?(f||(f=new on),lc(t,n,e,r,s,f)):!1}function Ul(t){return pt(t)&&Ct(t)==rn}function wi(t,n,e,r){var s=e.length,f=s,a=!r;if(t==null)return!f;for(t=at(t);s--;){var l=e[s];if(a&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<f;){l=e[s];var h=l[0],m=t[h],x=l[1];if(a&&l[2]){if(m===i&&!(h in t))return!1}else{var y=new on;if(r)var L=r(m,x,h,t,n,y);if(!(L===i?Le(x,m,gt|nt,r,y):L))return!1}}return!0}function _u(t){if(!dt(t)||mc(t))return!1;var n=Sn(t)?Ua:Lf;return n.test(Hn(t))}function zl(t){return pt(t)&&Pt(t)==ge}function Fl(t){return pt(t)&&Ct(t)==sn}function Nl(t){return pt(t)&&Lr(t.length)&&!!ct[Pt(t)]}function pu(t){return typeof t=="function"?t:t==null?Nt:typeof t=="object"?V(t)?mu(t[0],t[1]):wu(t):Fo(t)}function mi(t){if(!Ie(t))return qa(t);var n=[];for(var e in at(t))st.call(t,e)&&e!="constructor"&&n.push(e);return n}function Gl(t){if(!dt(t))return Ec(t);var n=Ie(t),e=[];for(var r in t)r=="constructor"&&(n||!st.call(t,r))||e.push(r);return e}function xi(t,n){return t<n}function vu(t,n){var e=-1,r=zt(t)?_(t.length):[];return Cn(t,function(s,f,a){r[++e]=n(s,f,a)}),r}function wu(t){var n=Bi(t);return n.length==1&&n[0][2]?ku(n[0][0],n[0][1]):function(e){return e===t||wi(e,t,n)}}function mu(t,n){return Ui(t)&&Qu(n)?ku(gn(t),n):function(e){var r=$i(e,t);return r===i&&r===n?Xi(e,t):Le(n,r,gt|nt)}}function cr(t,n,e,r,s){t!==n&&gi(n,function(f,a){if(s||(s=new on),dt(f))Hl(t,n,a,e,cr,r,s);else{var l=r?r(Fi(t,a),f,a+"",t,n,s):i;l===i&&(l=f),hi(t,a,l)}},Ft)}function Hl(t,n,e,r,s,f,a){var l=Fi(t,e),h=Fi(n,e),m=a.get(h);if(m){hi(t,e,m);return}var x=f?f(l,h,e+"",t,n,a):i,y=x===i;if(y){var L=V(h),b=!L&&Dn(h),H=!L&&!b&&ue(h);x=h,L||b||H?V(l)?x=l:mt(l)?x=Ut(l):b?(y=!1,x=Ou(h,!0)):H?(y=!1,x=bu(h,!0)):x=[]:be(h)||qn(h)?(x=l,qn(l)?x=Co(l):(!dt(l)||Sn(l))&&(x=Ju(h))):y=!1}y&&(a.set(h,x),s(x,h,r,f,a),a.delete(h)),hi(t,e,x)}function xu(t,n){var e=t.length;if(e)return n+=n<0?e:0,yn(n,e)?t[n]:i}function yu(t,n,e){n.length?n=ht(n,function(f){return V(f)?function(a){return Nn(a,f.length===1?f[0]:f)}:f}):n=[Nt];var r=-1;n=ht(n,qt(G()));var s=vu(t,function(f,a,l){var h=ht(n,function(m){return m(f)});return{criteria:h,index:++r,value:f}});return _a(s,function(f,a){return nc(f,a,e)})}function ql(t,n){return Su(t,n,function(e,r){return Xi(t,r)})}function Su(t,n,e){for(var r=-1,s=n.length,f={};++r<s;){var a=n[r],l=Nn(t,a);e(l,a)&&Me(f,On(a,t),l)}return f}function Kl(t){return function(n){return Nn(n,t)}}function yi(t,n,e,r){var s=r?ga:Zn,f=-1,a=n.length,l=t;for(t===n&&(n=Ut(n)),e&&(l=ht(t,qt(e)));++f<a;)for(var h=0,m=n[f],x=e?e(m):m;(h=s(l,x,h,r))>-1;)l!==t&&nr.call(l,h,1),nr.call(t,h,1);return t}function Eu(t,n){for(var e=t?n.length:0,r=e-1;e--;){var s=n[e];if(e==r||s!==f){var f=s;yn(s)?nr.call(t,s,1):Ri(t,s)}}return t}function Si(t,n){return t+ir(ru()*(n-t+1))}function Yl(t,n,e,r){for(var s=-1,f=St(rr((n-t)/(e||1)),0),a=_(f);f--;)a[r?f:++s]=t,t+=e;return a}function Ei(t,n){var e="";if(!t||n<1||n>F)return e;do n%2&&(e+=t),n=ir(n/2),n&&(t+=t);while(n);return e}function Z(t,n){return Ni(ju(t,n,Nt),t+"")}function Vl(t){return uu(oe(t))}function $l(t,n){var e=oe(t);return yr(e,Fn(n,0,e.length))}function Me(t,n,e,r){if(!dt(t))return t;n=On(n,t);for(var s=-1,f=n.length,a=f-1,l=t;l!=null&&++s<f;){var h=gn(n[s]),m=e;if(h==="__proto__"||h==="constructor"||h==="prototype")return t;if(s!=a){var x=l[h];m=r?r(x,h,l):i,m===i&&(m=dt(x)?x:yn(n[s+1])?[]:{})}Ae(l,h,m),l=l[h]}return t}var Au=sr?function(t,n){return sr.set(t,n),t}:Nt,Xl=er?function(t,n){return er(t,"toString",{configurable:!0,enumerable:!1,value:Ji(n),writable:!0})}:Nt;function Zl(t){return yr(oe(t))}function tn(t,n,e){var r=-1,s=t.length;n<0&&(n=-n>s?0:s+n),e=e>s?s:e,e<0&&(e+=s),s=n>e?0:e-n>>>0,n>>>=0;for(var f=_(s);++r<s;)f[r]=t[r+n];return f}function Jl(t,n){var e;return Cn(t,function(r,s,f){return e=n(r,s,f),!e}),!!e}function hr(t,n,e){var r=0,s=t==null?r:t.length;if(typeof n=="number"&&n===n&&s<=Qo){for(;r<s;){var f=r+s>>>1,a=t[f];a!==null&&!Yt(a)&&(e?a<=n:a<n)?r=f+1:s=f}return s}return Ai(t,n,Nt,e)}function Ai(t,n,e,r){var s=0,f=t==null?0:t.length;if(f===0)return 0;n=e(n);for(var a=n!==n,l=n===null,h=Yt(n),m=n===i;s<f;){var x=ir((s+f)/2),y=e(t[x]),L=y!==i,b=y===null,H=y===y,X=Yt(y);if(a)var q=r||H;else m?q=H&&(r||L):l?q=H&&L&&(r||!b):h?q=H&&L&&!b&&(r||!X):b||X?q=!1:q=r?y<=n:y<n;q?s=x+1:f=x}return Mt(f,Jo)}function Ru(t,n){for(var e=-1,r=t.length,s=0,f=[];++e<r;){var a=t[e],l=n?n(a):a;if(!e||!fn(l,h)){var h=l;f[s++]=a===0?0:a}}return f}function Tu(t){return typeof t=="number"?t:Yt(t)?Yn:+t}function Kt(t){if(typeof t=="string")return t;if(V(t))return ht(t,Kt)+"";if(Yt(t))return iu?iu.call(t):"";var n=t+"";return n=="0"&&1/t==-z?"-0":n}function In(t,n,e){var r=-1,s=Ye,f=t.length,a=!0,l=[],h=l;if(e)a=!1,s=jr;else if(f>=v){var m=n?null:oc(t);if(m)return $e(m);a=!1,s=we,h=new zn}else h=n?[]:l;t:for(;++r<f;){var x=t[r],y=n?n(x):x;if(x=e||x!==0?x:0,a&&y===y){for(var L=h.length;L--;)if(h[L]===y)continue t;n&&h.push(y),l.push(x)}else s(h,y,e)||(h!==l&&h.push(y),l.push(x))}return l}function Ri(t,n){return n=On(n,t),t=to(t,n),t==null||delete t[gn(nn(n))]}function Lu(t,n,e,r){return Me(t,n,e(Nn(t,n)),r)}function dr(t,n,e,r){for(var s=t.length,f=r?s:-1;(r?f--:++f<s)&&n(t[f],f,t););return e?tn(t,r?0:f,r?f+1:s):tn(t,r?f+1:0,r?s:f)}function Mu(t,n){var e=t;return e instanceof k&&(e=e.value()),ti(n,function(r,s){return s.func.apply(s.thisArg,Tn([r],s.args))},e)}function Ti(t,n,e){var r=t.length;if(r<2)return r?In(t[0]):[];for(var s=-1,f=_(r);++s<r;)for(var a=t[s],l=-1;++l<r;)l!=s&&(f[s]=Re(f[s]||a,t[l],n,e));return In(Tt(f,1),n,e)}function Cu(t,n,e){for(var r=-1,s=t.length,f=n.length,a={};++r<s;){var l=r<f?n[r]:i;e(a,t[r],l)}return a}function Li(t){return mt(t)?t:[]}function Mi(t){return typeof t=="function"?t:Nt}function On(t,n){return V(t)?t:Ui(t,n)?[t]:io(rt(t))}var Ql=Z;function bn(t,n,e){var r=t.length;return e=e===i?r:e,!n&&e>=r?t:tn(t,n,e)}var Iu=za||function(t){return Rt.clearTimeout(t)};function Ou(t,n){if(n)return t.slice();var e=t.length,r=ks?ks(e):new t.constructor(e);return t.copy(r),r}function Ci(t){var n=new t.constructor(t.byteLength);return new je(n).set(new je(t)),n}function kl(t,n){var e=n?Ci(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function jl(t){var n=new t.constructor(t.source,gs.exec(t));return n.lastIndex=t.lastIndex,n}function tc(t){return Ee?at(Ee.call(t)):{}}function bu(t,n){var e=n?Ci(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function Du(t,n){if(t!==n){var e=t!==i,r=t===null,s=t===t,f=Yt(t),a=n!==i,l=n===null,h=n===n,m=Yt(n);if(!l&&!m&&!f&&t>n||f&&a&&h&&!l&&!m||r&&a&&h||!e&&h||!s)return 1;if(!r&&!f&&!m&&t<n||m&&e&&s&&!r&&!f||l&&e&&s||!a&&s||!h)return-1}return 0}function nc(t,n,e){for(var r=-1,s=t.criteria,f=n.criteria,a=s.length,l=e.length;++r<a;){var h=Du(s[r],f[r]);if(h){if(r>=l)return h;var m=e[r];return h*(m=="desc"?-1:1)}}return t.index-n.index}function Pu(t,n,e,r){for(var s=-1,f=t.length,a=e.length,l=-1,h=n.length,m=St(f-a,0),x=_(h+m),y=!r;++l<h;)x[l]=n[l];for(;++s<a;)(y||s<f)&&(x[e[s]]=t[s]);for(;m--;)x[l++]=t[s++];return x}function Bu(t,n,e,r){for(var s=-1,f=t.length,a=-1,l=e.length,h=-1,m=n.length,x=St(f-l,0),y=_(x+m),L=!r;++s<x;)y[s]=t[s];for(var b=s;++h<m;)y[b+h]=n[h];for(;++a<l;)(L||s<f)&&(y[b+e[a]]=t[s++]);return y}function Ut(t,n){var e=-1,r=t.length;for(n||(n=_(r));++e<r;)n[e]=t[e];return n}function dn(t,n,e,r){var s=!e;e||(e={});for(var f=-1,a=n.length;++f<a;){var l=n[f],h=r?r(e[l],t[l],l,e,t):i;h===i&&(h=t[l]),s?wn(e,l,h):Ae(e,l,h)}return e}function ec(t,n){return dn(t,Wi(t),n)}function rc(t,n){return dn(t,Xu(t),n)}function gr(t,n){return function(e,r){var s=V(e)?fa:Rl,f=n?n():{};return s(e,t,G(r,2),f)}}function re(t){return Z(function(n,e){var r=-1,s=e.length,f=s>1?e[s-1]:i,a=s>2?e[2]:i;for(f=t.length>3&&typeof f=="function"?(s--,f):i,a&&Bt(e[0],e[1],a)&&(f=s<3?i:f,s=1),n=at(n);++r<s;){var l=e[r];l&&t(n,l,r,f)}return n})}function Wu(t,n){return function(e,r){if(e==null)return e;if(!zt(e))return t(e,r);for(var s=e.length,f=n?s:-1,a=at(e);(n?f--:++f<s)&&r(a[f],f,a)!==!1;);return e}}function Uu(t){return function(n,e,r){for(var s=-1,f=at(n),a=r(n),l=a.length;l--;){var h=a[t?l:++s];if(e(f[h],h,f)===!1)break}return n}}function ic(t,n,e){var r=n&it,s=Ce(t);function f(){var a=this&&this!==Rt&&this instanceof f?s:t;return a.apply(r?e:this,arguments)}return f}function zu(t){return function(n){n=rt(n);var e=Jn(n)?un(n):i,r=e?e[0]:n.charAt(0),s=e?bn(e,1).join(""):n.slice(1);return r[t]()+s}}function ie(t){return function(n){return ti(Uo(Wo(n).replace(Xf,"")),t,"")}}function Ce(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=ee(t.prototype),r=t.apply(e,n);return dt(r)?r:e}}function sc(t,n,e){var r=Ce(t);function s(){for(var f=arguments.length,a=_(f),l=f,h=se(s);l--;)a[l]=arguments[l];var m=f<3&&a[0]!==h&&a[f-1]!==h?[]:Ln(a,h);if(f-=m.length,f<e)return qu(t,n,_r,s.placeholder,i,a,m,i,i,e-f);var x=this&&this!==Rt&&this instanceof s?r:t;return Ht(x,this,a)}return s}function Fu(t){return function(n,e,r){var s=at(n);if(!zt(n)){var f=G(e,3);n=Et(n),e=function(l){return f(s[l],l,s)}}var a=t(n,e,r);return a>-1?s[f?n[a]:a]:i}}function Nu(t){return xn(function(n){var e=n.length,r=e,s=kt.prototype.thru;for(t&&n.reverse();r--;){var f=n[r];if(typeof f!="function")throw new Qt(S);if(s&&!a&&mr(f)=="wrapper")var a=new kt([],!0)}for(r=a?r:e;++r<e;){f=n[r];var l=mr(f),h=l=="wrapper"?Pi(f):i;h&&zi(h[0])&&h[1]==(Dt|_t|bt|A)&&!h[4].length&&h[9]==1?a=a[mr(h[0])].apply(a,h[3]):a=f.length==1&&zi(f)?a[l]():a.thru(f)}return function(){var m=arguments,x=m[0];if(a&&m.length==1&&V(x))return a.plant(x).value();for(var y=0,L=e?n[y].apply(this,m):x;++y<e;)L=n[y].call(this,L);return L}})}function _r(t,n,e,r,s,f,a,l,h,m){var x=n&Dt,y=n&it,L=n&Y,b=n&(_t|Ot),H=n&O,X=L?i:Ce(t);function q(){for(var Q=arguments.length,tt=_(Q),Vt=Q;Vt--;)tt[Vt]=arguments[Vt];if(b)var Wt=se(q),$t=va(tt,Wt);if(r&&(tt=Pu(tt,r,s,b)),f&&(tt=Bu(tt,f,a,b)),Q-=$t,b&&Q<m){var xt=Ln(tt,Wt);return qu(t,n,_r,q.placeholder,e,tt,xt,l,h,m-Q)}var an=y?e:this,An=L?an[t]:t;return Q=tt.length,l?tt=Rc(tt,l):H&&Q>1&&tt.reverse(),x&&h<Q&&(tt.length=h),this&&this!==Rt&&this instanceof q&&(An=X||Ce(An)),An.apply(an,tt)}return q}function Gu(t,n){return function(e,r){return Dl(e,t,n(r),{})}}function pr(t,n){return function(e,r){var s;if(e===i&&r===i)return n;if(e!==i&&(s=e),r!==i){if(s===i)return r;typeof e=="string"||typeof r=="string"?(e=Kt(e),r=Kt(r)):(e=Tu(e),r=Tu(r)),s=t(e,r)}return s}}function Ii(t){return xn(function(n){return n=ht(n,qt(G())),Z(function(e){var r=this;return t(n,function(s){return Ht(s,r,e)})})})}function vr(t,n){n=n===i?" ":Kt(n);var e=n.length;if(e<2)return e?Ei(n,t):n;var r=Ei(n,rr(t/Qn(n)));return Jn(n)?bn(un(r),0,t).join(""):r.slice(0,t)}function uc(t,n,e,r){var s=n&it,f=Ce(t);function a(){for(var l=-1,h=arguments.length,m=-1,x=r.length,y=_(x+h),L=this&&this!==Rt&&this instanceof a?f:t;++m<x;)y[m]=r[m];for(;h--;)y[m++]=arguments[++l];return Ht(L,s?e:this,y)}return a}function Hu(t){return function(n,e,r){return r&&typeof r!="number"&&Bt(n,e,r)&&(e=r=i),n=En(n),e===i?(e=n,n=0):e=En(e),r=r===i?n<e?1:-1:En(r),Yl(n,e,r,t)}}function wr(t){return function(n,e){return typeof n=="string"&&typeof e=="string"||(n=en(n),e=en(e)),t(n,e)}}function qu(t,n,e,r,s,f,a,l,h,m){var x=n&_t,y=x?a:i,L=x?i:a,b=x?f:i,H=x?i:f;n|=x?bt:Gt,n&=~(x?Gt:bt),n&ot||(n&=~(it|Y));var X=[t,n,s,b,y,H,L,l,h,m],q=e.apply(i,X);return zi(t)&&no(q,X),q.placeholder=r,eo(q,t,n)}function Oi(t){var n=yt[t];return function(e,r){if(e=en(e),r=r==null?0:Mt($(r),292),r&&eu(e)){var s=(rt(e)+"e").split("e"),f=n(s[0]+"e"+(+s[1]+r));return s=(rt(f)+"e").split("e"),+(s[0]+"e"+(+s[1]-r))}return n(e)}}var oc=te&&1/$e(new te([,-0]))[1]==z?function(t){return new te(t)}:ji;function Ku(t){return function(n){var e=Ct(n);return e==rn?oi(n):e==sn?Aa(n):pa(n,t(n))}}function mn(t,n,e,r,s,f,a,l){var h=n&Y;if(!h&&typeof t!="function")throw new Qt(S);var m=r?r.length:0;if(m||(n&=~(bt|Gt),r=s=i),a=a===i?a:St($(a),0),l=l===i?l:$(l),m-=s?s.length:0,n&Gt){var x=r,y=s;r=s=i}var L=h?i:Pi(t),b=[t,n,e,r,s,x,y,f,a,l];if(L&&Sc(b,L),t=b[0],n=b[1],e=b[2],r=b[3],s=b[4],l=b[9]=b[9]===i?h?0:t.length:St(b[9]-m,0),!l&&n&(_t|Ot)&&(n&=~(_t|Ot)),!n||n==it)var H=ic(t,n,e);else n==_t||n==Ot?H=sc(t,n,l):(n==bt||n==(it|bt))&&!s.length?H=uc(t,n,e,r):H=_r.apply(i,b);var X=L?Au:no;return eo(X(H,b),t,n)}function Yu(t,n,e,r){return t===i||fn(t,jn[e])&&!st.call(r,e)?n:t}function Vu(t,n,e,r,s,f){return dt(t)&&dt(n)&&(f.set(n,t),cr(t,n,i,Vu,f),f.delete(n)),t}function fc(t){return be(t)?i:t}function $u(t,n,e,r,s,f){var a=e&gt,l=t.length,h=n.length;if(l!=h&&!(a&&h>l))return!1;var m=f.get(t),x=f.get(n);if(m&&x)return m==n&&x==t;var y=-1,L=!0,b=e&nt?new zn:i;for(f.set(t,n),f.set(n,t);++y<l;){var H=t[y],X=n[y];if(r)var q=a?r(X,H,y,n,t,f):r(H,X,y,t,n,f);if(q!==i){if(q)continue;L=!1;break}if(b){if(!ni(n,function(Q,tt){if(!we(b,tt)&&(H===Q||s(H,Q,e,r,f)))return b.push(tt)})){L=!1;break}}else if(!(H===X||s(H,X,e,r,f))){L=!1;break}}return f.delete(t),f.delete(n),L}function ac(t,n,e,r,s,f,a){switch(e){case $n:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case ve:return!(t.byteLength!=n.byteLength||!f(new je(t),new je(n)));case ce:case he:case de:return fn(+t,+n);case Fe:return t.name==n.name&&t.message==n.message;case ge:case _e:return t==n+"";case rn:var l=oi;case sn:var h=r&gt;if(l||(l=$e),t.size!=n.size&&!h)return!1;var m=a.get(t);if(m)return m==n;r|=nt,a.set(t,n);var x=$u(l(t),l(n),r,s,f,a);return a.delete(t),x;case Ge:if(Ee)return Ee.call(t)==Ee.call(n)}return!1}function lc(t,n,e,r,s,f){var a=e&gt,l=bi(t),h=l.length,m=bi(n),x=m.length;if(h!=x&&!a)return!1;for(var y=h;y--;){var L=l[y];if(!(a?L in n:st.call(n,L)))return!1}var b=f.get(t),H=f.get(n);if(b&&H)return b==n&&H==t;var X=!0;f.set(t,n),f.set(n,t);for(var q=a;++y<h;){L=l[y];var Q=t[L],tt=n[L];if(r)var Vt=a?r(tt,Q,L,n,t,f):r(Q,tt,L,t,n,f);if(!(Vt===i?Q===tt||s(Q,tt,e,r,f):Vt)){X=!1;break}q||(q=L=="constructor")}if(X&&!q){var Wt=t.constructor,$t=n.constructor;Wt!=$t&&"constructor"in t&&"constructor"in n&&!(typeof Wt=="function"&&Wt instanceof Wt&&typeof $t=="function"&&$t instanceof $t)&&(X=!1)}return f.delete(t),f.delete(n),X}function xn(t){return Ni(ju(t,i,fo),t+"")}function bi(t){return du(t,Et,Wi)}function Di(t){return du(t,Ft,Xu)}var Pi=sr?function(t){return sr.get(t)}:ji;function mr(t){for(var n=t.name+"",e=ne[n],r=st.call(ne,n)?e.length:0;r--;){var s=e[r],f=s.func;if(f==null||f==t)return s.name}return n}function se(t){var n=st.call(u,"placeholder")?u:t;return n.placeholder}function G(){var t=u.iteratee||Qi;return t=t===Qi?pu:t,arguments.length?t(arguments[0],arguments[1]):t}function xr(t,n){var e=t.__data__;return wc(n)?e[typeof n=="string"?"string":"hash"]:e.map}function Bi(t){for(var n=Et(t),e=n.length;e--;){var r=n[e],s=t[r];n[e]=[r,s,Qu(s)]}return n}function Gn(t,n){var e=ya(t,n);return _u(e)?e:i}function cc(t){var n=st.call(t,Wn),e=t[Wn];try{t[Wn]=i;var r=!0}catch{}var s=Qe.call(t);return r&&(n?t[Wn]=e:delete t[Wn]),s}var Wi=ai?function(t){return t==null?[]:(t=at(t),Rn(ai(t),function(n){return tu.call(t,n)}))}:ts,Xu=ai?function(t){for(var n=[];t;)Tn(n,Wi(t)),t=tr(t);return n}:ts,Ct=Pt;(li&&Ct(new li(new ArrayBuffer(1)))!=$n||xe&&Ct(new xe)!=rn||ci&&Ct(ci.resolve())!=ls||te&&Ct(new te)!=sn||ye&&Ct(new ye)!=pe)&&(Ct=function(t){var n=Pt(t),e=n==_n?t.constructor:i,r=e?Hn(e):"";if(r)switch(r){case $a:return $n;case Xa:return rn;case Za:return ls;case Ja:return sn;case Qa:return pe}return n});function hc(t,n,e){for(var r=-1,s=e.length;++r<s;){var f=e[r],a=f.size;switch(f.type){case"drop":t+=a;break;case"dropRight":n-=a;break;case"take":n=Mt(n,t+a);break;case"takeRight":t=St(t,n-a);break}}return{start:t,end:n}}function dc(t){var n=t.match(mf);return n?n[1].split(xf):[]}function Zu(t,n,e){n=On(n,t);for(var r=-1,s=n.length,f=!1;++r<s;){var a=gn(n[r]);if(!(f=t!=null&&e(t,a)))break;t=t[a]}return f||++r!=s?f:(s=t==null?0:t.length,!!s&&Lr(s)&&yn(a,s)&&(V(t)||qn(t)))}function gc(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&st.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function Ju(t){return typeof t.constructor=="function"&&!Ie(t)?ee(tr(t)):{}}function _c(t,n,e){var r=t.constructor;switch(n){case ve:return Ci(t);case ce:case he:return new r(+t);case $n:return kl(t,e);case Br:case Wr:case Ur:case zr:case Fr:case Nr:case Gr:case Hr:case qr:return bu(t,e);case rn:return new r;case de:case _e:return new r(t);case ge:return jl(t);case sn:return new r;case Ge:return tc(t)}}function pc(t,n){var e=n.length;if(!e)return t;var r=e-1;return n[r]=(e>1?"& ":"")+n[r],n=n.join(e>2?", ":" "),t.replace(wf,`{
/* [wrapped with `+n+`] */
`)}function vc(t){return V(t)||qn(t)||!!(nu&&t&&t[nu])}function yn(t,n){var e=typeof t;return n=n??F,!!n&&(e=="number"||e!="symbol"&&Cf.test(t))&&t>-1&&t%1==0&&t<n}function Bt(t,n,e){if(!dt(e))return!1;var r=typeof n;return(r=="number"?zt(e)&&yn(n,e.length):r=="string"&&n in e)?fn(e[n],t):!1}function Ui(t,n){if(V(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||Yt(t)?!0:gf.test(t)||!df.test(t)||n!=null&&t in at(n)}function wc(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function zi(t){var n=mr(t),e=u[n];if(typeof e!="function"||!(n in k.prototype))return!1;if(t===e)return!0;var r=Pi(e);return!!r&&t===r[0]}function mc(t){return!!Qs&&Qs in t}var xc=Ze?Sn:ns;function Ie(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||jn;return t===e}function Qu(t){return t===t&&!dt(t)}function ku(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==i||t in at(e))}}function yc(t){var n=Rr(t,function(r){return e.size===N&&e.clear(),r}),e=n.cache;return n}function Sc(t,n){var e=t[1],r=n[1],s=e|r,f=s<(it|Y|Dt),a=r==Dt&&e==_t||r==Dt&&e==A&&t[7].length<=n[8]||r==(Dt|A)&&n[7].length<=n[8]&&e==_t;if(!(f||a))return t;r&it&&(t[2]=n[2],s|=e&it?0:ot);var l=n[3];if(l){var h=t[3];t[3]=h?Pu(h,l,n[4]):l,t[4]=h?Ln(t[3],D):n[4]}return l=n[5],l&&(h=t[5],t[5]=h?Bu(h,l,n[6]):l,t[6]=h?Ln(t[5],D):n[6]),l=n[7],l&&(t[7]=l),r&Dt&&(t[8]=t[8]==null?n[8]:Mt(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=s,t}function Ec(t){var n=[];if(t!=null)for(var e in at(t))n.push(e);return n}function Ac(t){return Qe.call(t)}function ju(t,n,e){return n=St(n===i?t.length-1:n,0),function(){for(var r=arguments,s=-1,f=St(r.length-n,0),a=_(f);++s<f;)a[s]=r[n+s];s=-1;for(var l=_(n+1);++s<n;)l[s]=r[s];return l[n]=e(a),Ht(t,this,l)}}function to(t,n){return n.length<2?t:Nn(t,tn(n,0,-1))}function Rc(t,n){for(var e=t.length,r=Mt(n.length,e),s=Ut(t);r--;){var f=n[r];t[r]=yn(f,e)?s[f]:i}return t}function Fi(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var no=ro(Au),Oe=Na||function(t,n){return Rt.setTimeout(t,n)},Ni=ro(Xl);function eo(t,n,e){var r=n+"";return Ni(t,pc(r,Tc(dc(r),e)))}function ro(t){var n=0,e=0;return function(){var r=Ka(),s=E-(r-e);if(e=r,s>0){if(++n>=R)return arguments[0]}else n=0;return t.apply(i,arguments)}}function yr(t,n){var e=-1,r=t.length,s=r-1;for(n=n===i?r:n;++e<n;){var f=Si(e,s),a=t[f];t[f]=t[e],t[e]=a}return t.length=n,t}var io=yc(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(_f,function(e,r,s,f){n.push(s?f.replace(Ef,"$1"):r||e)}),n});function gn(t){if(typeof t=="string"||Yt(t))return t;var n=t+"";return n=="0"&&1/t==-z?"-0":n}function Hn(t){if(t!=null){try{return Je.call(t)}catch{}try{return t+""}catch{}}return""}function Tc(t,n){return Jt(ko,function(e){var r="_."+e[0];n&e[1]&&!Ye(t,r)&&t.push(r)}),t.sort()}function so(t){if(t instanceof k)return t.clone();var n=new kt(t.__wrapped__,t.__chain__);return n.__actions__=Ut(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function Lc(t,n,e){(e?Bt(t,n,e):n===i)?n=1:n=St($(n),0);var r=t==null?0:t.length;if(!r||n<1)return[];for(var s=0,f=0,a=_(rr(r/n));s<r;)a[f++]=tn(t,s,s+=n);return a}function Mc(t){for(var n=-1,e=t==null?0:t.length,r=0,s=[];++n<e;){var f=t[n];f&&(s[r++]=f)}return s}function Cc(){var t=arguments.length;if(!t)return[];for(var n=_(t-1),e=arguments[0],r=t;r--;)n[r-1]=arguments[r];return Tn(V(e)?Ut(e):[e],Tt(n,1))}var Ic=Z(function(t,n){return mt(t)?Re(t,Tt(n,1,mt,!0)):[]}),Oc=Z(function(t,n){var e=nn(n);return mt(e)&&(e=i),mt(t)?Re(t,Tt(n,1,mt,!0),G(e,2)):[]}),bc=Z(function(t,n){var e=nn(n);return mt(e)&&(e=i),mt(t)?Re(t,Tt(n,1,mt,!0),i,e):[]});function Dc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===i?1:$(n),tn(t,n<0?0:n,r)):[]}function Pc(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===i?1:$(n),n=r-n,tn(t,0,n<0?0:n)):[]}function Bc(t,n){return t&&t.length?dr(t,G(n,3),!0,!0):[]}function Wc(t,n){return t&&t.length?dr(t,G(n,3),!0):[]}function Uc(t,n,e,r){var s=t==null?0:t.length;return s?(e&&typeof e!="number"&&Bt(t,n,e)&&(e=0,r=s),Cl(t,n,e,r)):[]}function uo(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var s=e==null?0:$(e);return s<0&&(s=St(r+s,0)),Ve(t,G(n,3),s)}function oo(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var s=r-1;return e!==i&&(s=$(e),s=e<0?St(r+s,0):Mt(s,r-1)),Ve(t,G(n,3),s,!0)}function fo(t){var n=t==null?0:t.length;return n?Tt(t,1):[]}function zc(t){var n=t==null?0:t.length;return n?Tt(t,z):[]}function Fc(t,n){var e=t==null?0:t.length;return e?(n=n===i?1:$(n),Tt(t,n)):[]}function Nc(t){for(var n=-1,e=t==null?0:t.length,r={};++n<e;){var s=t[n];r[s[0]]=s[1]}return r}function ao(t){return t&&t.length?t[0]:i}function Gc(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var s=e==null?0:$(e);return s<0&&(s=St(r+s,0)),Zn(t,n,s)}function Hc(t){var n=t==null?0:t.length;return n?tn(t,0,-1):[]}var qc=Z(function(t){var n=ht(t,Li);return n.length&&n[0]===t[0]?vi(n):[]}),Kc=Z(function(t){var n=nn(t),e=ht(t,Li);return n===nn(e)?n=i:e.pop(),e.length&&e[0]===t[0]?vi(e,G(n,2)):[]}),Yc=Z(function(t){var n=nn(t),e=ht(t,Li);return n=typeof n=="function"?n:i,n&&e.pop(),e.length&&e[0]===t[0]?vi(e,i,n):[]});function Vc(t,n){return t==null?"":Ha.call(t,n)}function nn(t){var n=t==null?0:t.length;return n?t[n-1]:i}function $c(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var s=r;return e!==i&&(s=$(e),s=s<0?St(r+s,0):Mt(s,r-1)),n===n?Ta(t,n,s):Ve(t,qs,s,!0)}function Xc(t,n){return t&&t.length?xu(t,$(n)):i}var Zc=Z(lo);function lo(t,n){return t&&t.length&&n&&n.length?yi(t,n):t}function Jc(t,n,e){return t&&t.length&&n&&n.length?yi(t,n,G(e,2)):t}function Qc(t,n,e){return t&&t.length&&n&&n.length?yi(t,n,i,e):t}var kc=xn(function(t,n){var e=t==null?0:t.length,r=di(t,n);return Eu(t,ht(n,function(s){return yn(s,e)?+s:s}).sort(Du)),r});function jc(t,n){var e=[];if(!(t&&t.length))return e;var r=-1,s=[],f=t.length;for(n=G(n,3);++r<f;){var a=t[r];n(a,r,t)&&(e.push(a),s.push(r))}return Eu(t,s),e}function Gi(t){return t==null?t:Va.call(t)}function th(t,n,e){var r=t==null?0:t.length;return r?(e&&typeof e!="number"&&Bt(t,n,e)?(n=0,e=r):(n=n==null?0:$(n),e=e===i?r:$(e)),tn(t,n,e)):[]}function nh(t,n){return hr(t,n)}function eh(t,n,e){return Ai(t,n,G(e,2))}function rh(t,n){var e=t==null?0:t.length;if(e){var r=hr(t,n);if(r<e&&fn(t[r],n))return r}return-1}function ih(t,n){return hr(t,n,!0)}function sh(t,n,e){return Ai(t,n,G(e,2),!0)}function uh(t,n){var e=t==null?0:t.length;if(e){var r=hr(t,n,!0)-1;if(fn(t[r],n))return r}return-1}function oh(t){return t&&t.length?Ru(t):[]}function fh(t,n){return t&&t.length?Ru(t,G(n,2)):[]}function ah(t){var n=t==null?0:t.length;return n?tn(t,1,n):[]}function lh(t,n,e){return t&&t.length?(n=e||n===i?1:$(n),tn(t,0,n<0?0:n)):[]}function ch(t,n,e){var r=t==null?0:t.length;return r?(n=e||n===i?1:$(n),n=r-n,tn(t,n<0?0:n,r)):[]}function hh(t,n){return t&&t.length?dr(t,G(n,3),!1,!0):[]}function dh(t,n){return t&&t.length?dr(t,G(n,3)):[]}var gh=Z(function(t){return In(Tt(t,1,mt,!0))}),_h=Z(function(t){var n=nn(t);return mt(n)&&(n=i),In(Tt(t,1,mt,!0),G(n,2))}),ph=Z(function(t){var n=nn(t);return n=typeof n=="function"?n:i,In(Tt(t,1,mt,!0),i,n)});function vh(t){return t&&t.length?In(t):[]}function wh(t,n){return t&&t.length?In(t,G(n,2)):[]}function mh(t,n){return n=typeof n=="function"?n:i,t&&t.length?In(t,i,n):[]}function Hi(t){if(!(t&&t.length))return[];var n=0;return t=Rn(t,function(e){if(mt(e))return n=St(e.length,n),!0}),si(n,function(e){return ht(t,ei(e))})}function co(t,n){if(!(t&&t.length))return[];var e=Hi(t);return n==null?e:ht(e,function(r){return Ht(n,i,r)})}var xh=Z(function(t,n){return mt(t)?Re(t,n):[]}),yh=Z(function(t){return Ti(Rn(t,mt))}),Sh=Z(function(t){var n=nn(t);return mt(n)&&(n=i),Ti(Rn(t,mt),G(n,2))}),Eh=Z(function(t){var n=nn(t);return n=typeof n=="function"?n:i,Ti(Rn(t,mt),i,n)}),Ah=Z(Hi);function Rh(t,n){return Cu(t||[],n||[],Ae)}function Th(t,n){return Cu(t||[],n||[],Me)}var Lh=Z(function(t){var n=t.length,e=n>1?t[n-1]:i;return e=typeof e=="function"?(t.pop(),e):i,co(t,e)});function ho(t){var n=u(t);return n.__chain__=!0,n}function Mh(t,n){return n(t),t}function Sr(t,n){return n(t)}var Ch=xn(function(t){var n=t.length,e=n?t[0]:0,r=this.__wrapped__,s=function(f){return di(f,t)};return n>1||this.__actions__.length||!(r instanceof k)||!yn(e)?this.thru(s):(r=r.slice(e,+e+(n?1:0)),r.__actions__.push({func:Sr,args:[s],thisArg:i}),new kt(r,this.__chain__).thru(function(f){return n&&!f.length&&f.push(i),f}))});function Ih(){return ho(this)}function Oh(){return new kt(this.value(),this.__chain__)}function bh(){this.__values__===i&&(this.__values__=Lo(this.value()));var t=this.__index__>=this.__values__.length,n=t?i:this.__values__[this.__index__++];return{done:t,value:n}}function Dh(){return this}function Ph(t){for(var n,e=this;e instanceof or;){var r=so(e);r.__index__=0,r.__values__=i,n?s.__wrapped__=r:n=r;var s=r;e=e.__wrapped__}return s.__wrapped__=t,n}function Bh(){var t=this.__wrapped__;if(t instanceof k){var n=t;return this.__actions__.length&&(n=new k(this)),n=n.reverse(),n.__actions__.push({func:Sr,args:[Gi],thisArg:i}),new kt(n,this.__chain__)}return this.thru(Gi)}function Wh(){return Mu(this.__wrapped__,this.__actions__)}var Uh=gr(function(t,n,e){st.call(t,e)?++t[e]:wn(t,e,1)});function zh(t,n,e){var r=V(t)?Gs:Ml;return e&&Bt(t,n,e)&&(n=i),r(t,G(n,3))}function Fh(t,n){var e=V(t)?Rn:cu;return e(t,G(n,3))}var Nh=Fu(uo),Gh=Fu(oo);function Hh(t,n){return Tt(Er(t,n),1)}function qh(t,n){return Tt(Er(t,n),z)}function Kh(t,n,e){return e=e===i?1:$(e),Tt(Er(t,n),e)}function go(t,n){var e=V(t)?Jt:Cn;return e(t,G(n,3))}function _o(t,n){var e=V(t)?aa:lu;return e(t,G(n,3))}var Yh=gr(function(t,n,e){st.call(t,e)?t[e].push(n):wn(t,e,[n])});function Vh(t,n,e,r){t=zt(t)?t:oe(t),e=e&&!r?$(e):0;var s=t.length;return e<0&&(e=St(s+e,0)),Mr(t)?e<=s&&t.indexOf(n,e)>-1:!!s&&Zn(t,n,e)>-1}var $h=Z(function(t,n,e){var r=-1,s=typeof n=="function",f=zt(t)?_(t.length):[];return Cn(t,function(a){f[++r]=s?Ht(n,a,e):Te(a,n,e)}),f}),Xh=gr(function(t,n,e){wn(t,e,n)});function Er(t,n){var e=V(t)?ht:vu;return e(t,G(n,3))}function Zh(t,n,e,r){return t==null?[]:(V(n)||(n=n==null?[]:[n]),e=r?i:e,V(e)||(e=e==null?[]:[e]),yu(t,n,e))}var Jh=gr(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]});function Qh(t,n,e){var r=V(t)?ti:Ys,s=arguments.length<3;return r(t,G(n,4),e,s,Cn)}function kh(t,n,e){var r=V(t)?la:Ys,s=arguments.length<3;return r(t,G(n,4),e,s,lu)}function jh(t,n){var e=V(t)?Rn:cu;return e(t,Tr(G(n,3)))}function td(t){var n=V(t)?uu:Vl;return n(t)}function nd(t,n,e){(e?Bt(t,n,e):n===i)?n=1:n=$(n);var r=V(t)?El:$l;return r(t,n)}function ed(t){var n=V(t)?Al:Zl;return n(t)}function rd(t){if(t==null)return 0;if(zt(t))return Mr(t)?Qn(t):t.length;var n=Ct(t);return n==rn||n==sn?t.size:mi(t).length}function id(t,n,e){var r=V(t)?ni:Jl;return e&&Bt(t,n,e)&&(n=i),r(t,G(n,3))}var sd=Z(function(t,n){if(t==null)return[];var e=n.length;return e>1&&Bt(t,n[0],n[1])?n=[]:e>2&&Bt(n[0],n[1],n[2])&&(n=[n[0]]),yu(t,Tt(n,1),[])}),Ar=Fa||function(){return Rt.Date.now()};function ud(t,n){if(typeof n!="function")throw new Qt(S);return t=$(t),function(){if(--t<1)return n.apply(this,arguments)}}function po(t,n,e){return n=e?i:n,n=t&&n==null?t.length:n,mn(t,Dt,i,i,i,i,n)}function vo(t,n){var e;if(typeof n!="function")throw new Qt(S);return t=$(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=i),e}}var qi=Z(function(t,n,e){var r=it;if(e.length){var s=Ln(e,se(qi));r|=bt}return mn(t,r,n,e,s)}),wo=Z(function(t,n,e){var r=it|Y;if(e.length){var s=Ln(e,se(wo));r|=bt}return mn(n,r,t,e,s)});function mo(t,n,e){n=e?i:n;var r=mn(t,_t,i,i,i,i,i,n);return r.placeholder=mo.placeholder,r}function xo(t,n,e){n=e?i:n;var r=mn(t,Ot,i,i,i,i,i,n);return r.placeholder=xo.placeholder,r}function yo(t,n,e){var r,s,f,a,l,h,m=0,x=!1,y=!1,L=!0;if(typeof t!="function")throw new Qt(S);n=en(n)||0,dt(e)&&(x=!!e.leading,y="maxWait"in e,f=y?St(en(e.maxWait)||0,n):f,L="trailing"in e?!!e.trailing:L);function b(xt){var an=r,An=s;return r=s=i,m=xt,a=t.apply(An,an),a}function H(xt){return m=xt,l=Oe(Q,n),x?b(xt):a}function X(xt){var an=xt-h,An=xt-m,No=n-an;return y?Mt(No,f-An):No}function q(xt){var an=xt-h,An=xt-m;return h===i||an>=n||an<0||y&&An>=f}function Q(){var xt=Ar();if(q(xt))return tt(xt);l=Oe(Q,X(xt))}function tt(xt){return l=i,L&&r?b(xt):(r=s=i,a)}function Vt(){l!==i&&Iu(l),m=0,r=h=s=l=i}function Wt(){return l===i?a:tt(Ar())}function $t(){var xt=Ar(),an=q(xt);if(r=arguments,s=this,h=xt,an){if(l===i)return H(h);if(y)return Iu(l),l=Oe(Q,n),b(h)}return l===i&&(l=Oe(Q,n)),a}return $t.cancel=Vt,$t.flush=Wt,$t}var od=Z(function(t,n){return au(t,1,n)}),fd=Z(function(t,n,e){return au(t,en(n)||0,e)});function ad(t){return mn(t,O)}function Rr(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new Qt(S);var e=function(){var r=arguments,s=n?n.apply(this,r):r[0],f=e.cache;if(f.has(s))return f.get(s);var a=t.apply(this,r);return e.cache=f.set(s,a)||f,a};return e.cache=new(Rr.Cache||vn),e}Rr.Cache=vn;function Tr(t){if(typeof t!="function")throw new Qt(S);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function ld(t){return vo(2,t)}var cd=Ql(function(t,n){n=n.length==1&&V(n[0])?ht(n[0],qt(G())):ht(Tt(n,1),qt(G()));var e=n.length;return Z(function(r){for(var s=-1,f=Mt(r.length,e);++s<f;)r[s]=n[s].call(this,r[s]);return Ht(t,this,r)})}),Ki=Z(function(t,n){var e=Ln(n,se(Ki));return mn(t,bt,i,n,e)}),So=Z(function(t,n){var e=Ln(n,se(So));return mn(t,Gt,i,n,e)}),hd=xn(function(t,n){return mn(t,A,i,i,i,n)});function dd(t,n){if(typeof t!="function")throw new Qt(S);return n=n===i?n:$(n),Z(t,n)}function gd(t,n){if(typeof t!="function")throw new Qt(S);return n=n==null?0:St($(n),0),Z(function(e){var r=e[n],s=bn(e,0,n);return r&&Tn(s,r),Ht(t,this,s)})}function _d(t,n,e){var r=!0,s=!0;if(typeof t!="function")throw new Qt(S);return dt(e)&&(r="leading"in e?!!e.leading:r,s="trailing"in e?!!e.trailing:s),yo(t,n,{leading:r,maxWait:n,trailing:s})}function pd(t){return po(t,1)}function vd(t,n){return Ki(Mi(n),t)}function wd(){if(!arguments.length)return[];var t=arguments[0];return V(t)?t:[t]}function md(t){return jt(t,ut)}function xd(t,n){return n=typeof n=="function"?n:i,jt(t,ut,n)}function yd(t){return jt(t,C|ut)}function Sd(t,n){return n=typeof n=="function"?n:i,jt(t,C|ut,n)}function Ed(t,n){return n==null||fu(t,n,Et(n))}function fn(t,n){return t===n||t!==t&&n!==n}var Ad=wr(pi),Rd=wr(function(t,n){return t>=n}),qn=gu(function(){return arguments}())?gu:function(t){return pt(t)&&st.call(t,"callee")&&!tu.call(t,"callee")},V=_.isArray,Td=Bs?qt(Bs):Pl;function zt(t){return t!=null&&Lr(t.length)&&!Sn(t)}function mt(t){return pt(t)&&zt(t)}function Ld(t){return t===!0||t===!1||pt(t)&&Pt(t)==ce}var Dn=Ga||ns,Md=Ws?qt(Ws):Bl;function Cd(t){return pt(t)&&t.nodeType===1&&!be(t)}function Id(t){if(t==null)return!0;if(zt(t)&&(V(t)||typeof t=="string"||typeof t.splice=="function"||Dn(t)||ue(t)||qn(t)))return!t.length;var n=Ct(t);if(n==rn||n==sn)return!t.size;if(Ie(t))return!mi(t).length;for(var e in t)if(st.call(t,e))return!1;return!0}function Od(t,n){return Le(t,n)}function bd(t,n,e){e=typeof e=="function"?e:i;var r=e?e(t,n):i;return r===i?Le(t,n,i,e):!!r}function Yi(t){if(!pt(t))return!1;var n=Pt(t);return n==Fe||n==tf||typeof t.message=="string"&&typeof t.name=="string"&&!be(t)}function Dd(t){return typeof t=="number"&&eu(t)}function Sn(t){if(!dt(t))return!1;var n=Pt(t);return n==Ne||n==as||n==jo||n==ef}function Eo(t){return typeof t=="number"&&t==$(t)}function Lr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=F}function dt(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function pt(t){return t!=null&&typeof t=="object"}var Ao=Us?qt(Us):Ul;function Pd(t,n){return t===n||wi(t,n,Bi(n))}function Bd(t,n,e){return e=typeof e=="function"?e:i,wi(t,n,Bi(n),e)}function Wd(t){return Ro(t)&&t!=+t}function Ud(t){if(xc(t))throw new K(M);return _u(t)}function zd(t){return t===null}function Fd(t){return t==null}function Ro(t){return typeof t=="number"||pt(t)&&Pt(t)==de}function be(t){if(!pt(t)||Pt(t)!=_n)return!1;var n=tr(t);if(n===null)return!0;var e=st.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&Je.call(e)==Ba}var Vi=zs?qt(zs):zl;function Nd(t){return Eo(t)&&t>=-F&&t<=F}var To=Fs?qt(Fs):Fl;function Mr(t){return typeof t=="string"||!V(t)&&pt(t)&&Pt(t)==_e}function Yt(t){return typeof t=="symbol"||pt(t)&&Pt(t)==Ge}var ue=Ns?qt(Ns):Nl;function Gd(t){return t===i}function Hd(t){return pt(t)&&Ct(t)==pe}function qd(t){return pt(t)&&Pt(t)==sf}var Kd=wr(xi),Yd=wr(function(t,n){return t<=n});function Lo(t){if(!t)return[];if(zt(t))return Mr(t)?un(t):Ut(t);if(me&&t[me])return Ea(t[me]());var n=Ct(t),e=n==rn?oi:n==sn?$e:oe;return e(t)}function En(t){if(!t)return t===0?t:0;if(t=en(t),t===z||t===-z){var n=t<0?-1:1;return n*Lt}return t===t?t:0}function $(t){var n=En(t),e=n%1;return n===n?e?n-e:n:0}function Mo(t){return t?Fn($(t),0,cn):0}function en(t){if(typeof t=="number")return t;if(Yt(t))return Yn;if(dt(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=dt(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=Vs(t);var e=Tf.test(t);return e||Mf.test(t)?ua(t.slice(2),e?2:8):Rf.test(t)?Yn:+t}function Co(t){return dn(t,Ft(t))}function Vd(t){return t?Fn($(t),-F,F):t===0?t:0}function rt(t){return t==null?"":Kt(t)}var $d=re(function(t,n){if(Ie(n)||zt(n)){dn(n,Et(n),t);return}for(var e in n)st.call(n,e)&&Ae(t,e,n[e])}),Io=re(function(t,n){dn(n,Ft(n),t)}),Cr=re(function(t,n,e,r){dn(n,Ft(n),t,r)}),Xd=re(function(t,n,e,r){dn(n,Et(n),t,r)}),Zd=xn(di);function Jd(t,n){var e=ee(t);return n==null?e:ou(e,n)}var Qd=Z(function(t,n){t=at(t);var e=-1,r=n.length,s=r>2?n[2]:i;for(s&&Bt(n[0],n[1],s)&&(r=1);++e<r;)for(var f=n[e],a=Ft(f),l=-1,h=a.length;++l<h;){var m=a[l],x=t[m];(x===i||fn(x,jn[m])&&!st.call(t,m))&&(t[m]=f[m])}return t}),kd=Z(function(t){return t.push(i,Vu),Ht(Oo,i,t)});function jd(t,n){return Hs(t,G(n,3),hn)}function tg(t,n){return Hs(t,G(n,3),_i)}function ng(t,n){return t==null?t:gi(t,G(n,3),Ft)}function eg(t,n){return t==null?t:hu(t,G(n,3),Ft)}function rg(t,n){return t&&hn(t,G(n,3))}function ig(t,n){return t&&_i(t,G(n,3))}function sg(t){return t==null?[]:lr(t,Et(t))}function ug(t){return t==null?[]:lr(t,Ft(t))}function $i(t,n,e){var r=t==null?i:Nn(t,n);return r===i?e:r}function og(t,n){return t!=null&&Zu(t,n,Il)}function Xi(t,n){return t!=null&&Zu(t,n,Ol)}var fg=Gu(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=Qe.call(n)),t[n]=e},Ji(Nt)),ag=Gu(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=Qe.call(n)),st.call(t,n)?t[n].push(e):t[n]=[e]},G),lg=Z(Te);function Et(t){return zt(t)?su(t):mi(t)}function Ft(t){return zt(t)?su(t,!0):Gl(t)}function cg(t,n){var e={};return n=G(n,3),hn(t,function(r,s,f){wn(e,n(r,s,f),r)}),e}function hg(t,n){var e={};return n=G(n,3),hn(t,function(r,s,f){wn(e,s,n(r,s,f))}),e}var dg=re(function(t,n,e){cr(t,n,e)}),Oo=re(function(t,n,e,r){cr(t,n,e,r)}),gg=xn(function(t,n){var e={};if(t==null)return e;var r=!1;n=ht(n,function(f){return f=On(f,t),r||(r=f.length>1),f}),dn(t,Di(t),e),r&&(e=jt(e,C|J|ut,fc));for(var s=n.length;s--;)Ri(e,n[s]);return e});function _g(t,n){return bo(t,Tr(G(n)))}var pg=xn(function(t,n){return t==null?{}:ql(t,n)});function bo(t,n){if(t==null)return{};var e=ht(Di(t),function(r){return[r]});return n=G(n),Su(t,e,function(r,s){return n(r,s[0])})}function vg(t,n,e){n=On(n,t);var r=-1,s=n.length;for(s||(s=1,t=i);++r<s;){var f=t==null?i:t[gn(n[r])];f===i&&(r=s,f=e),t=Sn(f)?f.call(t):f}return t}function wg(t,n,e){return t==null?t:Me(t,n,e)}function mg(t,n,e,r){return r=typeof r=="function"?r:i,t==null?t:Me(t,n,e,r)}var Do=Ku(Et),Po=Ku(Ft);function xg(t,n,e){var r=V(t),s=r||Dn(t)||ue(t);if(n=G(n,4),e==null){var f=t&&t.constructor;s?e=r?new f:[]:dt(t)?e=Sn(f)?ee(tr(t)):{}:e={}}return(s?Jt:hn)(t,function(a,l,h){return n(e,a,l,h)}),e}function yg(t,n){return t==null?!0:Ri(t,n)}function Sg(t,n,e){return t==null?t:Lu(t,n,Mi(e))}function Eg(t,n,e,r){return r=typeof r=="function"?r:i,t==null?t:Lu(t,n,Mi(e),r)}function oe(t){return t==null?[]:ui(t,Et(t))}function Ag(t){return t==null?[]:ui(t,Ft(t))}function Rg(t,n,e){return e===i&&(e=n,n=i),e!==i&&(e=en(e),e=e===e?e:0),n!==i&&(n=en(n),n=n===n?n:0),Fn(en(t),n,e)}function Tg(t,n,e){return n=En(n),e===i?(e=n,n=0):e=En(e),t=en(t),bl(t,n,e)}function Lg(t,n,e){if(e&&typeof e!="boolean"&&Bt(t,n,e)&&(n=e=i),e===i&&(typeof n=="boolean"?(e=n,n=i):typeof t=="boolean"&&(e=t,t=i)),t===i&&n===i?(t=0,n=1):(t=En(t),n===i?(n=t,t=0):n=En(n)),t>n){var r=t;t=n,n=r}if(e||t%1||n%1){var s=ru();return Mt(t+s*(n-t+sa("1e-"+((s+"").length-1))),n)}return Si(t,n)}var Mg=ie(function(t,n,e){return n=n.toLowerCase(),t+(e?Bo(n):n)});function Bo(t){return Zi(rt(t).toLowerCase())}function Wo(t){return t=rt(t),t&&t.replace(If,wa).replace(Zf,"")}function Cg(t,n,e){t=rt(t),n=Kt(n);var r=t.length;e=e===i?r:Fn($(e),0,r);var s=e;return e-=n.length,e>=0&&t.slice(e,s)==n}function Ig(t){return t=rt(t),t&&lf.test(t)?t.replace(hs,ma):t}function Og(t){return t=rt(t),t&&pf.test(t)?t.replace(Kr,"\\$&"):t}var bg=ie(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),Dg=ie(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),Pg=zu("toLowerCase");function Bg(t,n,e){t=rt(t),n=$(n);var r=n?Qn(t):0;if(!n||r>=n)return t;var s=(n-r)/2;return vr(ir(s),e)+t+vr(rr(s),e)}function Wg(t,n,e){t=rt(t),n=$(n);var r=n?Qn(t):0;return n&&r<n?t+vr(n-r,e):t}function Ug(t,n,e){t=rt(t),n=$(n);var r=n?Qn(t):0;return n&&r<n?vr(n-r,e)+t:t}function zg(t,n,e){return e||n==null?n=0:n&&(n=+n),Ya(rt(t).replace(Yr,""),n||0)}function Fg(t,n,e){return(e?Bt(t,n,e):n===i)?n=1:n=$(n),Ei(rt(t),n)}function Ng(){var t=arguments,n=rt(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var Gg=ie(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()});function Hg(t,n,e){return e&&typeof e!="number"&&Bt(t,n,e)&&(n=e=i),e=e===i?cn:e>>>0,e?(t=rt(t),t&&(typeof n=="string"||n!=null&&!Vi(n))&&(n=Kt(n),!n&&Jn(t))?bn(un(t),0,e):t.split(n,e)):[]}var qg=ie(function(t,n,e){return t+(e?" ":"")+Zi(n)});function Kg(t,n,e){return t=rt(t),e=e==null?0:Fn($(e),0,t.length),n=Kt(n),t.slice(e,e+n.length)==n}function Yg(t,n,e){var r=u.templateSettings;e&&Bt(t,n,e)&&(n=i),t=rt(t),n=Cr({},n,r,Yu);var s=Cr({},n.imports,r.imports,Yu),f=Et(s),a=ui(s,f),l,h,m=0,x=n.interpolate||He,y="__p += '",L=fi((n.escape||He).source+"|"+x.source+"|"+(x===ds?Af:He).source+"|"+(n.evaluate||He).source+"|$","g"),b="//# sourceURL="+(st.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ta+"]")+`
`;t.replace(L,function(q,Q,tt,Vt,Wt,$t){return tt||(tt=Vt),y+=t.slice(m,$t).replace(Of,xa),Q&&(l=!0,y+=`' +
__e(`+Q+`) +
'`),Wt&&(h=!0,y+=`';
`+Wt+`;
__p += '`),tt&&(y+=`' +
((__t = (`+tt+`)) == null ? '' : __t) +
'`),m=$t+q.length,q}),y+=`';
`;var H=st.call(n,"variable")&&n.variable;if(!H)y=`with (obj) {
`+y+`
}
`;else if(Sf.test(H))throw new K(B);y=(h?y.replace(uf,""):y).replace(of,"$1").replace(ff,"$1;"),y="function("+(H||"obj")+`) {
`+(H?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(l?", __e = _.escape":"")+(h?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+y+`return __p
}`;var X=zo(function(){return et(f,b+"return "+y).apply(i,a)});if(X.source=y,Yi(X))throw X;return X}function Vg(t){return rt(t).toLowerCase()}function $g(t){return rt(t).toUpperCase()}function Xg(t,n,e){if(t=rt(t),t&&(e||n===i))return Vs(t);if(!t||!(n=Kt(n)))return t;var r=un(t),s=un(n),f=$s(r,s),a=Xs(r,s)+1;return bn(r,f,a).join("")}function Zg(t,n,e){if(t=rt(t),t&&(e||n===i))return t.slice(0,Js(t)+1);if(!t||!(n=Kt(n)))return t;var r=un(t),s=Xs(r,un(n))+1;return bn(r,0,s).join("")}function Jg(t,n,e){if(t=rt(t),t&&(e||n===i))return t.replace(Yr,"");if(!t||!(n=Kt(n)))return t;var r=un(t),s=$s(r,un(n));return bn(r,s).join("")}function Qg(t,n){var e=U,r=p;if(dt(n)){var s="separator"in n?n.separator:s;e="length"in n?$(n.length):e,r="omission"in n?Kt(n.omission):r}t=rt(t);var f=t.length;if(Jn(t)){var a=un(t);f=a.length}if(e>=f)return t;var l=e-Qn(r);if(l<1)return r;var h=a?bn(a,0,l).join(""):t.slice(0,l);if(s===i)return h+r;if(a&&(l+=h.length-l),Vi(s)){if(t.slice(l).search(s)){var m,x=h;for(s.global||(s=fi(s.source,rt(gs.exec(s))+"g")),s.lastIndex=0;m=s.exec(x);)var y=m.index;h=h.slice(0,y===i?l:y)}}else if(t.indexOf(Kt(s),l)!=l){var L=h.lastIndexOf(s);L>-1&&(h=h.slice(0,L))}return h+r}function kg(t){return t=rt(t),t&&af.test(t)?t.replace(cs,La):t}var jg=ie(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),Zi=zu("toUpperCase");function Uo(t,n,e){return t=rt(t),n=e?i:n,n===i?Sa(t)?Ia(t):da(t):t.match(n)||[]}var zo=Z(function(t,n){try{return Ht(t,i,n)}catch(e){return Yi(e)?e:new K(e)}}),t_=xn(function(t,n){return Jt(n,function(e){e=gn(e),wn(t,e,qi(t[e],t))}),t});function n_(t){var n=t==null?0:t.length,e=G();return t=n?ht(t,function(r){if(typeof r[1]!="function")throw new Qt(S);return[e(r[0]),r[1]]}):[],Z(function(r){for(var s=-1;++s<n;){var f=t[s];if(Ht(f[0],this,r))return Ht(f[1],this,r)}})}function e_(t){return Ll(jt(t,C))}function Ji(t){return function(){return t}}function r_(t,n){return t==null||t!==t?n:t}var i_=Nu(),s_=Nu(!0);function Nt(t){return t}function Qi(t){return pu(typeof t=="function"?t:jt(t,C))}function u_(t){return wu(jt(t,C))}function o_(t,n){return mu(t,jt(n,C))}var f_=Z(function(t,n){return function(e){return Te(e,t,n)}}),a_=Z(function(t,n){return function(e){return Te(t,e,n)}});function ki(t,n,e){var r=Et(n),s=lr(n,r);e==null&&!(dt(n)&&(s.length||!r.length))&&(e=n,n=t,t=this,s=lr(n,Et(n)));var f=!(dt(e)&&"chain"in e)||!!e.chain,a=Sn(t);return Jt(s,function(l){var h=n[l];t[l]=h,a&&(t.prototype[l]=function(){var m=this.__chain__;if(f||m){var x=t(this.__wrapped__),y=x.__actions__=Ut(this.__actions__);return y.push({func:h,args:arguments,thisArg:t}),x.__chain__=m,x}return h.apply(t,Tn([this.value()],arguments))})}),t}function l_(){return Rt._===this&&(Rt._=Wa),this}function ji(){}function c_(t){return t=$(t),Z(function(n){return xu(n,t)})}var h_=Ii(ht),d_=Ii(Gs),g_=Ii(ni);function Fo(t){return Ui(t)?ei(gn(t)):Kl(t)}function __(t){return function(n){return t==null?i:Nn(t,n)}}var p_=Hu(),v_=Hu(!0);function ts(){return[]}function ns(){return!1}function w_(){return{}}function m_(){return""}function x_(){return!0}function y_(t,n){if(t=$(t),t<1||t>F)return[];var e=cn,r=Mt(t,cn);n=G(n),t-=cn;for(var s=si(r,n);++e<t;)n(e);return s}function S_(t){return V(t)?ht(t,gn):Yt(t)?[t]:Ut(io(rt(t)))}function E_(t){var n=++Pa;return rt(t)+n}var A_=pr(function(t,n){return t+n},0),R_=Oi("ceil"),T_=pr(function(t,n){return t/n},1),L_=Oi("floor");function M_(t){return t&&t.length?ar(t,Nt,pi):i}function C_(t,n){return t&&t.length?ar(t,G(n,2),pi):i}function I_(t){return Ks(t,Nt)}function O_(t,n){return Ks(t,G(n,2))}function b_(t){return t&&t.length?ar(t,Nt,xi):i}function D_(t,n){return t&&t.length?ar(t,G(n,2),xi):i}var P_=pr(function(t,n){return t*n},1),B_=Oi("round"),W_=pr(function(t,n){return t-n},0);function U_(t){return t&&t.length?ii(t,Nt):0}function z_(t,n){return t&&t.length?ii(t,G(n,2)):0}return u.after=ud,u.ary=po,u.assign=$d,u.assignIn=Io,u.assignInWith=Cr,u.assignWith=Xd,u.at=Zd,u.before=vo,u.bind=qi,u.bindAll=t_,u.bindKey=wo,u.castArray=wd,u.chain=ho,u.chunk=Lc,u.compact=Mc,u.concat=Cc,u.cond=n_,u.conforms=e_,u.constant=Ji,u.countBy=Uh,u.create=Jd,u.curry=mo,u.curryRight=xo,u.debounce=yo,u.defaults=Qd,u.defaultsDeep=kd,u.defer=od,u.delay=fd,u.difference=Ic,u.differenceBy=Oc,u.differenceWith=bc,u.drop=Dc,u.dropRight=Pc,u.dropRightWhile=Bc,u.dropWhile=Wc,u.fill=Uc,u.filter=Fh,u.flatMap=Hh,u.flatMapDeep=qh,u.flatMapDepth=Kh,u.flatten=fo,u.flattenDeep=zc,u.flattenDepth=Fc,u.flip=ad,u.flow=i_,u.flowRight=s_,u.fromPairs=Nc,u.functions=sg,u.functionsIn=ug,u.groupBy=Yh,u.initial=Hc,u.intersection=qc,u.intersectionBy=Kc,u.intersectionWith=Yc,u.invert=fg,u.invertBy=ag,u.invokeMap=$h,u.iteratee=Qi,u.keyBy=Xh,u.keys=Et,u.keysIn=Ft,u.map=Er,u.mapKeys=cg,u.mapValues=hg,u.matches=u_,u.matchesProperty=o_,u.memoize=Rr,u.merge=dg,u.mergeWith=Oo,u.method=f_,u.methodOf=a_,u.mixin=ki,u.negate=Tr,u.nthArg=c_,u.omit=gg,u.omitBy=_g,u.once=ld,u.orderBy=Zh,u.over=h_,u.overArgs=cd,u.overEvery=d_,u.overSome=g_,u.partial=Ki,u.partialRight=So,u.partition=Jh,u.pick=pg,u.pickBy=bo,u.property=Fo,u.propertyOf=__,u.pull=Zc,u.pullAll=lo,u.pullAllBy=Jc,u.pullAllWith=Qc,u.pullAt=kc,u.range=p_,u.rangeRight=v_,u.rearg=hd,u.reject=jh,u.remove=jc,u.rest=dd,u.reverse=Gi,u.sampleSize=nd,u.set=wg,u.setWith=mg,u.shuffle=ed,u.slice=th,u.sortBy=sd,u.sortedUniq=oh,u.sortedUniqBy=fh,u.split=Hg,u.spread=gd,u.tail=ah,u.take=lh,u.takeRight=ch,u.takeRightWhile=hh,u.takeWhile=dh,u.tap=Mh,u.throttle=_d,u.thru=Sr,u.toArray=Lo,u.toPairs=Do,u.toPairsIn=Po,u.toPath=S_,u.toPlainObject=Co,u.transform=xg,u.unary=pd,u.union=gh,u.unionBy=_h,u.unionWith=ph,u.uniq=vh,u.uniqBy=wh,u.uniqWith=mh,u.unset=yg,u.unzip=Hi,u.unzipWith=co,u.update=Sg,u.updateWith=Eg,u.values=oe,u.valuesIn=Ag,u.without=xh,u.words=Uo,u.wrap=vd,u.xor=yh,u.xorBy=Sh,u.xorWith=Eh,u.zip=Ah,u.zipObject=Rh,u.zipObjectDeep=Th,u.zipWith=Lh,u.entries=Do,u.entriesIn=Po,u.extend=Io,u.extendWith=Cr,ki(u,u),u.add=A_,u.attempt=zo,u.camelCase=Mg,u.capitalize=Bo,u.ceil=R_,u.clamp=Rg,u.clone=md,u.cloneDeep=yd,u.cloneDeepWith=Sd,u.cloneWith=xd,u.conformsTo=Ed,u.deburr=Wo,u.defaultTo=r_,u.divide=T_,u.endsWith=Cg,u.eq=fn,u.escape=Ig,u.escapeRegExp=Og,u.every=zh,u.find=Nh,u.findIndex=uo,u.findKey=jd,u.findLast=Gh,u.findLastIndex=oo,u.findLastKey=tg,u.floor=L_,u.forEach=go,u.forEachRight=_o,u.forIn=ng,u.forInRight=eg,u.forOwn=rg,u.forOwnRight=ig,u.get=$i,u.gt=Ad,u.gte=Rd,u.has=og,u.hasIn=Xi,u.head=ao,u.identity=Nt,u.includes=Vh,u.indexOf=Gc,u.inRange=Tg,u.invoke=lg,u.isArguments=qn,u.isArray=V,u.isArrayBuffer=Td,u.isArrayLike=zt,u.isArrayLikeObject=mt,u.isBoolean=Ld,u.isBuffer=Dn,u.isDate=Md,u.isElement=Cd,u.isEmpty=Id,u.isEqual=Od,u.isEqualWith=bd,u.isError=Yi,u.isFinite=Dd,u.isFunction=Sn,u.isInteger=Eo,u.isLength=Lr,u.isMap=Ao,u.isMatch=Pd,u.isMatchWith=Bd,u.isNaN=Wd,u.isNative=Ud,u.isNil=Fd,u.isNull=zd,u.isNumber=Ro,u.isObject=dt,u.isObjectLike=pt,u.isPlainObject=be,u.isRegExp=Vi,u.isSafeInteger=Nd,u.isSet=To,u.isString=Mr,u.isSymbol=Yt,u.isTypedArray=ue,u.isUndefined=Gd,u.isWeakMap=Hd,u.isWeakSet=qd,u.join=Vc,u.kebabCase=bg,u.last=nn,u.lastIndexOf=$c,u.lowerCase=Dg,u.lowerFirst=Pg,u.lt=Kd,u.lte=Yd,u.max=M_,u.maxBy=C_,u.mean=I_,u.meanBy=O_,u.min=b_,u.minBy=D_,u.stubArray=ts,u.stubFalse=ns,u.stubObject=w_,u.stubString=m_,u.stubTrue=x_,u.multiply=P_,u.nth=Xc,u.noConflict=l_,u.noop=ji,u.now=Ar,u.pad=Bg,u.padEnd=Wg,u.padStart=Ug,u.parseInt=zg,u.random=Lg,u.reduce=Qh,u.reduceRight=kh,u.repeat=Fg,u.replace=Ng,u.result=vg,u.round=B_,u.runInContext=c,u.sample=td,u.size=rd,u.snakeCase=Gg,u.some=id,u.sortedIndex=nh,u.sortedIndexBy=eh,u.sortedIndexOf=rh,u.sortedLastIndex=ih,u.sortedLastIndexBy=sh,u.sortedLastIndexOf=uh,u.startCase=qg,u.startsWith=Kg,u.subtract=W_,u.sum=U_,u.sumBy=z_,u.template=Yg,u.times=y_,u.toFinite=En,u.toInteger=$,u.toLength=Mo,u.toLower=Vg,u.toNumber=en,u.toSafeInteger=Vd,u.toString=rt,u.toUpper=$g,u.trim=Xg,u.trimEnd=Zg,u.trimStart=Jg,u.truncate=Qg,u.unescape=kg,u.uniqueId=E_,u.upperCase=jg,u.upperFirst=Zi,u.each=go,u.eachRight=_o,u.first=ao,ki(u,function(){var t={};return hn(u,function(n,e){st.call(u.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),u.VERSION=d,Jt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){u[t].placeholder=u}),Jt(["drop","take"],function(t,n){k.prototype[t]=function(e){e=e===i?1:St($(e),0);var r=this.__filtered__&&!n?new k(this):this.clone();return r.__filtered__?r.__takeCount__=Mt(e,r.__takeCount__):r.__views__.push({size:Mt(e,cn),type:t+(r.__dir__<0?"Right":"")}),r},k.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Jt(["filter","map","takeWhile"],function(t,n){var e=n+1,r=e==T||e==j;k.prototype[t]=function(s){var f=this.clone();return f.__iteratees__.push({iteratee:G(s,3),type:e}),f.__filtered__=f.__filtered__||r,f}}),Jt(["head","last"],function(t,n){var e="take"+(n?"Right":"");k.prototype[t]=function(){return this[e](1).value()[0]}}),Jt(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");k.prototype[t]=function(){return this.__filtered__?new k(this):this[e](1)}}),k.prototype.compact=function(){return this.filter(Nt)},k.prototype.find=function(t){return this.filter(t).head()},k.prototype.findLast=function(t){return this.reverse().find(t)},k.prototype.invokeMap=Z(function(t,n){return typeof t=="function"?new k(this):this.map(function(e){return Te(e,t,n)})}),k.prototype.reject=function(t){return this.filter(Tr(G(t)))},k.prototype.slice=function(t,n){t=$(t);var e=this;return e.__filtered__&&(t>0||n<0)?new k(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==i&&(n=$(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},k.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},k.prototype.toArray=function(){return this.take(cn)},hn(k.prototype,function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),s=u[r?"take"+(n=="last"?"Right":""):n],f=r||/^find/.test(n);s&&(u.prototype[n]=function(){var a=this.__wrapped__,l=r?[1]:arguments,h=a instanceof k,m=l[0],x=h||V(a),y=function(Q){var tt=s.apply(u,Tn([Q],l));return r&&L?tt[0]:tt};x&&e&&typeof m=="function"&&m.length!=1&&(h=x=!1);var L=this.__chain__,b=!!this.__actions__.length,H=f&&!L,X=h&&!b;if(!f&&x){a=X?a:new k(this);var q=t.apply(a,l);return q.__actions__.push({func:Sr,args:[y],thisArg:i}),new kt(q,L)}return H&&X?t.apply(this,l):(q=this.thru(y),H?r?q.value()[0]:q.value():q)})}),Jt(["pop","push","shift","sort","splice","unshift"],function(t){var n=Xe[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);u.prototype[t]=function(){var s=arguments;if(r&&!this.__chain__){var f=this.value();return n.apply(V(f)?f:[],s)}return this[e](function(a){return n.apply(V(a)?a:[],s)})}}),hn(k.prototype,function(t,n){var e=u[n];if(e){var r=e.name+"";st.call(ne,r)||(ne[r]=[]),ne[r].push({name:n,func:e})}}),ne[_r(i,Y).name]=[{name:"wrapper",func:i}],k.prototype.clone=ka,k.prototype.reverse=ja,k.prototype.value=tl,u.prototype.at=Ch,u.prototype.chain=Ih,u.prototype.commit=Oh,u.prototype.next=bh,u.prototype.plant=Ph,u.prototype.reverse=Bh,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=Wh,u.prototype.first=u.prototype.head,me&&(u.prototype[me]=Dh),u},kn=Oa();Bn?((Bn.exports=kn)._=kn,Qr._=kn):Rt._=kn}).call(De)})(br,br.exports);var Q_=br.exports;const ln=G_(Q_);class ft{constructor(o,i){this.id=`point-id-${new Date().getTime().toString()}`,this.x=o,this.y=i,this.initialX=o,this.initialY=i}translate(o,i){this.x+=o,this.y+=i,this.initialX=this.x,this.initialY=this.y}clone(){return new ft(this.x,this.y)}serialize(){return`${this.x},${this.y}`}json(){return JSON.stringify(this)}deserialize(o){const[i,d]=o.split(",").map(v=>parseInt(v));return new ft(i,d)}static middlePoint(o,i){return new ft((o.x+i.x)/2,(o.y+i.y)/2)}static distance(o,i){return Math.sqrt((o.x-i.x)**2+(o.y-i.y)**2)}static isSame(o,i){return o.x===i.x&&o.y===i.y}static isNear(o,i,d=10){return ft.distance(o,i)<d}}class k_ extends Ue{constructor(i,d){super(i,d);vt(this,"_point",null);vt(this,"_mouseDown",!1);vt(this,"_moveAll",!1);vt(this,"cursorDefault","default");vt(this,"cursorMove","move");vt(this,"cursorGrab","grab");vt(this,"cursorGrabbing","grabbing")}onEnter(){this.redraw()}onExit(){this._mouseDown=!1,this._point=null,this._moveAll=!1}handleMouseWheel(i,d){}handleMouseDown(i,d){this._mouseDown=!0;const v=this.stateMachine.coordinateSystem;if(!this.stateMachine.ctx||!v||!d)return;const S=this.stateMachine.element,B=this.stateMachine.elements;if(!S)return;const W=i.clientX,N=i.clientY,D=v.clientPointToViewPoint({clientX:W,clientY:N});if(!this._point)if(S.contains(D.x,D.y))this._moveAll=!0;else{const C=B.find(J=>J.contains(D.x,D.y));C&&C!==S?this.stateMachine.element=C:(this.stateMachine.element=null,this.stateMachine.setState(We.STATE_SELECT)),this.redraw()}}handleMouseMove(i,d){const v=this.stateMachine.coordinateSystem;if(!this.stateMachine.ctx||!v||!d)return;const S=this.stateMachine.element;if(!S)return;const B=i.clientX,W=i.clientY,N=v.clientPointToViewPoint({clientX:B,clientY:W}),D=S.rectangle.points;if(this._mouseDown){const C={x:i.movementX/v.scale,y:i.movementY/v.scale};this._point?(this._point.translate(C.x,C.y),this.stateMachine.element=S):this._moveAll&&(S.translate(C.x,C.y),this.stateMachine.element=S),this.redraw()}else{const C=D.find(J=>ft.isNear(J,new ft(N.x,N.y)))||null;this._point=C,d.style.cursor=this._point?"move":"default"}}handleMouseUp(i,d){this._mouseDown=!1,this._point=null,this._moveAll=!1,this.stateMachine.element&&this.stateMachine.element.rectangle.processDisplacement()}redraw(){const i=this.stateMachine.ctx,d=this.stateMachine.canvas;if(!i||!d)return;const v=this.stateMachine.element,M=this.stateMachine.elements;i.clearRect(0,0,d.width,d.height),ln.each(M,S=>{S.draw(i)}),ln.each(M,S=>{S.draw(i)}),v&&(v.drawBoundingBox(i),v.drawLines(i),v.drawPoints(i))}}class j_ extends Ue{constructor(i,d){super(i,d);vt(this,"_handle",null);vt(this,"_mouseDown",!1);vt(this,"cursorDefault","default");vt(this,"cursorResize","nwse-resize")}onEnter(){this.redraw()}onExit(){this._mouseDown=!1,this._handle=null}handleMouseWheel(i,d){}handleMouseDown(i,d){this._mouseDown=!0}handleMouseMove(i,d){const v=this.stateMachine.coordinateSystem,M=this.stateMachine.ctx,S=this.stateMachine.element;if(!M||!v||!S)return;const B=i.clientX,W=i.clientY,N=v.clientPointToViewPoint({clientX:B,clientY:W}),D={x:i.movementX,y:i.movementY};if(this._mouseDown){if(this._handle){const C=S.rectangle.boundingBox,J=C.clone();switch(this._handle){case"topLeft":J.updateDimensions(C.topLeft.x+D.x,C.topLeft.y+D.y,C.width-D.x,C.height-D.y);break;case"topRight":J.updateDimensions(C.topLeft.x,C.topLeft.y+D.y,C.width+D.x,C.height-D.y);break;case"bottomLeft":J.updateDimensions(C.topLeft.x+D.x,C.topLeft.y,C.width-D.x,C.height+D.y);break;case"bottomRight":J.updateDimensions(C.topLeft.x,C.topLeft.y,C.width+D.x,C.height+D.y);break}S.resizeBoundingBox(J),this.redraw()}}else{const C=S.getBoundingBoxHandle(N.x,N.y);if(!C){d.style.cursor=this.cursorDefault;return}const J=S.handleToString(C);this._handle=J,d.style.cursor=this.cursorResize}}handleMouseUp(i,d){this._mouseDown=!1,this._handle=null,this.redraw()}redraw(){const i=this.stateMachine.ctx,d=this.stateMachine.canvas;if(!i||!d)return;const v=this.stateMachine.element,M=this.stateMachine.elements;i.clearRect(0,0,d.width,d.height),ln.each(M,S=>{S.draw(i)}),v&&(v.drawBoundingBox(i),v.drawLines(i),v.drawBoundingBoxHandles(i))}}class tp extends Ue{constructor(i,d){super(i,d);vt(this,"isMouseDown",!1)}onEnter(){this.redraw()}onExit(){this.isMouseDown=!1}handleMouseDown(i,d){this.isMouseDown=!0}handleMouseWheel(i,d){this.isMouseDown||i.shiftKey&&this.stateMachine.coordinateSystem.scaleAtClientPoint(-.001*i.deltaY,{clientX:i.clientX,clientY:i.clientY})}handleMouseMove(i,d){}handleMouseUp(i,d){this.isMouseDown=!1;const v=this.stateMachine.coordinateSystem;if(!this.stateMachine.ctx||!v||!d)return;const S=this.stateMachine.elements,B=i.clientX,W=i.clientY,N=v.clientPointToViewPoint({clientX:B,clientY:W}),D=S.find(C=>C.contains(N.x,N.y));D?(this.stateMachine.element=D,this.stateMachine.setState(We.STATE_MOVE)):this.stateMachine.element=null,this.redraw()}redraw(){const i=this.stateMachine.ctx,d=this.stateMachine.canvas;if(!i||!d)return;const v=this.stateMachine.element,M=this.stateMachine.elements;i.clearRect(0,0,d.width,d.height),ln.each(M,S=>{S.draw(i)}),v&&(v.drawLines(i),v.drawPoints(i))}}class np extends Ue{constructor(o,i){super(o,i)}onEnter(){}onExit(){}handleMouseWheel(o,i){}handleMouseDown(o,i){}handleMouseMove(o,i){}handleMouseUp(o,i){}}const le={Idle:"IDLE",Select:"SELECT",Move:"MOVE",Resize:"RESIZE",Zoom:"ZOOM"},It=class It{constructor(o){this._inputs=new Set,this._states={IDLE:new J_(this,It.STATE_IDLE),SELECT:new tp(this,It.STATE_SELECT),MOVE:new k_(this,It.STATE_MOVE),RESIZE:new j_(this,It.STATE_RESIZE),ZOOM:new np(this,It.STATE_ZOOM)},this._initialState=o.initialState,this._state=this._states[this._initialState],this._mouseDown=!1,this._elements=o.canvasElements,this._element=null,this._coordinateSystem=o.coordinateSystem,this._canvas=o.canvas,this._ctx=o.ctx}get mouseDown(){return this._mouseDown}get state(){return this._state}set state(o){this._state=o}addState(o){this._states[o.name]=o}setState(o){if(o!==this._state.name){if(!this._states[o])throw new Error(`State ${o} not found`);this._state&&this._state.onExit(),this._state=this._states[o],this._state.onEnter()}}resetState(){this._elements=[],this._element=null,this.setState(this._initialState)}handleMouseWheel(o,i){this._state.handleMouseWheel(o,i)}handleMouseDown(o,i){this._state.handleMouseDown(o,i)}handleMouseMove(o,i){this._state.handleMouseMove(o,i)}handleMouseUp(o,i){this._state.handleMouseUp(o,i)}handleKeyDown(o,i){if(o.ctrlKey&&this.state.name===It.STATE_MOVE){this.setState(It.STATE_RESIZE);return}}handleKeyUp(o,i){if(!o.ctrlKey&&this.state.name===It.STATE_RESIZE){this.setState(It.STATE_MOVE);return}}get inputs(){return this._inputs}set inputs(o){this._inputs=o}get element(){return this._element}set element(o){this._element=o}get elements(){return this._elements}set elements(o){this._elements=o}get coordinateSystem(){return this._coordinateSystem}set coordinateSystem(o){this._coordinateSystem=o}get canvas(){return this._canvas}set canvas(o){this._canvas=o}get ctx(){return this._ctx}set ctx(o){this._ctx=o}setCanvas(o){this.canvas=o}setCtx(o){this.ctx=o}setCoordinateSystem(o){this.coordinateSystem=o}};vt(It,"STATE_IDLE",le.Idle),vt(It,"STATE_SELECT",le.Select),vt(It,"STATE_RESIZE",le.Resize),vt(It,"STATE_MOVE",le.Move),vt(It,"STATE_ZOOM",le.Zoom);let We=It;var At={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let ep=0;function us(g,o){const i=`atom${++ep}`,d={toString:()=>i};return typeof g=="function"?d.read=g:(d.init=g,d.read=rp,d.write=ip),o&&(d.write=o),d}function rp(g){return g(this)}function ip(g,o,i){return o(this,typeof i=="function"?i(g(this)):i)}const es=(g,o)=>g.unstable_is?g.unstable_is(o):o===g,rs=g=>"init"in g,is=g=>!!g.write,Dr=new WeakMap,sp=(g,o)=>{Dr.set(g,o),g.catch(()=>{}).finally(()=>Dr.delete(g))},qo=(g,o)=>{const i=Dr.get(g);i&&(Dr.delete(g),i(o))},Ko=(g,o)=>{g.status="fulfilled",g.value=o},Yo=(g,o)=>{g.status="rejected",g.reason=o},up=g=>typeof(g==null?void 0:g.then)=="function",Pe=(g,o)=>!!g&&"v"in g&&"v"in o&&Object.is(g.v,o.v),Vo=(g,o)=>!!g&&"e"in g&&"e"in o&&Object.is(g.e,o.e),ae=g=>!!g&&"v"in g&&g.v instanceof Promise,op=(g,o)=>"v"in g&&"v"in o&&g.v.orig&&g.v.orig===o.v.orig,Or=g=>{if("e"in g)throw g.e;return g.v},fp=()=>{const g=new WeakMap,o=new WeakMap,i=[],d=new WeakMap;let v,M;(At?"production":void 0)!=="production"&&(v=new Set,M=new Set);const S=A=>g.get(A),B=(A,O)=>{O.d.forEach((U,p)=>{var R;if(!d.has(p)){const E=S(p);(R=i[i.length-1])==null||R.add(p),d.set(p,[E,new Set]),E&&B(p,E)}d.get(p)[1].add(A)})},W=(A,O)=>{var U;(At?"production":void 0)!=="production"&&Object.freeze(O);const p=S(A);if(g.set(A,O),d.has(A)||((U=i[i.length-1])==null||U.add(A),d.set(A,[p,new Set]),B(A,O)),ae(p)){const R="v"in O?O.v instanceof Promise?O.v:Promise.resolve(O.v):Promise.reject(O.e);p.v!==R&&qo(p.v,R)}},N=(A,O,U,p)=>{const R=new Map(p?O.d:null);let E=!1;U.forEach((T,P)=>{!T&&es(A,P)&&(T=O),T?(R.set(P,T),O.d.get(P)!==T&&(E=!0)):(At?"production":void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(E||O.d.size!==R.size)&&(O.d=R)},D=(A,O,U,p)=>{const R=S(A),E={d:(R==null?void 0:R.d)||new Map,v:O};if(U&&N(A,E,U,p),Pe(R,E)&&R.d===E.d)return R;if(ae(R)&&ae(E)&&op(R,E)){if(R.d===E.d)return R;E.v=R.v}return W(A,E),E},C=(A,O,U,p)=>{if(up(O)){let R;const E=()=>{const P=S(A);if(!ae(P)||P.v!==T)return;const j=D(A,T,U);o.has(A)&&P.d!==j.d&&bt(A,j,P.d)},T=new Promise((P,j)=>{let z=!1;O.then(F=>{z||(z=!0,Ko(T,F),P(F),E())},F=>{z||(z=!0,Yo(T,F),j(F),E())}),R=F=>{z||(z=!0,F.then(Lt=>Ko(T,Lt),Lt=>Yo(T,Lt)),P(F))}});return T.orig=O,T.status="pending",sp(T,P=>{P&&R(P),p==null||p()}),D(A,T,U,!0)}return D(A,O,U)},J=(A,O,U)=>{const p=S(A),R={d:(p==null?void 0:p.d)||new Map,e:O};return U&&N(A,R,U),Vo(p,R)&&p.d===R.d?p:(W(A,R),R)},ut=(A,O)=>{const U=S(A);if(!O&&U&&(o.has(A)||Array.from(U.d).every(([z,F])=>{if(z===A)return!0;const Lt=ut(z);return Lt===F||Pe(Lt,F)})))return U;const p=new Map;let R=!0;const E=z=>{if(es(A,z)){const Lt=S(z);if(Lt)return p.set(z,Lt),Or(Lt);if(rs(z))return p.set(z,void 0),z.init;throw new Error("no atom init")}const F=ut(z);return p.set(z,F),Or(F)};let T,P;const j={get signal(){return T||(T=new AbortController),T.signal},get setSelf(){return(At?"production":void 0)!=="production"&&!is(A)&&console.warn("setSelf function cannot be used with read-only atom"),!P&&is(A)&&(P=(...z)=>{if((At?"production":void 0)!=="production"&&R&&console.warn("setSelf function cannot be called in sync"),!R)return Y(A,...z)}),P}};try{const z=A.read(E,j);return C(A,z,p,()=>T==null?void 0:T.abort())}catch(z){return J(A,z,p)}finally{R=!1}},gt=A=>Or(ut(A)),nt=A=>{const O=T=>{var P,j;const z=new Set((P=o.get(T))==null?void 0:P.t);return(j=d.get(T))==null||j[1].forEach(F=>{z.add(F)}),z},U=new Array,p=new Set,R=T=>{if(!p.has(T)){p.add(T);for(const P of O(T))T!==P&&R(P);U.push(T)}};R(A);const E=new Set([A]);for(let T=U.length-1;T>=0;--T){const P=U[T],j=S(P);if(!j)continue;let z=!1;for(const F of j.d.keys())if(F!==P&&E.has(F)){z=!0;break}if(z){const F=ut(P,!0);Pe(j,F)||E.add(P)}}},it=(A,...O)=>{const U=E=>Or(ut(E)),p=(E,...T)=>{const P=i.length>0;P||i.push(new Set([E]));let j;if(es(A,E)){if(!rs(E))throw new Error("atom not writable");const z=S(E),F=C(E,T[0]);Pe(z,F)||nt(E)}else j=it(E,...T);if(!P){const z=Gt(i.pop());(At?"production":void 0)!=="production"&&v.forEach(F=>F({type:"async-write",flushed:z}))}return j};return A.write(U,p,...O)},Y=(A,...O)=>{i.push(new Set([A]));const U=it(A,...O),p=Gt(i.pop());return(At?"production":void 0)!=="production"&&v.forEach(R=>R({type:"write",flushed:p})),U},ot=(A,O,U)=>{var p;const R=o.get(A);if(R)return O&&R.t.add(O),R;const E=U||[];(p=S(A))==null||p.d.forEach((P,j)=>{j!==A&&ot(j,A,E)}),ut(A);const T={t:new Set(O&&[O]),l:new Set};if(o.set(A,T),(At?"production":void 0)!=="production"&&M.add(A),is(A)&&A.onMount){const{onMount:P}=A;E.push(()=>{const j=P((...z)=>Y(A,...z));j&&(T.u=j)})}return U||E.forEach(P=>P()),T},_t=(A,O)=>!O.l.size&&(!O.t.size||O.t.size===1&&O.t.has(A)),Ot=(A,O)=>{if(!_t(A,O))return;const U=O.u;U&&U(),o.delete(A),(At?"production":void 0)!=="production"&&M.delete(A);const p=S(A);p?(ae(p)&&qo(p.v),p.d.forEach((R,E)=>{if(E!==A){const T=o.get(E);T&&(T.t.delete(A),Ot(E,T))}})):(At?"production":void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",A)},bt=(A,O,U)=>{const p=new Set(O.d.keys()),R=new Set;U==null||U.forEach((E,T)=>{if(p.has(T)){p.delete(T);return}R.add(T);const P=o.get(T);P&&P.t.delete(A)}),p.forEach(E=>{ot(E,A)}),R.forEach(E=>{const T=o.get(E);T&&Ot(E,T)})},Gt=A=>{let O;(At?"production":void 0)!=="production"&&(O=new Set);const U=[],p=R=>{var E;if(!d.has(R))return;const[T,P]=d.get(R);d.delete(R),U.push([R,T]),P.forEach(p),(E=S(R))==null||E.d.forEach((j,z)=>p(z))};if(A.forEach(p),U.forEach(([R,E])=>{const T=S(R);if(!T){(At?"production":void 0)!=="production"&&console.warn("[Bug] no atom state to flush");return}if(T!==E){const P=o.get(R);P&&T.d!==(E==null?void 0:E.d)&&bt(R,T,E==null?void 0:E.d),P&&!(!ae(E)&&(Pe(E,T)||Vo(E,T)))&&(P.l.forEach(j=>j()),(At?"production":void 0)!=="production"&&O.add(R))}}),(At?"production":void 0)!=="production")return O},Dt=(A,O)=>{const U=ot(A),p=Gt([A]),R=U.l;return R.add(O),(At?"production":void 0)!=="production"&&v.forEach(E=>E({type:"sub",flushed:p})),()=>{R.delete(O),Ot(A,U),(At?"production":void 0)!=="production"&&v.forEach(E=>E({type:"unsub"}))}};return(At?"production":void 0)!=="production"?{get:gt,set:Y,sub:Dt,dev_subscribe_store:(A,O)=>{if(O!==2)throw new Error("The current StoreListener revision is 2.");return v.add(A),()=>{v.delete(A)}},dev_get_mounted_atoms:()=>M.values(),dev_get_atom_state:A=>g.get(A),dev_get_mounted:A=>o.get(A),dev_restore_atoms:A=>{i.push(new Set);for(const[U,p]of A)rs(U)&&(C(U,p),nt(U));const O=Gt(i.pop());v.forEach(U=>U({type:"restore",flushed:O}))}}:{get:gt,set:Y,sub:Dt}};let Be;const ap=()=>(Be||(Be=fp(),(At?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=Be),globalThis.__JOTAI_DEFAULT_STORE__!==Be&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),Be);var lp={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const cp=wt.createContext(void 0),Xo=g=>{const o=wt.useContext(cp);return(g==null?void 0:g.store)||o||ap()},hp=g=>typeof(g==null?void 0:g.then)=="function",dp=H_.use||(g=>{if(g.status==="pending")throw g;if(g.status==="fulfilled")return g.value;throw g.status==="rejected"?g.reason:(g.status="pending",g.then(o=>{g.status="fulfilled",g.value=o},o=>{g.status="rejected",g.reason=o}),g)});function gp(g,o){const i=Xo(o),[[d,v,M],S]=wt.useReducer(N=>{const D=i.get(g);return Object.is(N[0],D)&&N[1]===i&&N[2]===g?N:[D,i,g]},void 0,()=>[i.get(g),i,g]);let B=d;(v!==i||M!==g)&&(S(),B=i.get(g));const W=o==null?void 0:o.delay;return wt.useEffect(()=>{const N=i.sub(g,()=>{if(typeof W=="number"){setTimeout(S,W);return}S()});return S(),N},[i,g,W]),wt.useDebugValue(B),hp(B)?dp(B):B}function _p(g,o){const i=Xo(o);return wt.useCallback((...v)=>{if((lp?"production":void 0)!=="production"&&!("write"in g))throw new Error("not writable atom");return i.set(g,...v)},[i,g])}function ss(g,o){return[gp(g,o),_p(g,o)]}const pp=us(!1),os=us([]);us(null,(g,o,i)=>{o(os,d=>[...d,i])});let Kn=function(g){return g.AUTO="auto",g.COVER="cover",g.CONTAIN="contain",g}({});var Xt=function(g){return g.BACKGROUND="background",g.INTERFACE="interface",g}(Xt||{});const Zo=Kn.CONTAIN,$o=[Xt.BACKGROUND,Xt.INTERFACE],vp={display:"block",width:"100%",height:"100vh",position:"relative",backgroundColor:"lightblue"},wp={display:"block",position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"transparent"},mp={size:Zo,imageSrc:"./test.png",width:800,height:800},xp={min:1,max:5};function Ap({initialState:g=le.Idle,containerElementStyle:o=vp,canvasElementStyle:i=wp,background:d=mp,zoomExtents:v=xp,onViewChange:M}){const{containerRef:S,screenSize:B}=Z_(),W=wt.useRef(null),N=wt.useRef({}),D=wt.useRef({}),C=wt.useRef(Y()),[J,ut]=ss(os),gt=wt.useCallback(()=>new We({initialState:g,canvasElements:J,coordinateSystem:C.current,canvas:N.current[Xt.INTERFACE],ctx:D.current[Xt.INTERFACE]}),[J]),nt=wt.useRef(gt());wt.useEffect(()=>{const p=N.current[Xt.INTERFACE];if(!p)return;const R=F=>{nt.current.handleMouseMove(F,p)},E=F=>{nt.current.handleMouseUp(F,p)},T=F=>{nt.current.handleMouseDown(F,p)},P=F=>{if(nt.current.handleKeyDown(F,p),F.key==="d"&&nt.current.element){const Lt=nt.current.element.clone();Lt.id=`${J.length+1}`,Lt.rectangle.translate(10,10),ut(Yn=>[...Yn,Lt])}},j=F=>{nt.current.handleKeyUp(F,p)},z=F=>{nt.current.handleMouseWheel(F,p)};return p.addEventListener("mousedown",T),p.addEventListener("mousemove",R),p.addEventListener("mouseup",E),p.addEventListener("wheel",z),p.addEventListener("keydown",P),p.addEventListener("keyup",j),()=>{p.removeEventListener("mousedown",T),p.removeEventListener("mousemove",R),p.removeEventListener("mouseup",E),p.removeEventListener("wheel",z),p.removeEventListener("keydown",P),p.removeEventListener("keyup",j)}},[ut,J]),wt.useEffect(()=>{nt.current.resetState(),nt.current.elements=J,O()},[J]);function it(p){if(!d)return p;switch(d.size||(d.size=Zo),d.size){case Kn.COVER:const R=W.current;if(R){const{width:E,height:T}=R;if(!d.useImageOriginSize){let P=p.width,j=p.height;const z=E/T;return j=P/z,{width:P,height:j}}return{width:E,height:T}}break;case Kn.CONTAIN:return{width:d.width||0,height:d.height||0}}return p}function Y(){const p=new q_(v,{width:1920,height:1080});return p.attachViewChangeListener(ot),p}function ot(p){nt.current&&nt.current.resetState();const R=C.current;R&&($o.map(E=>D.current[E]).forEach(E=>{_t(E);const T=R.transformMatrix;E.setTransform(T.a,T.b,T.c,T.d,T.e,T.f)}),U())}function _t(p){Ot([p],()=>p.clearRect(0,0,p.canvas.width,p.canvas.height))}function Ot(p,R){p.forEach(E=>{E.save(),E.setTransform(fe.a,fe.b,fe.c,fe.d,fe.e,fe.f)});try{R()}finally{p.forEach(E=>E.restore())}}function bt(p){C.current.documentSize={...p}}function Gt({canvas:p,ctx:R,image:E}){if(E&&E.complete&&p&&R&&d)switch(d.size){case Kn.AUTO:X_({canvas:p,ctx:R,image:E});break;case Kn.COVER:V_({ctx:R,image:E});break;case Kn.CONTAIN:default:$_({canvas:p,ctx:R,image:E});break}}function Dt(p,R=!1){let E=!1;const{canvas:T}=C.current;if((T.width!==p.width||T.height!==p.height)&&(Y_(N.current,p),bt(p),E=!0),R||E){const P=p.width/C.current.initialViewSize.width,j=p.height/C.current.initialViewSize.height;ln.each(J,z=>{z.rectangle.points.forEach(F=>{F.x=F.initialX*P,F.y=F.initialY*j})}),U()}}function A(){const p=N.current[Xt.BACKGROUND],R=D.current[Xt.BACKGROUND],E=W.current;!p||!R||(R.clearRect(0,0,p.width,p.height),E&&Gt({canvas:p,ctx:R,image:E}))}function O(){_t(D.current[Xt.INTERFACE]),J.forEach(p=>{p.draw(D.current[Xt.INTERFACE])})}function U(){A(),O()}return wt.useEffect(()=>{const p=it(B);Dt(p),typeof M=="function"&&M(p)},[B]),wt.useEffect(()=>{nt.current.setCanvas(N.current[Xt.INTERFACE]),nt.current.setCtx(D.current[Xt.INTERFACE])},[N.current]),wt.useEffect(()=>{if(!(!d||!d.imageSrc||d.imageSrc==="")&&(!W.current||W.current.getAttribute("src")!==d.imageSrc)){const p=new Image;p.src=d.imageSrc,p.onload=()=>{const R=it(B);Dt(R,!0),C.current.initialViewSize=R},p.onabort=()=>{W.current=null},W.current=p}},[d,W]),Go.jsx("div",{style:{...o},ref:S,children:$o.map(p=>{const R=p===Xt.INTERFACE;return Go.jsx("canvas",{tabIndex:R?1:0,ref:E=>{E&&(N.current[p]=E,D.current[p]=E.getContext("2d"),R&&(C.current.canvas=E))},style:{...i}},p)})})}class fs{constructor(o){this._points=o}get points(){return this._points}set points(o){this._points=o}get boundingBox(){let o=this._points[0].x,i=this._points[0].y,d=this._points[0].x,v=this._points[0].y;return ln.each(this._points,M=>{o=Math.min(o,M.x),i=Math.min(i,M.y),d=Math.max(d,M.x),v=Math.max(v,M.y)}),new Pn(o,i,d-o,v-i)}translate(o,i){ln.each(this._points,d=>d.translate(o,i))}clone(){return new fs(this._points.map(o=>o.clone()))}serialize(){return ln.map(this.points,o=>[o.x,o.y])}resize(o){const i=this.boundingBox,d=[];ln.each(this._points,v=>{d.push({x:(v.x-i.topLeft.x)/i.width,y:(v.y-i.topLeft.y)/i.height})}),this._points=ln.map(d,v=>new ft(o.topLeft.x+o.width*v.x,o.topLeft.y+o.height*v.y))}deserialize(o){this.points=ln.map(o,i=>new ft(i[0],i[1]))}isNear(o,i=10){return this._points.some(d=>ft.isNear(d,o,i))}isPartOfPolygon(o){return this._points.some(i=>i.id===o.id)}contains(o,i){let d=!1;for(let v=0,M=this._points.length-1;v<this._points.length;M=v++){const S=this._points[v].x,B=this._points[v].y,W=this._points[M].x,N=this._points[M].y;B>i!=N>i&&o<(W-S)*(i-B)/(N-B)+S&&(d=!d)}return d}}class Pn extends fs{constructor(o=0,i=0,d=0,v=0){if(o instanceof ft&&i instanceof ft&&d instanceof ft&&v instanceof ft)super([o,i,d,v]);else if(typeof o=="number"&&typeof i=="number"&&typeof d=="number"&&typeof v=="number")super(Pn.pointsFromBounds(o,i,d,v));else throw new Error("Invalid arguments")}static pointsFromBounds(o,i,d,v){return[new ft(o,i),new ft(o+d,i),new ft(o+d,i+v),new ft(o,i+v)]}get width(){return this._points[1].x-this._points[0].x}get height(){return this._points[2].y-this._points[1].y}get topLeft(){return this._points[0]}get topRight(){return this._points[1]}get bottomRight(){return this._points[2]}get bottomLeft(){return this._points[3]}get topMid(){return ft.middlePoint(this.topLeft,this.topRight)}get rightMid(){return ft.middlePoint(this.topRight,this.bottomRight)}get bottomMid(){return ft.middlePoint(this.bottomLeft,this.bottomRight)}get leftMid(){return ft.middlePoint(this.topLeft,this.bottomLeft)}updateDimensions(o,i,d,v){this.points=Pn.pointsFromBounds(o,i,d,v)}processDisplacement(){this.width<0&&([this._points[0],this._points[1]]=[this._points[1],this._points[0]],[this._points[2],this._points[3]]=[this._points[3],this._points[2]]),this.height<0&&([this._points[0],this._points[3]]=[this._points[3],this._points[0]],[this._points[1],this._points[2]]=[this._points[2],this._points[1]])}clone(){return new Pn(this._points[0].x,this._points[0].y,this.width,this.height)}json(){return JSON.stringify(this)}}class Pr{constructor(o,i,d,v,M,S){this._id=o,this._color=i,this._isCurrent=d,this._numberOfEquipments=v,this._rectangle=M,this._isEdit=typeof S=="boolean"?S:!0}get id(){return this._id}set id(o){this._id=o}get color(){return this._color}get isCurrent(){return this._isCurrent}get numberOfEquipments(){return this._numberOfEquipments}get rectangle(){return this._rectangle}get isEdit(){return this._isEdit}translate(o,i){this._rectangle.translate(o,i)}updateDimensions(o,i){this._rectangle.updateDimensions(this._rectangle.topLeft.x,this._rectangle.topLeft.y,o,i)}resizeBoundingBox(o){this._rectangle.resize(o)}draw(o){this.drawPolygon(o),this.drawNumberOfEquipments(o),this.drawIsCurrent(o)}contains(o,i){return this.isEdit&&this.rectangle.contains(o,i)}drawDebug(o){o.fillStyle="black",o.fillText("TL",this.rectangle.topLeft.x,this.rectangle.topLeft.y,this.rectangle.width),o.fillText("TR",this.rectangle.topRight.x,this.rectangle.topRight.y,this.rectangle.width),o.fillText("BR",this.rectangle.bottomRight.x,this.rectangle.bottomRight.y,this.rectangle.width),o.fillText("BL",this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y,this.rectangle.width)}drawPolygon(o){const i=this.rectangle.points;o.fillStyle=this.color,o.beginPath(),o.moveTo(i[0].x,i[0].y);for(let d=1;d<i.length;d++)o.lineTo(i[d].x,i[d].y);o.closePath(),o.fill()}drawLines(o){const i=this.rectangle.points;o.fillStyle="black",o.lineWidth=1,o.setLineDash([]),o.beginPath(),o.moveTo(i[0].x,i[0].y);for(let d=1;d<i.length;d++)o.lineTo(i[d].x,i[d].y);o.closePath(),o.stroke()}drawIsCurrent(o){this.isCurrent&&(o.fillStyle="red",o.font="40px Arial",o.fillText("*",this.rectangle.topLeft.x,this.rectangle.topLeft.y+35,this.rectangle.width))}drawNumberOfEquipments(o){this.numberOfEquipments>0&&(o.fillStyle="black",o.font="14px Arial",o.fillText(`(${this.numberOfEquipments.toString()})`,this.rectangle.bottomLeft.x,this.rectangle.bottomLeft.y+14,this.rectangle.width))}drawBoundingBox(o){const i=this.rectangle.boundingBox;o.lineWidth=1,o.lineDashOffset=0,o.setLineDash([2,3]),o.beginPath(),o.moveTo(i.topLeft.x,i.topLeft.y),o.lineTo(i.topRight.x,i.topRight.y),o.lineTo(i.bottomRight.x,i.bottomRight.y),o.lineTo(i.bottomLeft.x,i.bottomLeft.y),o.lineTo(i.topLeft.x,i.topLeft.y),o.closePath(),o.stroke()}drawPoints(o){const i=this.rectangle.points;o.fillStyle="purple",i.forEach(d=>{o.beginPath(),o.arc(d.x,d.y,3,0,2*Math.PI),o.fill()}),o.closePath()}drawBoundingBoxHandles(o){const{topLeft:v,topRight:M,bottomRight:S,bottomLeft:B}=this.rectangle.boundingBox;o.strokeStyle="black",o.fillStyle="white",o.setLineDash([]),o.fillRect(v.x-3,v.y-3,6,6),o.fillRect(M.x-3,M.y-3,6,6),o.fillRect(S.x-3,S.y-3,6,6),o.fillRect(B.x-3,B.y-3,6,6),o.strokeRect(v.x-3,v.y-3,6,6),o.strokeRect(M.x-3,M.y-3,6,6),o.strokeRect(S.x-3,S.y-3,6,6),o.strokeRect(B.x-3,B.y-3,6,6),o.stroke()}getBoundingBoxHandle(o,i){const d=this.rectangle.boundingBox,v=[d.topLeft,d.topRight,d.bottomRight,d.bottomLeft],M=v.map(W=>ft.distance(W,new ft(o,i))),S=Math.min(...M),B=M.findIndex(W=>W===S&&W<10);return v[B]}handleToString(o){const{topLeft:i,topRight:d,bottomRight:v,bottomLeft:M}=this.rectangle.boundingBox;return ft.isSame(o,i)?"topLeft":ft.isSame(o,d)?"topRight":ft.isSame(o,v)?"bottomRight":ft.isSame(o,M)?"bottomLeft":null}clone(){const o=this.rectangle.points.map(i=>i.clone());return new Pr(this.id,this.color,this.isCurrent,this.numberOfEquipments,new Pn(o[0],o[1],o[2],o[3]),this.isEdit)}}const yp="#ffff66";function Rp(){const g={size:Kn.COVER},o=wt.useRef(null),[i,d]=ss(os),[v,M]=wt.useState(g),[S,B]=ss(pp),W=Y=>{o.current={...Y}},N=Y=>{M(ot=>({...ot,...Y}))},D=Y=>{const ot=Y.map(_t=>{const Ot=new Pn(0,0,0,0);return Ot.deserialize(JSON.parse(_t.JsonRectangle)),new Pr(_t.id.toString(),_t.Color,_t.IsCurrent,_t.NumberEquipment,Ot,_t.isEdit)});d([...ot])},C=Y=>{W(Y),N({imageSrc:Y.imageSource}),D(Y.data),B(Y.viewMode)},J=()=>{const Y=new Pn(0,0,100,100),ot=new Pr(`${i.length+1}`,yp,!1,4,Y,!0);d([...i,ot])},ut=()=>{o.current&&C(o.current)},gt=Y=>{W({background:v,elements:i}),typeof Y=="function"&&Y(it())},nt=()=>{const Y=i.map(ot=>({id:ot.id,IsTemplate:!1,NumberEquipment:ot.numberOfEquipments,Color:ot.color,IsCurrent:ot.isCurrent,JsonRectangle:ot.rectangle.serialize(),isEdit:ot.isEdit}));return console.log("exportRectangles: ",Y),Y},it=()=>{const Y=i.map(ot=>({id:parseInt(ot.id),IsTemplate:!1,NumberEquipment:ot.numberOfEquipments,Color:ot.color,IsCurrent:ot.isCurrent,JsonRectangle:JSON.stringify(ot.rectangle.serialize()),isEdit:ot.isEdit}));return JSON.stringify({background:v,data:Y})};return{viewMode:S,background:v,elements:i,loadBackground:N,loadDataSource:D,loadAll:C,addRectangle:J,exportRectangles:nt,toString:it,saveData:gt,resetData:ut}}export{Ap as C,Rp as u};
